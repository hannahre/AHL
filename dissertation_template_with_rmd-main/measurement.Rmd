---
title: ""
bibliography: references.bib
---

```{r, echo = FALSE}
library(foreign)
library(expss)
library(Hmisc)
library(dplyr)
library(summarytools)
library(magrittr)
library(tidyverse)
library(mosaic)
library(lattice)
library(ggplot2)
library(scales)
library(ggthemes)
library(polycor)
library(psych)
#library(REdaS)
library(haven)
library(labelled)
library(mice)
library(GPArotation)
library(doParallel)
library(questionr)
library(gridExtra)
library(DAKS)
library(fdth)
library(corrplot)
library(knitr)
library(sna)
library(corrr)
library(gdata)
library(Rfast)
library(kableExtra)
library(janitor)
library(stargazer)
library(tables)
library(gtsummary)
library(pander)
#library(validateR)
library(lavaan)
library(DescTools)
library(foreach)
options(scipen = 999)
```

# Chapter 2: Alternative Health Lifestyle Measurement

This chapter addresses the question of whether complementary and alternative medicines consitute a health lifestyle. Complementary and alternative medicine (CAM) encompasses a wide array of practices aimed at promoting health and wellness. This variation has led to debate about how to define CAM. CAM is often defined as treatment and prevention practices outside of biomedicine, and that are typically not offered in hospitals [@barrett2003; @dcrus2005; @gale2014; @meeker2000; @ni2002; @sointu2021]. On the other hand, CAM is increasingly being taught as part of medical school curriculum and integrative medicine is becoming popular within biomedical institutions [@coulter2004; @thorne2002; @tilden2004].

Institutional bodies have attempted to organize CAMs into domains of similar practices. Table \ref{tab:domains-table} summarizes how various CAMs are categorized according to previous classifications created by institutional bodies and identified in previous research. In the United Kingdom (UK), the House of Lords Select Committee on Science and Technology proposed that CAMs be categorized into three groups for research and policy purposes based on the CAM's claim regarding having its own distinct diagnostic approach [@mills2001]. These groups included (1) professionally organized alternative therapies, which includes therapies such as chiropractic and acupuncture; (2) complementary therapies, which includes therapies such as massage, hypnotherapy, and meditation and (3) alternative disciplines that may be further subdivided into long established and traditional systems of health care such as Ayurvedic medicine and other alternative disciplines such as crystal therapy.

Similarly, in their Strategic Plan for 2005-2009, the American National Center for Complementary and Alternative Medicine (NCCAM) grouped CAMs into four domains: (1) mind-body medicine, including practices such as meditation and yoga; (2) biologically based treatments, including practices such as use of herbs and vitamins and special diets; (3) manipulative and body-based practices, including practices such as chiropractic care and massage; and (4) energy medicine, including practices that involve the use of verifiable energy fields as well as biofields. NCCAM placed whole medical systems (e.g. Ayurveda, traditional Chinese Medicine) into a class of their own due to their use of practices that fall under multiple domains. On their current website, the National Center for Complementary and Integrative Health (NCCIH, formerly NCCAM) classifies CAMs into three domains based on their primary therapeutic input, and a fourth domain for practices that represent a combination of domains. The domains include (1) nutritional approaches, such as special diets, supplements, and herbs; (2) psychological approaches, such as meditation, hypnosis, and relaxation therapies; (3) physical approaches, such as acupuncture and massage; (4) combination approaches, for example practices that combine psychological and physical approaches such as yoga or tai chi. CAMs previously categorized as alternative medical systems involve multiple practices that are not easily fit in the new domains are not included in the classification.

Clearly there are many ways to justify the conceptual classifications of CAMs. CAMs vary in terms of their therapeutic input, their level of professional organization, and their relation to biomedicine. The question remains whether these classifications of CAMs represent actual patterns of CAM use. To my knowledge, there has been only one test of these proposed CAM domains in the literature. @ayers2010 used confirmatory factor analysis to test whether the five domains (including whole medical systems) reflect actual patterns of CAM use observed in data from the 2002 National Health Interview Survey (NHIS). After dropping CAMs that did not load properly (hypnosis, biofeedback, and energy healing), the authors found that the CAM domains proposed by NCCAM did not fit the data. The authors then conducted an exploratory factor analysis on the NHIS data and found a four factor solution that fit the data well. The four factors include mind-body medicine, alternative medical systems, prayer, and manipulative treatments. Meditation, guided imagery, relaxation, and deep breathing load onto mind-body medicine. Ayurveda, folk medicine, naturopathy, homeopathy, herbal therapy, vitamins, and biofeedback load onto alternative medical systems. Pray for self, asked others to pray for self, prayer groups, and healing rituals load onto prayer. Acupuncture, chiropractic, and massage load onto manipulative therapies.

In this chapter, I investigate whether there is an underlying construct or constructs driving the use of complementary and alternative medicines. This is in part an answer to the call from health lifestyles perspectives to examine how individual behaviors coalesce into meaningful behavioral patterns [@cockerham2005]. In the following analyses, I utilize exploratory factor analysis and confirmatory factor analysis to identify any possible underlying constructs of CAM utilization.

```{r, echo = FALSE}
# Create a table: Rows = CAMs. Columns = category the CAM is assigned to in each system
UK.input <- c("Professionally Organized Alt. Therapies", 
              "Complementary Therapies", 
              "Alternative Disciplines", 
              "Complementary Therapies", 
              "Professionally Organized Alt. Therapies", 
              "Complementary Therapies", 
              "Complementary Therapies", 
              "Alternative Disciplines", 
              "Complementary Therapies", 
              "Professionally Organized Alt. Therapies", 
              "Professionally Organized Alt. Therapies", 
              "Complementary Therapies", 
              "Complementary Therapies", 
              "Complementary Therapies", 
              "Alternative Disciplines", 
              "Complementary Therapies", 
              "Complementary Therapies", 
              "Complementary Therapies")
UK <- ordered(UK.input, levels = c("Alternative Disciplines", 
                                  "Professionally Organized Alt. Therapies",
                                  "Complementary Therapies"))
NCCAM.input <- c("Alternative Medical Systems", 
                 "Mind-Body Treatments",
                 "Alternative Medical Systems", 
                 "Mind-Body Treatments",
                 "Manipulative Treatments", 
                 "Mind-Body Treatments", 
                 "Energy Medicine", 
                 "Alternative Medical Systems", 
                 "Mind-Body Treatments", 
                 "Biologically Based Practices", 
                 "Alternative Medical Systems", 
                 "Mind-Body Treatments", 
                 "Manipulative Treatments", 
                 "Mind-Body Treatments", 
                 "Alternative Medical Systems",
                 "Mind-Body Treatments", 
                 "Biologically Based Practices", 
                 "Biologically Based Practices")
NCCAM <- ordered(NCCAM.input, levels = c("Alternative Medical Systems",
                                        "Biologically Based Practices",
                                        "Mind-Body Treatments", 
                                        "Manipulative Treatments", 
                                        "Energy Medicine"))
NCCIH.input <- c("Physical", "Psychological", 
                 "Alternative Medical Systems",
                 "Psychological and Physical", 
                 "Physical", 
                 "Psychological and Physical", 
                 NA, 
                 "Alternative Medical Systems", 
                 "Psychological and Physical", 
                 "Nutritional",
                 "Alternative Medical Systems", 
                 "Psychological", 
                 "Physical", 
                 "Psychological and Physical", 
                 "Alternative Medical Systems", 
                 "Psychological", 
                 "Nutritional", 
                 "Nutritional")
NCCIH <- ordered(NCCIH.input, levels = c("Alternative Medical Systems", 
                                        "Nutritional",
                                        "Psychological", 
                                        "Physical", 
                                        "Psychological and Physical"))
Ayers.input <- c("Manipulative Treatments", 
                 "Prayer", 
                 "Alternative Medical Systems", 
                 "Alternative Medical Systems", 
                 "Manipulative Treatments", 
                 "Mind-Body Medicine",
                 NA, 
                 "Alternative Medical Systems", 
                 "Mind-Body Medicine", 
                 "Alternative Medical Systems", 
                 "Alternative Medical Systems", 
                 NA, 
                 "Manipulative Treatments", 
                 "Mind-Body Medicine", 
                 "Alternative Medical Systems",
                 "Prayer", 
                 "Alternative Medical Systems", 
                 NA)
Ayers <- ordered(Ayers.input, levels = c("Alternative Medical Systems", 
                                        "Mind-Body Medicine",
                                        "Manipulative Treatments", 
                                        "Prayer"))
domains.df <- data.frame(UK, NCCAM, NCCIH, Ayers)
row.names(domains.df) <- c("Acupuncture", "Prayer", "Ayurveda", "Biofeedback", "Chiropractic", 
         "Deep breathing", "Energy healing", "Folk medicine", "Guided imagery", 
         "Herbal therapy", "Homeopathy", "Hypnosis", "Massage", "Meditation",
         "Naturopathy", "Healing ritual", "Vitamins", "Special Diet")
domains.df <- domains.df[
  with(domains.df, order(UK, NCCAM, NCCIH, Ayers)),
]
```

```{r domains-table, echo= FALSE}
kable(domains.df,
      booktabs = T,
      col.names = c("UK House of Lords",
                  "NCCAM",
                  "NCCIH",
                  "Ayers and Kronenfeld (2010)"),
      caption = "CAM Classifications According to Institutions and Previous Research") %>%
  kable_classic(html_font = "CMU Serif") %>% 
  kableExtra::landscape() %>%  
  kable_styling(latex_options = "scale_down")
```

```{r, echo = FALSE, results = 'hide'}
# This chunk reads in the MIDUS1 Stata .dta file, subsets the data to only include CAMs, and restricts the data to complete cases. 

# Read in MIDUS1 data and subset to complete cases on CAMs
# Read in stata file for MIDUS 1
path <- ("C:/Users/hanna/Documents/git/AHL/Stata/data-cleaning/MIDUS1.dta")
M1 <- read_dta(path)
acamsList <- c("acam1", "acam2", "acam3", "acam4", "acam5", "acam6", "acam7", 
               "acam8", "acam9", "acam10", "acam11", "acam12", "acam13", "acam14", 
               "acam15", "acam21")

acams <- M1[acamsList] # Subset MIDUS1 - only include CAMs.

# Remove attributes from acams data - created in Stata (labels and data notes). They're (were) producing an error with bart_spher.
acams <- remove_attributes(acams, "label")
acams <- remove_attributes(acams, "notes")

str(acams)

# Create column that is the sum of CAMs used 
totalCams <- rowSums(acams[, c(1:11, 13, 14, 16)])

acams[sapply(acams, is.numeric)] <- lapply(acams[sapply(acams, is.numeric)], as.factor) # convert all columns to factors

str(acams) 
head(acams)

# Rename columns 
acams <- dplyr::rename(acams, 
                          aAcupuncture = acam1, 
                          aBiofeedback = acam2,
                          aChiropractic = acam3,
                          aEnergyHeal = acam4,
                          aExerciseMove = acam5,
                          aHerbal = acam6,
                          aVitamins = acam7,
                          aHomeopathy = acam8,
                          aHypnosis = acam9,
                          aImageryTech = acam10,
                          aMassage = acam11,
                          aPrayer = acam12,
                          aRelaxMeditate = acam13,
                          aSpecialDiet = acam14,
                          aSpiritHeal = acam15,
                          aPraySpirit = acam21)
head(acams)
# Keep only complete cases
acams=acams[complete.cases(acams),]
str(acams)
```

```{r, echo = FALSE, results = 'hide'}
# This chunk reads in the MIDUS2 Stata .dta file, subsets the data to only include CAMs, and restricts the data to complete cases. 

# Prayer and spiritual healing combined in stata.

# Read in MIDUS2 data and subset to complete cases on CAMs
# Read in stata file for MIDUS 2
path <- ("C:/Users/hanna/Documents/git/AHL/Stata/data-cleaning/MIDUS2.dta")
M2 <- read_dta(path)
bcamsList <- c("bcam1", "bcam2", "bcam3", "bcam4", "bcam5", "bcam6", "bcam7", 
               "bcam8", "bcam9", "bcam10", "bcam11", "bcam12", "bcam13", "bcam14", 
               "bcam15", "bcam21")

bcams <- M2[bcamsList] # Subset MIDUS2 - only include CAMs.

# Remove attributes from acams data - created in Stata (labels and data notes). They're (were) producing an error with bart_spher.
bcams <- remove_attributes(bcams, "label")
bcams <- remove_attributes(bcams, "notes")

str(bcams)

# Create column that is the sum of CAMs used 
btotalCams <- rowSums(bcams[,1:14])

bcams[sapply(bcams, is.numeric)] <- lapply(bcams[sapply(bcams, is.numeric)], as.factor) # convert all columns to factors

str(bcams) 
head(bcams)

# Rename columns 
bcams <- dplyr::rename(bcams, 
                         bAcupuncture = bcam1, 
                         bBiofeedback = bcam2,
                         bChiropractic = bcam3,
                         bEnergyHeal = bcam4,
                         bExerciseMove = bcam5,
                         bHerbal = bcam6,
                         bVitamins = bcam7,
                         bHomeopathy = bcam8,
                         bHypnosis = bcam9,
                         bImageryTech = bcam10,
                         bMassage = bcam11,
                         bPrayer = bcam12,
                         bRelaxMeditate = bcam13,
                         bSpecialDiet = bcam14,
                         bSpiritHeal = bcam15,
                         bPraySpirit = bcam21)
head(bcams)
# Keep only complete cases
bcams=bcams[complete.cases(bcams),]
str(bcams)
```

```{r, echo = FALSE, results = 'hide'}
# This chunk reads in the MIDUS2 Stata .dta file, subsets the data to only include CAMs, and restricts the data to complete cases. 

# Prayer and spiritual healing combined in stata.

# Read in MIDUS2 data and subset to complete cases on CAMs
# Read in stata file for MIDUS 2
path <- ("C:/Users/hanna/Documents/git/AHL/Stata/data-cleaning/MIDUS3.dta")
M3 <- read_dta(path)
ccamsList <- c("ccam1", "ccam2", "ccam3", "ccam4", "ccam5", "ccam6", "ccam7", 
               "ccam8", "ccam9", "ccam10", "ccam11", "ccam12", "ccam13", "ccam14",
               "ccam15", "ccam21")

ccams <- M3[ccamsList] # Subset MIDUS2 - only include CAMs.

# Remove attributes from acams data - created in Stata (labels and data notes). They're (were) producing an error with bart_spher.
ccams <- remove_attributes(ccams, "label")
ccams <- remove_attributes(ccams, "notes")

str(ccams)

# Create column that is the sum of CAMs used 
ctotalCams <- rowSums(ccams[,1:14])

ccams[sapply(ccams, is.numeric)] <- lapply(ccams[sapply(ccams, is.numeric)], as.factor) # convert all columns to factors

str(ccams) 
head(ccams)

# Rename columns 
ccams <- dplyr::rename(ccams, 
                        cAcupuncture = ccam1, 
                        cBiofeedback = ccam2,
                        cChiropractic = ccam3,
                        cEnergyHeal = ccam4,
                        cExerciseMove = ccam5,
                        cHerbal = ccam6,
                        cVitamins = ccam7,
                        cHomeopathy = ccam8,
                        cHypnosis = ccam9,
                        cImageryTech = ccam10,
                        cMassage = ccam11,
                        cPrayer = ccam12,
                        cRelaxMeditate = ccam13,
                        cSpecialDiet = ccam14, 
                        cSpiritHeal = ccam15, 
                        cPraySpirit = ccam21)
head(ccams)
# Keep only complete cases
ccams=ccams[complete.cases(ccams),]
str(ccams)
```

```{r, echo = FALSE, results = 'hide'}
# This code chunk creates a crosstab for prayer and spiritual healing in Wave 1 

# create new df with prayer and spiritual healing
my.vars <- c("aPrayer", "aSpiritHeal")
pray.spirit <- acams[my.vars]
  
# Assign yes/no values labels to prayer and spiritual healing 
pray.spirit$aPrayer <- ordered(pray.spirit$aPrayer,
                              levels = c(0,1), 
                              labels = c("No", "Yes"))
head(pray.spirit)
pray.spirit$aSpiritHeal <- ordered(pray.spirit$aSpiritHeal,
                                   levels = c(0, 1), 
                                   labels = c("No", "Yes"))
head(pray.spirit)

# Crosstab for prayer and spiritual healing
table.pray.spirit <- pray.spirit %>% 
  tabyl(aPrayer, aSpiritHeal) %>% 
  adorn_percentages("col") %>%
  adorn_totals(where = "row") %>% 
  adorn_pct_formatting() %>% 
  adorn_ns( position = "front") %>% 
  adorn_title(placement = "top", row_name = "Prayer", col_name = "Spiritual Healing")
```

```{r, echo = FALSE, results = 'hide'}
# This code chunk creates a crosstab for prayer and spiritual healing in Wave 2 

# create new df with prayer and spiritual healing
my.vars <- c("bPrayer", "bSpiritHeal")
pray.spirit.b <- bcams[my.vars]
  
# Assign yes/no values labels to prayer and spiritual healing 
pray.spirit.b$bPrayer <- ordered(pray.spirit.b$bPrayer,
                              levels = c(0,1), 
                              labels = c("No", "Yes"))
head(pray.spirit.b)
pray.spirit.b$bSpiritHeal <- ordered(pray.spirit.b$bSpiritHeal,
                                   levels = c(0, 1), 
                                   labels = c("No", "Yes"))
head(pray.spirit.b)

# Crosstab for prayer and spiritual healing
table.pray.spirit.b <- pray.spirit.b %>% 
  tabyl(bPrayer, bSpiritHeal) %>% 
  adorn_percentages("col") %>%
  adorn_totals(where = "row") %>% 
  adorn_pct_formatting() %>% 
  adorn_ns( position = "front") %>% 
  adorn_title(placement = "top", row_name = "Prayer", col_name = "Spiritual Healing")
```

```{r, echo = FALSE, results = 'hide'}
# This code chunk creates a crosstab for prayer and spiritual healing at Wave 3
# create new df with prayer and spiritual healing
my.vars <- c("cPrayer", "cSpiritHeal")
pray.spirit.c <- ccams[my.vars]
  
# Assign yes/no values labels to prayer and spiritual healing 
pray.spirit.c$cPrayer <- ordered(pray.spirit.c$cPrayer,
                              levels = c(0,1), 
                              labels = c("No", "Yes"))
head(pray.spirit.c)
pray.spirit.c$cSpiritHeal <- ordered(pray.spirit.c$cSpiritHeal,
                                   levels = c(0, 1), 
                                   labels = c("No", "Yes"))
head(pray.spirit.c)

# Crosstab for prayer and spiritual healing
table.pray.spirit.c <- pray.spirit.c %>% 
  tabyl(cPrayer, cSpiritHeal) %>% 
  adorn_percentages("col") %>%
  adorn_totals(where = "row") %>% 
  adorn_pct_formatting() %>% 
  adorn_ns( position = "front") %>% 
  adorn_title(placement = "top", row_name = "Prayer", col_name = "Spiritual Healing")


```

```{r, echo = FALSE, results = 'hide'}
# This code chunk drops prayer and spiritual healing for the rest of the analyses.  

# Drop prayer and spiritual healing columns 
acams <- subset(acams, select = -c(aPrayer, aSpiritHeal))
str(acams)

bcams <- subset(bcams, select = -c(bPrayer, bSpiritHeal))
str(bcams)

ccams <- subset(ccams, select = -c(cPrayer, cSpiritHeal))
str(ccams)
```

```{r, echo = FALSE, results='hide'}
# this chunk converts the tibble (acams) produced in the previous chunk to a matrix. 
# Code was written by Ron. See Andrews.Hannah.FacAn.Ron.script 

# What type of numbers do we have in the tibble "acams"? Let's see.
### Let's construct a matrix version of acams:
acams.matrix <- as.matrix(acams)
dim(acams.matrix)
head(acams.matrix)
acams.matrix <- as.numeric(acams.matrix)
dim(acams) # is: 6157 rows by 14 columns
6157 * 14 # is: 86,198
length(acams.matrix) # also 86,198
acams.matrix <- matrix(acams.matrix, ncol = 14)
dim(acams.matrix)
colnames(acams.matrix) <- names(acams)
head(acams.matrix)
head(acams) # They look the same.

# Now look at the numbers in acams.matrix:
table(as.vector(acams.matrix))
# All numbers are binary (0, 1)
colSums(acams.matrix)
sort(colSums(acams.matrix))
```

```{r, echo = FALSE, results = 'hide'}
# this code chunk sets up the frequencies visualization

### Write the program that Hannah used ("freq_dframer")

freq_dframer <- function(data){
  quest_out   <- apply(data, 2, questionr::freq)
  templist <- list()
  for (i in 1:length(names(quest_out))) {
    temp <- data.frame(Item = rep(names(quest_out[i]), nrow(quest_out[[i]])),
                       Category = row.names(quest_out[[i]]),
                       quest_out[[i]])
    templist[[i]] <- temp
  }
  freqs <- dplyr::bind_rows(templist) 
  row.names(freqs) <- NULL
  names(freqs)[3:5] <- c("Frequency", "Percent", "Pcnt_of_nonMissing") 
  freqs$Item <- factor(freqs$Item, levels = unique(freqs$Item))
  freqs
}
freqout <- freq_dframer(acams)

# Check with my matrix version:
freqout$Frequency[seq(2, 28, 2)]
colSums(acams.matrix)
sum(freqout$Frequency[seq(2, 28, 2)] != colSums(acams.matrix)) # They are the same.

# Frequency output for bcams
b.freqout <- freq_dframer(bcams)

# Frequency output for ccams 
c.freqout <- freq_dframer(ccams)
```

```{r, echo = FALSE, results = 'hide'}
# This code chunk creates a table that reports frequency and percent of respondents who have used each CAM in the last 12 months.

# Subset yes rows from the frequency table above
# MIDUS1
a.freqout.is1 <- freqout[seq(2, 28, 2),]
# MIDUS2 
b.freqout.is1 <- b.freqout[seq(2,28,2),]
# MIDUS3 
c.freqout.is1 <- c.freqout[seq(2, 28,2),]

# Subset frequency and percent columns
# MIDUS1 
freq.vars <- c("Frequency", "Percent")
freqs <- a.freqout.is1[freq.vars] 
# MIDUS2
b.freqs <- b.freqout.is1[freq.vars]
# MIDUS3
c.freqs <- c.freqout.is1[freq.vars]

# Rename columns for merging 
# MIDUS 1
freqs <- freqs %>% 
  rename(
    M1.Frequency = Frequency,
    M1.Percent = Percent
    )
# MIDUS 2
b.freqs <- b.freqs %>% 
  rename(
    M2.Frequency = Frequency,
    M2.Percent = Percent
    )
# MIDUS 3
c.freqs <- c.freqs %>% 
  rename(
    M3.Frequency = Frequency,
    M3.Percent = Percent
    )

# Assign rownames 
row.names(freqs) <- c("Acupuncture", "Biofeedback", "Chiropractic", "Energy Healing", 
                  "Exercise and Movement Therapy", "Herbal Therapy", "Vitamins", 
                  "Homeopathy", "Hypnosis", "Imagery Techniques", "Massage",
                  "Relaxation Techniques", "Special Diet", "Prayer or Spiritual Healing")
row.names(b.freqs) <- c("Acupuncture", "Biofeedback", "Chiropractic", "Energy Healing", 
                  "Exercise and Movement Therapy", "Herbal Therapy", "Vitamins", 
                  "Homeopathy", "Hypnosis", "Imagery Techniques", "Massage",
                  "Relaxation Techniques", "Special Diet", "Prayer or Spiritual Healing")
row.names(c.freqs) <- c("Acupuncture", "Biofeedback", "Chiropractic", "Energy Healing", 
                  "Exercise and Movement Therapy", "Herbal Therapy", "Vitamins", 
                  "Homeopathy", "Hypnosis", "Imagery Techniques", "Massage",
                  "Relaxation Techniques", "Special Diet", "Prayer or Spiritual Healing")

# Next, merge frequency dataframes for all three waves
# Merge freqs and b.freqs 
tmp.a.b <- merge(freqs, b.freqs, by = 0)
# Merge() created a new column row.names 
# Assign the row.names column to row names
rownames(tmp.a.b) <- tmp.a.b[,1]
# Remove Row.names column 
tmp.a.b[,1] <- NULL
# Merge c.freqs to tmp.a.b
all.freqs <- merge(tmp.a.b, c.freqs, by = 0)
# Assign the row.names column to row names
rownames(all.freqs) <- all.freqs[,1]
# Remove Row.names column 
all.freqs[,1] <- NULL

# Order rows by M1 frequency
all.freqs.ordered <- arrange(all.freqs, M1.Frequency)
```

## Data

The data for the exploratory factor analysis come from Wave 1 of the Midlife in the United States (MIDUS) dataset. These data were collected between 1995 and 1996. The analyses include all cases with no missing values on the complementary and alternative medicine (CAM) items (*n* = 6157).

MIDUS includes 15 questions about whether respondents have used a specific type of CAM in the previous 12 months. These CAMs include: biofeedback, hypnosis, acupuncture, energy healing, homeopathy, imagery techniques, vitamins, herbal therapy, massage, special diet, chiropractic, relaxation and meditation techniques, exercise and movement therapy, prayer, and spiritual healing.In the first wave, respondents indicated simply whether they had used each CAMs in the previous 12 months. At Waves 2 and 3, respondents indicated the frequency of use (a lot, often, sometimes, rarely, or never). To maintain consistency between waves, I dichotomized responses at Waves 2 and 3 so that 0 indicates that the respondent never used the CAM in the past year and 1 indicates any use of the CAM in the past year.

### Measures Description

Descriptive statistics for each CAM item are presented in Table \ref{tab:ch1-descriptives}. At Wave 1, biofeedback was the least used CAM (0.8%), followed by hypnosis (1.2%), acupuncture (1.2%), and energy healing (1.5%). Fewer than 100 people report using each of these CAMs. The most frequently utilized CAMs were prayer or spiritual healing (30%), exercise and movement therapy (17.5%), relaxation techniques (13.2%), and chiropractic care (12.0%). At Wave 2, special diet (34.5%) is one of the most frequently reported CAMs. Note however that the diet measure changed between Waves 1 and 2. The original survey question asks respondents whether they have used a special diet to treat health problems or promote wellness. At Wave 2, the wording asks about more specific diets, such as vegetarian, macrobiotic, or Ayurvedic diets. Other frequencies at Waves 2 and 3 are to Wave 1.

```{r ch1-descriptives, echo = FALSE}
kable(all.freqs.ordered,
      booktabs = T,
      col.names = c("Wave 1 Frequency", 
                    "Wave 1 Percent", 
                    "Wave 2 Frequency", 
                    "Wave 2 Percent", 
                    "Wave 3 Frequency",
                    "Wave 3 Percent"),
      caption = "Descriptive Statistics for CAM Use in the Last 12 Months at each Wave") %>%
  kable_classic(html_font = "CMU Serif") %>% 
  kableExtra::landscape() %>%
  kable_styling(latex_options = c("striped", "scale_down")) %>% 
  add_footnote(c("Wave 1 n = 6157", "Wave 2 n = 3834", "Wave 3 n = 2675"), notation="number") 
```

```{r, echo = FALSE, results='hide'}
# Print wave 1 pray spirit crosstab
table.pray.spirit %>% 
  kable(caption = "Crosstab of Prayer and Spiritual Healing Wave 1") %>% 
  kable_styling(bootstrap_options = c("basic"))
# Print wave 2 pray spirit crosstab 
table.pray.spirit.b %>% 
  kable(caption = "Crosstab of Prayer and Spiritual Healing Wave 2") %>% 
  kable_styling(bootstrap_options = c("basic"))
# Print wave 3 pray spirit crosstab
table.pray.spirit.c %>% 
  kable(caption = "Crosstab of Prayer and Spiritual Healing Wave 3") %>% 
  kable_styling(bootstrap_options = c("basic"))
```

The surveys also separated prayer and spiritual healing. Upon inspection of the data, I found that nearly all respondents who reported using spiritual healing also reported using prayer. Tables 3-5 illustrate cross-tabulations of prayer and spiritual healing in each MIDUS wave. Out of 196 respondents that report using spiritual healing, only 11 (5.6%) report using spiritual healing but not prayer for health or healing purposes. Given that these are survey data, it is impossible to know exactly how the respondents interpreted the questions and how their interpretations affected the data, but it appears that the two questions measured the same behavior for most respondents. As a result, I combined these variables into a prayer/spiritual healing variable that codes all respondents that report using prayer or spiritual healing as 1.

## Method

This research utilizes factor analysis to examine the underlying factor structure of CAM utilization. Factor analysis is useful for identifying how groups of variables forms patterns and vary together [@child2006]. It is a statistical technique that reduces a large number of variables into a smaller number of factors. Factor analysis extracts the common variance among multiple variables into a common factor score, and the factor scores operate as an index that can be used for further analysis. In this section, I present factor analysis results. First, I present results from the exploratory factor analysis conducted using the Wave 1 data. Second, I present results from the confirmatory factor analysis conducted on the solution found in the exploratory factor analysis using Wave 2 and Wave 3 data.

```{r, echo = FALSE}
# Create correlation matrix 
het.mat.a <- hetcor(as.data.frame(acams))$cor
# Rename columns for correlation matrix visualization 
colnames(het.mat.a) <- c("Acupuncture", "Biofeedback", "Chiropractic", "Energy Healing", 
                  "Exercise", "Herbal Therapy", "Vitamins", 
                  "Homeopathy", "Hypnosis", "Imagery", "Massage", 
                  "Relaxiation", "Special Diet", "Prayer/Spiritual Healing")
rownames(het.mat.a) <- c("Acupuncture", "Biofeedback", "Chiropractic", "Energy Healing", 
                  "Exercise", "Herbal Therapy", "Vitamins", 
                  "Homeopathy", "Hypnosis", "Imagery Techniques", "Massage",
                  "Relaxiation Techniques", "Special Diet", "Prayer/Spiritual Healing")
```

```{r tetra-corr, echo = FALSE, fig.cap = "Tetrachoric Correlation Matrix"}
#corrplot.mixed(het.mat, tl.pos = "lt", tl.col = "black", tl.cex = .8, tl.srt=45, number.cex = .5, lower.col = "black", order = "hclust")
# col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
# corrplot(het.mat.a, method="color", number.cex = .5, order="hclust", 
#         addCoef.col = "black", # Add coefficient of correlation
#         tl.col="black", tl.srt=45 #Text label color and rotation
#         )
corrplot(het.mat.a, method = "number", number.cex = .5, order = "hclust", tl.col = "black")
```

## Exploratory Factor Analysis

### Assumption Testing

```{r, echo = FALSE, results='hide'}
# This code chunk explores inter-item correlations 

# Create new matrix that is equal to het.mat.a to be used for exploring correlations
asymm.mat <- het.mat.a
upperTriangle(asymm.mat, diag=TRUE, byrow=FALSE) <- NA
asymm.mat

# Create matrix with NAs on diagonal (remove item correlations with themselves)
# Copy het.mat.a
no.diag <- het.mat.a
# Replace diagonals with NAs
diag(no.diag) <- NA
no.diag

# Range of correlations
# Highest correlation in the matrix
max(asymm.mat, na.rm = TRUE)
# Lowest correlation in the matrix
apply(het.mat.a, 1, FUN = min, na.rm = TRUE)
apply(no.diag, 1, FUN = max, na.rm = TRUE)
min(asymm.mat, na.rm = TRUE)

# How many correlations greater than .299
length(asymm.mat[asymm.mat>.299 & !is.na(asymm.mat)])
# How many correlations below .3
length(asymm.mat[asymm.mat<.3 & !is.na(asymm.mat)])
# Percent of correlations greater than .299
length(asymm.mat[asymm.mat>.299 & !is.na(asymm.mat)])/length(asymm.mat[!is.na(asymm.mat)])

# Columns with values less than .3
# Check whether each item correlates with at least one other item at .3
corr.max <- apply(no.diag,2,max, na.rm=TRUE)
corr.max > .3

no.diag <- as.data.frame(no.diag)


sum(no.diag$Acupuncture > .3, na.rm = TRUE)

```

```{r, echo = FALSE, results = 'hide'}
# This code chunk tests for correlation adequacy using Bartlett's test
bartlett <- cortest.bartlett(het.mat.a, n = nrow(acams))
bart.chisq <- round(cortest.bartlett(het.mat.a, n = nrow(acams))$chisq, 2)
```

```{r, echo = FALSE, results = 'hide'}
# This code chunk tests for sampling adequacy using the Kaiser-Meyer-Olkin (KMO) test
KMO(het.mat.a)
kmo <- round(KMO(het.mat.a)$MSA, 2)
```

The factorability of the 14 CAM items was examined. First, it was observed that all items correlated with at least one other item with a correlation of .3, suggesting factorability. Tetrachoric correlations between CAM items can be see in Figure \ref{fig:tetra-corr}. Next, I examined the Kaiser-Meyer-Olkin measure of sampling adequacy, which was `r kmo`, and therefore above the recommended value of at least 0.6. The Kaiser-Meyer-Olkin (KMO) test is a measure of data factorability. The KMO statistic indicates the proportion of variance that might be caused by underlying factors [@kaiser1974]. Next, I tested factorability with Bartlett's Test of Sphericity [@bartlett1950]. Bartlett's Test tests the null hypothesis that the observed correlation matrix is an identity matrix. An identity matrix consists of 1s on the diagonals and 0s in all other cells. An identity correlation matrix indicates that the variables are unrelated and not suitable for factor analysis. The Bartlett's Test of Sphericity was significant ($\chi$^2^(`r bartlett$df`) = `r bart.chisq`, *p* \<.01) indicating that the correlations between variables are higher than would be expected by chance.

```{r, echo = FALSE, results = 'hide', fig.show='hide'}
# This code chunk runs a parallel test 
# Convert acams to numerics for parallel analysis
acams[] <- lapply(acams, function(x) as.numeric(as.character(x)))
str(acams)
parallel.all.cams <- fa.parallel(het.mat.a, n.obs = nrow(acams), fm = "ml", fa = "fa", main = "Parallel Analysis Scree Plot")
```

```{r, echo = FALSE, results='hide'}
# older kaiser criterion, number of eigenvalues greater than 1 
sum(parallel.all.cams$fa.values > 1.0)
# new kaiser criterion, number of eigenvalues greater than 0.7
sum(parallel.all.cams$fa.values > .7)
```

### Results

```{r, echo = FALSE, results='hide'}
# 6 factor maximum likelihood solution had the best fit statistics above. Fit statistics are the same for all rotation methods. Check factor loadings for all rotation methods.
all.6.ml.varimax <- fa(r = het.mat.a, nfactors = 6, n.obs=nrow(acams), rotate = "varimax", max.iter = 100, fm = "ml")
all.6.ml.varimax$loadings
all.6.ml.promax <- fa(r = het.mat.a, nfactors = 6, n.obs=nrow(acams), rotate = "promax", max.iter = 100, fm = "ml")
all.6.ml.promax$loadings
all.6.ml.cluster <- fa(r = het.mat.a, nfactors = 6, n.obs=nrow(acams), rotate = "cluster", max.iter = 100, fm = "ml")
all.6.ml.cluster$loadings
all.6.ml.oblimin <- fa(r = het.mat.a, nfactors = 6, n.obs=nrow(acams), rotate = "oblimin", max.iter = 100, fm = "ml")
all.6.ml.oblimin$loadings
```

```{r, echo = FALSE, results = 'hide'}
# Factor loadings for 5 factor solutions
all.5.ml.varimax <- fa(r = het.mat.a, nfactors = 5, n.obs=nrow(acams), rotate = "varimax", max.iter = 100, fm = "ml")
all.5.ml.varimax$loadings
all.5.ml.promax <- fa(r = het.mat.a, nfactors = 5, n.obs=nrow(acams), rotate = "promax", max.iter = 100, fm = "ml")
all.5.ml.promax$loadings
# In the 5 factor solutions so far, CAMs are loading on multiple factors fairly evenly. Herbal and homeopathy and prayer/spiritual healing. 
all.5.ml.cluster <- fa(r = het.mat.a, nfactors = 5, n.obs=nrow(acams), rotate = "cluster", max.iter = 100, fm = "ml")
all.5.ml.cluster$loadings
# Actually this cluster solution looks pretty good. Prayer/spirit is loading on two factors, and biofeedback is loading on its own factor. Otherwise the factor groupings make sense. 
all.5.ml.oblimin <- fa(r = het.mat.a, nfactors = 5, n.obs=nrow(acams), rotate = "oblimin", max.iter = 100, fm = "ml")
all.5.ml.oblimin$loadings
```

First, I ran the exploratory factor analysis on all 14 CAMs. After examining one through six factor solutions using different extraction and rotation methods, I found that the five and six factor maximum likelihood solutions fit the data best. However, biofeedback consistently loaded onto its own factor, and also had the lowest frequency of use (48 respondents or 0.8%). In light of the few cases reporting use of biofeedback and its failure to load with other items, I dropped biofeedback and ran the analysis with the other 13 CAMs.

```{r, echo = FALSE, results='hide'}
# In the 5 and 6 factor solutions, biofeedback is loading on its own factor consistently. It also has the fewest cases reporting use over the last year. 
# Run analyses dropping biofeedback. 

# Drop biofeedback 
acams.drop.bio <- subset(acams, select = -c(aBiofeedback))
# Convert all columns to factors for tetrachoric correlations 
acams.drop.bio[sapply(acams.drop.bio, is.numeric)] <- lapply(acams.drop.bio[sapply(acams.drop.bio, is.numeric)], as.factor)
str(acams.drop.bio)

# Create new correlation matrix
het.mat.drop.bio <- hetcor(as.data.frame(acams.drop.bio))$cor

# Maximum likelihood 5 factor solutions have best fit statistics. Review the factor loadings and groupings. 
drop.bio.5.ml.varimax <- fa(r = het.mat.drop.bio, nfactors = 5, n.obs=nrow(acams), rotate = "varimax", max.iter = 100, fm = "ml")
drop.bio.5.ml.varimax$loadings
drop.bio.5.ml.promax <- fa(r = het.mat.drop.bio, nfactors = 5, n.obs=nrow(acams), rotate = "promax", max.iter = 100, fm = "ml")
drop.bio.5.ml.promax$loadings
drop.bio.5.ml.oblimin <- fa(r = het.mat.drop.bio, nfactors = 5, n.obs=nrow(acams), rotate = "oblimin", max.iter = 100, fm = "ml")
drop.bio.5.ml.oblimin$loadings
drop.bio.5.ml.cluster <- fa(r = het.mat.drop.bio, nfactors = 5, n.obs=nrow(acams), rotate = "cluster", max.iter = 100, fm = "ml")
drop.bio.5.ml.cluster$loadings
# Consistent patterns: Acupuncture, herbal, vitamins, and homeopathy tend to load onto the same factor. This is also what Ayers and Kronenfeld found. Imagery tech, meditation, and prayer tend to go together. Imagery techniques also tend to load with hypnosis and energy healing. Exercise/movement is tending to load onto its own factor in the 5 factor solutions. Chiropractic and massage consistently load together. 
```

```{r, echo = FALSE, results = 'hide'}
# 4 factor maximum likelihood solutions fit the data well- some statistics are just below the cutoff, and the BIC is a bit higher. 
drop.bio.4.ml.varimax <- fa(r = het.mat.drop.bio, nfactors = 4, n.obs=nrow(acams), rotate = "varimax", max.iter = 100, fm = "ml")
drop.bio.4.ml.varimax$loadings
drop.bio.4.ml.promax <- fa(r = het.mat.drop.bio, nfactors = 4, n.obs=nrow(acams), rotate = "promax", max.iter = 100, fm = "ml")
drop.bio.4.ml.promax$loadings
drop.bio.4.ml.oblimin <- fa(r = het.mat.drop.bio, nfactors = 4, n.obs=nrow(acams), rotate = "oblimin", max.iter = 100, fm = "ml")
drop.bio.4.ml.oblimin$loadings
drop.bio.4.ml.cluster <- fa(r = het.mat.drop.bio, nfactors = 4, n.obs=nrow(acams), rotate = "cluster", max.iter = 100, fm = "ml")
drop.bio.4.ml.cluster$loadings
# Cluster solution looks pretty good- All the mind-body therapies load together. Acupuncture, herbal, and homeopathy load together - alternative systems. Chiropractic and massage load together - manipulative therapies. Exercise, vitamins, and special diet load together - physiological/nutrition. According to the NCCIH these would all be physical, but the difference between chiro/massage and diet/vitamins/nutrition is you don't need to see a professional (professionally organized therapies). 

# Assign CFI for the cluster solution to an object for inclusion in text 
drop.bio.4.ml.cluster.cfi <- 1 - ((drop.bio.4.ml.cluster$STATISTIC-drop.bio.4.ml.cluster$dof)/(drop.bio.4.ml.cluster$null.chisq-drop.bio.4.ml.cluster$null.dof))
```

```{r, echo = FALSE}
# This code chunk creates a table of fit statistics for the final efa model 

# Create empty dataframe
fa.fit.statistics <- data.frame(Model=0, Chi.Square=0, CFI=0, TLI=0, RMSR=0, RMSEA=0)  

# Add in fit statistics from the efa model 
fa.fit.statistics[1, "Model"] <- "Wave 1 Exploratory Factor Analysis"
fa.fit.statistics[1, "Chi.Square"] <- paste(round(drop.bio.4.ml.cluster$STATISTIC, 3),"(", drop.bio.4.ml.cluster$dof, ")", " p<.001", sep = "")
fa.fit.statistics[1, "CFI"] <- round(1 - ((drop.bio.4.ml.cluster$STATISTIC-drop.bio.4.ml.cluster$dof)/(drop.bio.4.ml.cluster$null.chisq-drop.bio.4.ml.cluster$null.dof)), 2)
fa.fit.statistics[1, "TLI"] <- round(drop.bio.4.ml.cluster$TLI, 2)
fa.fit.statistics[1, "RMSR"] <- round(drop.bio.4.ml.cluster$rms, 3)
fa.fit.statistics[1, "RMSEA"] <- round(drop.bio.4.ml.cluster$RMSEA[1], 3)
```

I ran one through five factor models using various extraction and rotation methods. While the five factor maximum likelihood solutions fit the data best, the four factor maximum likelihood solution with cluster rotation fit the data nearly as well and produced more interpretable factors. As a result, I chose the four factor maximum likelihood solution with cluster rotation the final measurement model. The four factors in the final model account for `r round(drop.bio.4.ml.cluster$Vaccounted["Cumulative Var","ML3"],2)` of the variance in the data.

I evaluated model fit using the $\chi$^2^ statistic, root mean square of approximation (RMSEA), root mean square residual (RMSR), comparative fit index (CFI), and Tucker-Lewis index (TLI). In the case of factor analysis, a significant $\chi$^2^ indicates a poor fitting model. However, the $\chi$^2^ is sensitive to large sample sizes and may erroneously indicate that a model is a poor fit (Byrne 1989). The normed $\chi$^2^ ($\chi$^2^/*df*) minimizes this sensitivity. The $\chi$^2^ for the model presented here indicates poor fit $\chi$^2^(`r round(drop.bio.4.ml.cluster$dof, 3)`)=`r round(drop.bio.4.ml.cluster$STATISTIC, 3)`, *p*\<.001. I use a combination of absolute and relative fit indices to assess model fit (Chen 2007). The comparative fit index (CFI) and Tucker-Lewis index (TLI) are relative fit indices that compare the fit of the hypothesized model to a baseline model (i.e. the worst fitting model). Values above 0.90 indicate good fit. The root mean square error of approximation (RMSEA) is an index of the difference between the observed covariance matrix per degrees of freedom and the hypothesized covariance matrix. Values below 0.08 indicate good fit. The standardized root mean square residual (SRMR) an index of the average of standardized residuals between the observed and hypothesized covariance matrix. Values below 0.08 indicate good fit. The CFI (CFI=`r round(drop.bio.4.ml.cluster.cfi, 3)`), TLI (TFI= `r round(drop.bio.4.ml.cluster$TLI, 3)`), and RMSR (RMSR= `r round(drop.bio.4.ml.cluster$rms, 3)`) indicate good model fit. The CFI is above the desired cutoff of 0.90. The TLI is just below the desired cutoff of 0.90 However, the RMSEA is slightly higher than the desirable 0.08 cutoff (RMSEA= `r round(drop.bio.4.ml.cluster$RMSEA[1],3)`).

```{r, echo = FALSE}
# Import organized loadings table from excel
loadings.table <- read.csv(
  file = "EFA-loadings-table.csv",
  header = TRUE,
  sep = ",",
  dec = ".",
  stringsAsFactors = TRUE
)

loadings.table <- select(loadings.table, -X.1)
loadings.table <- select(loadings.table, -X.2)

# Function to control line separation in kable 
linesep<-function(x,y=character()){
  if(!length(x))
    return(y)
  linesep(x[-length(x)], c(rep('',x[length(x)]-1),'\\addlinespace',y))  
}
# Set NAs as blank in kable loadings table 
options(knitr.kable.NA = '')
```

```{r, efa-loadings-table, echo = FALSE}
# Print loadings table 
kable(loadings.table,
      booktabs = T,
      linesep = linesep(c(6, 4, 4)),
      col.names = c("",
                  "Factor 1",
                  "Factor 2",
                  "Factor 3", 
                  "Factor 4", 
                  "Communality"),
      caption = "Exploratory Factor Analysis of CAMs Wave 1 (n = 6157)") %>%
  kable_classic(html_font = "CMU Serif") %>% 
  kableExtra::landscape()
```

The cluster rotation factor loadings for the 13 CAM types are shown in Table \ref{tab:efa-loadings-table}. Five items had moderate to high loadings on Factor 1, Mind-Body Medicine (prayer or spiritual healing, energy healing, imagery techniques, relaxation and meditation techniques, and hypnosis). This factor measures the use of the mind to improve health and wellness. Three items had moderate to high loadings on Factor 2, Alternative Medical Systems (homeopathy, herbal therapy, and acupuncture). This factor measures use of CAM built on complete systems of theory and practice. Three items loaded moderately to heavily on Factor 3, Physical and Nutritional Approaches (vitamins, exercise and movement, and special diet). This factor measures use of CAMs that involve physical activity and nutrition. Two items loaded moderately to heavily on Factor 4, Manipulative Treatments (massage and chiropractic care). Communality is the proportion of the items' variance that is explained by the factors. While higher communalities are desirable, values between 0.25 and 0.40 are acceptable cutoffs. Communality values for all items in the analysis are acceptable. This factor measures use of external physical manipulation to promote health and wellness.

```{r, echo = FALSE, results='hide'}
# Check reliability for the 4 Factor Solution using Maximum Likelihood and cluster rotation. Prayer and spiritual healing have been combined, and biofeedback dropped (because it was loading onto its own factor). 

# Convert acams.drop.bio to numeric 
acams.drop.bio[] <- lapply(acams.drop.bio, function(x) as.numeric(as.character(x)))
str(acams.drop.bio)
# Calculate Kuder-Richardson coefficient for binary data 
CronbachAlpha(acams.drop.bio)

# Reliability for factor 1 
f1 <- acams.drop.bio[c("aEnergyHeal", "aHypnosis", "aImageryTech", "aRelaxMeditate", "aPraySpirit")]
head(f1)
CronbachAlpha(f1)

# Reliability for factor 2 
f2 <- acams.drop.bio[c("aAcupuncture", "aHerbal", "aHomeopathy")]
head(f2)
CronbachAlpha(f2)
# Reliability for factor 3 
f3 <- acams.drop.bio[c("aExerciseMove", "aVitamins", "aSpecialDiet")]
head(f3)
CronbachAlpha(f3)
# Reliability for factor 4 
f4 <- acams.drop.bio[c("aChiropractic", "aMassage")]
head(f4)
CronbachAlpha(f4)

round(cor(f1),2)
alpha(f1)
alpha(f2)

```

Next I assess the validity and reliability of the four factor. Construct validation refers to whether a test reasonably measures the intended theoretical construct and can be tested through convergent and discriminant validity [@brown2015]. When testing constructs developed with factor analysis, convergent validity refers to whether the observed measures are interrelated, and discriminant validity refers to whether the theoretical factors are distinct and not intercorrelated [@brown2015]. Factor loadings are an indicator of convergent validity. If all factor loadings are above 0.5, the factor is considered to have convergent validity. All items in the current four factor model load above 0.5 on the appropriate factors, indicating the four factors have convergent validity. A model demonstrates discriminant validity when all items load strongly onto only one factor. All items in the four factor model load strongly (above 0.5) on only one factor. This indicates that all items loaded onto each factor measure the same underlying theoretical construct and each factor measures a distinct underlying theoretical construct.

Reliability is tested with Cronbach's alpha. Cronbach's alpha is `r CronbachAlpha(f1)` for Mind-Body Medicine, `r CronbachAlpha(f2)` for Alternative Medical Systems, `r CronbachAlpha(f3)` for Physical and Nutritional Approaches, and `r CronbachAlpha(f4)`. This is unsurprising as Cronbach's alpha is known to underestimate the internal consistency of scales with fewer than ten items [@herman2015]. The Spearman-Brown prophecy formula (SB formula) is used to calculate the reliability of a scale when the number of items is changed [@devet2017], and has been used in previous research to justify use of scales with low Cronbach's alpha due to a small number of items [@vangriethuijsen2015]. The SB formula shows that slight increases in the number of items would lead to acceptable Cronbach's alpha values. Adding 2.34 items to the mind-body factor, 2.08 items to the alternative medical systems factor, 3.26 items to the physical and nutritional approaches factor, and 3.47 items to the manipulative treatments factor would led acceptable Cronbach's alpha values. Thus, the low Cronbach's alpha scores can be attributed to the small number of items and do not raise concerns about reliability of the factors.

## Confirmatory Factor Analysis

```{r, echo = FALSE, results='hide'}
# Run confirmatory factor analysis on the 4 factor ML cluster solution (drop bio)

# Convert acams.drop.bio columns to ordered factors
## Convert to factors 
acams.drop.bio[] <- lapply(acams.drop.bio[], as.factor)
head(acams.drop.bio)
## Order factors
acams.drop.bio[] <- lapply(acams.drop.bio, function(x) factor(x, 
                                                              levels = c("0", "1"),             
                                                              ordered = TRUE))
str(acams.drop.bio)
# Check that frequencies are the same
drop.bio.freqs <- freq_dframer(acams.drop.bio)
# Add print out of acams freqencies here 
drop.bio.freqs 
# They are the same. 

# Assigning items to factors 
efa.model <- 'f1 =~ aPraySpirit + aHypnosis + aImageryTech + aRelaxMeditate + aEnergyHeal
        f2 =~ aAcupuncture + aHerbal + aHomeopathy
        f3 =~ aExerciseMove + aVitamins + aSpecialDiet
        f4 =~ aChiropractic + aMassage '
# Run CFA model 
fit <- cfa(efa.model, data = acams.drop.bio,
             ordered = TRUE)
# Review fit statistics
summary.fit.1 <- summary(fit, fit.measures = TRUE)
summary(fit, standardized = TRUE)
# Helpful link/tutorial: https://benwhalley.github.io/just-enough-r/cfa.html
# sempaths documentation: https://www.rdocumentation.org/packages/semPlot/versions/1.1.2/topics/semPaths
```

```{r, echo = FALSE, results = 'hide'}
# This code chunk explores the modification indices- whether freeing parameter constraints or adding paths to the model would help improve it. 

modificationindices(fit) %>% 
  as.data.frame() %>%  # read the modification indices output in as a dataframe
  arrange(-mi) %>%  # sorts the rows by the mi column, which represents the change in the model chi-square we see if the path was included
  filter(mi > 10) %>%  # filter the results to show only those with chi-square change > 10
  select(lhs, op,rhs, mi, epc) %>%  # select only these columns from the modification indices output
  pander(caption = "Largest MI values for CFA")

# The largest mi suggests exercise/movement should be linked to Factor 4
# Model with largest mi change 
efa.model.2 <- 'f1 =~ aPraySpirit + aHypnosis + aImageryTech + aRelaxMeditate + aEnergyHeal
        f2 =~ aAcupuncture + aHerbal + aHomeopathy
        f3 =~ aVitamins + aSpecialDiet
        f4 =~ aChiropractic + aMassage + aExerciseMove'
# Run CFA model 
fit.2 <- cfa(efa.model.2, data = acams.drop.bio,
             ordered = TRUE)

# Compare fit statistics 
fit.stats.1 <- fitmeasures(fit, c("cfi", "tli", "rmsea", "bic"))
fit.stats.2 <- fitmeasures(fit.2, c("cfi", "tli", "rmsea", "bic"))
fit.stats.1
fit.stats.2

# No change to the fit statistics. Look at full model summary
summary.fit.2 <- summary(fit.2, fit.measures = TRUE)

# Model Plot 
#semPlot::semPaths(fit, "std")
```

```{r, echo = FALSE, results='hide'}
# Run confirmatory factor analysis on the 4 factor ML cluster solution (drop bio) at Wave 2 

# Drop biofeedback 
bcams.drop.bio <- subset(bcams, select = -c(bBiofeedback))

# Order factors
bcams.drop.bio[] <- lapply(bcams.drop.bio, function(x) factor(x, 
                                                              levels = c("0", "1"),             
                                                              ordered = TRUE))

# Check that frequencies are the same
drop.bio.freqs <- freq_dframer(bcams.drop.bio)
b.freqout.is1 
drop.bio.freqs 
# They are the same. 

# Assigning items to factors 
b.cfa <- 'f1 =~ bPraySpirit + bHypnosis + bImageryTech + bRelaxMeditate + bEnergyHeal
        f2 =~ bAcupuncture + bHerbal + bHomeopathy
        f3 =~ bExerciseMove + bVitamins + bSpecialDiet
        f4 =~ bChiropractic + bMassage '
# Run CFA model 
b.fit <- cfa(b.cfa, data = bcams.drop.bio,
             ordered = TRUE)
# Review fit statistics
b.fit.summary <- summary(b.fit, fit.measures = TRUE)
summary(b.fit, standardized = TRUE)
# Helpful link/tutorial: https://benwhalley.github.io/just-enough-r/cfa.html
# sempaths documentation: https://www.rdocumentation.org/packages/semPlot/versions/1.1.2/topics/semPaths
```

```{r, echo = FALSE, results='hide'}
# Run confirmatory factor analysis on the 4 factor ML cluster solution (drop bio) at Wave 3 

# Drop biofeedback 
ccams.drop.bio <- subset(ccams, select = -c(cBiofeedback))

# Order factors
ccams.drop.bio[] <- lapply(ccams.drop.bio, function(x) factor(x, 
                                                              levels = c("0", "1"),             
                                                              ordered = TRUE))
str(ccams.drop.bio)
# Check that frequencies are the same
drop.bio.freqs <- freq_dframer(ccams.drop.bio)
c.freqout.is1 
drop.bio.freqs 
# They are the same. 

# Assigning items to factors 
c.cfa <- 'f1 =~ cPraySpirit + cHypnosis + cImageryTech + cRelaxMeditate + cEnergyHeal
        f2 =~ cAcupuncture + cHerbal + cHomeopathy
        f3 =~ cExerciseMove + cVitamins + cSpecialDiet
        f4 =~ cChiropractic + cMassage '
# Run CFA model 
c.fit <- cfa(c.cfa, data = ccams.drop.bio,
             ordered = TRUE)
# Review fit statistics
c.fit.summary <- summary(c.fit, fit.measures = TRUE, standardized = TRUE)
summary(c.fit, standardized = TRUE)
# Helpful link/tutorial: https://benwhalley.github.io/just-enough-r/cfa.html
# sempaths documentation: https://www.rdocumentation.org/packages/semPlot/versions/1.1.2/topics/semPaths
```

```{r, echo = FALSE, results='hide'}
# Reliability 
# semTools::reliability(fit)
```

Table \ref{tab:gof-table} reports goodness of fit statistics, which indicate good model fit for all waves. CFI is 0.99 for all waves, well above the 0.90 cutoff. TLI is greater than or equal to 0.98, well above the 0.90 cutoff. RMSR is less than or equal to 0.078, below the 0.08 cutoff. RMSEA is less than or equal to 0.032 for all CFAs, well below the 0.08 cutoff.

```{r gof-table, echo = FALSE}
# This code chunk adds fit statistics for the CFAs.

# Add in fit statistics from the wave 1 cfa model 
fa.fit.statistics[2, "Model"] <- "Wave 1 Confirmatory Factor Analysis"
fa.fit.statistics[2, "Chi.Square"] <- paste(round(fitMeasures(fit, "chisq"), 3),"(", fitMeasures(fit, "df"), ")", " p<.001", sep = "")
fa.fit.statistics[2, "CFI"] <- round(fitMeasures(fit, "cfi"), 2)
fa.fit.statistics[2, "TLI"] <- round(fitMeasures(fit, "tli"), 2)
fa.fit.statistics[2, "RMSR"] <- round(fitMeasures(fit, "rmr"), 3)
fa.fit.statistics[2, "RMSEA"] <- round(fitMeasures(fit, "rmsea"), 3)

# Add in fit statistics from the wave 2 cfa model 
fa.fit.statistics[3, "Model"] <- "Wave 2 Confirmatory Factor Analysis"
fa.fit.statistics[3, "Chi.Square"] <- paste(round(fitMeasures(b.fit, "chisq"), 3),"(", fitMeasures(b.fit, "df"), ")", " p<.001", sep = "")
fa.fit.statistics[3, "CFI"] <- round(fitMeasures(b.fit, "cfi"), 2)
fa.fit.statistics[3, "TLI"] <- round(fitMeasures(b.fit, "tli"), 2)
fa.fit.statistics[3, "RMSR"] <- round(fitMeasures(b.fit, "rmr"), 3)
fa.fit.statistics[3, "RMSEA"] <- round(fitMeasures(b.fit, "rmsea"), 3)

# Add in fit statistics from the wave 3 cfa model 
fa.fit.statistics[4, "Model"] <- "Wave 3 Confirmatory Factor Analysis"
fa.fit.statistics[4, "Chi.Square"] <- paste(round(fitMeasures(c.fit, "chisq"), 3),"(", fitMeasures(c.fit, "df"), ")", " p<.001", sep = "")
fa.fit.statistics[4, "CFI"] <- round(fitMeasures(c.fit, "cfi"), 2)
fa.fit.statistics[4, "TLI"] <- round(fitMeasures(c.fit, "tli"), 2)
fa.fit.statistics[4, "RMSR"] <- round(fitMeasures(c.fit, "rmr"), 3)
fa.fit.statistics[4, "RMSEA"] <- round(fitMeasures(c.fit, "rmsea"), 3)

# Add row for fit guidelines
fa.fit.statistics[5, "Model"] <- "Fit Guidelines"
fa.fit.statistics[5, "Chi.Square"] <- ""
fa.fit.statistics[5, "CFI"] <- paste(">.95")
fa.fit.statistics[5, "TLI"] <- paste(">.95")
fa.fit.statistics[5, "RMSR"] <- paste("<.08")
fa.fit.statistics[5, "RMSEA"] <- paste("<.08")

kable(fa.fit.statistics,
      booktabs = T,
      col.names = c("Model", 
                    "Chi-Square(df)", 
                    "CFI", 
                    "TLI", 
                    "RMSR", 
                    "RMSEA"),
      caption = "Goodness of Fit Statistics") %>%
  kable_classic(html_font = "CMU Serif") %>% 
  add_footnote(c("Wave 1 n = 6157, Wave 2 n = 3834, Wave 3 n = 2675", "Values meeting fit guidelines indicate good model-data fit."), notation="number") 

```

```{r, echo = FALSE}
# Import organized loadings table from excel
loadings.table <- read.csv(
  file = "CFA-std-loadings.csv",
  header = TRUE,
  sep = ",",
  dec = ".",
  stringsAsFactors = TRUE
)

# Function to control line separation in kable 
linesep<-function(x,y=character()){
  if(!length(x))
    return(y)
  linesep(x[-length(x)], c(rep('',x[length(x)]-1),'\\addlinespace',y))  
}
# Set NAs as blank in kable loadings table 
options(knitr.kable.NA = '')
```

```{r cfa-loadings-table, echo = FALSE}
# Print loadings table 
kable(loadings.table,
      booktabs = T,
      linesep = linesep(c(6, 4, 4)),
      col.names = c("",
                  "Wave 1",
                  "Wave 2",
                  "Wave 3"),
      caption = "Confirmatory Factor Analysis Standardized Loadings for All Waves") %>%
  kable_classic(html_font = "CMU Serif")
```

To examine the reliability of the factors that the exploratory factor analysis identified, I loaded the CAMs at waves 1, 2, and 3 on the 4 factors: Mind-Body Medicine, Alternative Medical Systems, Physical and Nutritional Approaches, and Manipulative Treatments. Standardized loadings are reported in Table \ref{tab:cfa-loadings-table}. Nearly all CAMs have loadings above 0.50 on the appropriate factor. The exception is special diet, which loads at 0.42 on Physical and Nutritional Approaches at wave 2.

## Conclusion

Results from the exploratory factor analysis revealed a 4-factor structure underlying CAM utilization. Thirteen CAMs loaded independently onto the identified factors. The four factors include Mind-Body Medicine, Alternative Medicine Systems, Physical and Nutritional Approaches, and Manipulative Treatments. Mind-Body Medicine included meditation and relaxation techniques, prayer and spiritual healing, energy healing, imagery techniques, and hypnosis. Alternative Medical Systems included homeopathy, herbal therapy, and acupuncture. Physical and Nutritional Approaches included vitamins, exercise and movement therapy, and special diet. Confirmatory factor analyses across all three waves of the MIDUS data confirmed that the four factor solution fit the observed data well.

This study extends efforts to advance the measurement of health lifestyles in the following ways. First, patterns of behavior within CAMs have been largely limited to dummy measures of any CAM use and co-occurrence indices [@barnes2008; @clarke2015; @johnson2018; @rhee2018]. Studies of subgroups of CAM behaviors have made comparisons based on the domains described by the NCCIM [@ellison2012; @honda2005; @mbizo2018]. This study extends these efforts by empirically testing the factor structure underlying CAM behaviors. A limitation of the exploratory factor analysis was the number of items, which resulted in factors with low reliability due to the small number of items. However, the SB formula showed that slight increases in the number of items for each factor would lead to acceptable Cronbach's alpha values. This indicates that the low reliability is due to the small number of items as opposed to issues of reliability. Furthermore, the four-factor model demonstrated good convergent and discriminant validity and good model fit. Confirmatory factor analyses on all three waves of data validated the findings from the exploratory factor analysis. Second, this study extends health lifestyle measurement efforts to a virtually ignored domain of health behaviors, CAMs. Health behaviors refer to actions or habits that influence health or that people undertake to stay healthy. Health lifestyles research is concerned with behaviors people engage in in the pursuit of health [@lawrence2017]. Recent empirical research on health lifestyles has emphasized the importance of widening the range of behaviors examined as part of health lifestyles [@cockerham2017; @mize2017; @mollborn2014; @saintonge2017; @skalamera2016]. CAMs represent a subset of health behaviors utilized by a significant portion of the population in the pursuit of health and well-being [@clarke2015]. Thus, their inclusion in the study of health lifestyles aids in our understanding of patterns of health related behaviors. Finally, by examining patterns of behaviors rather than single behaviors, this measurement study examines how individual behaviors coalesce into meaningful patterns and contributes to health lifestyle perspectives [@bourdieu1984; @cockerham2005]. Understanding the ways in which behaviors coalesce into meaningful patterns gives us insight into how these patterns reflect dispositions to act that are structured by social positions such as SES [@saintonge2017].
