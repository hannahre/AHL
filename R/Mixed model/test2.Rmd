---
title: "Mixed Model"
author: "Hannah Andrews"
date: "2/9/2022"
output:
  bookdown::pdf_document2:
    latex_engine: xelatex
bibliography: references.bib
link-citations: true
header-includes:
   - \usepackage{rotating, graphicx, longtable}
   - \extrafloats{200}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

```

```{r, include=FALSE}
options(tinytex.verbose = TRUE)
```

```{r, echo = FALSE}
library(lme4)
library(lattice)
library(sjstats)
library(jtools)
library(ROCR)
library(sjPlot)
library(performance)
library(XML)
library(kableExtra)
library(tidyverse)
library(caTools)
library(fastDummies)
library(semptools)
library(semoutput)
library(lavaan)
library(semPlot)
library(stargazer)
library(semTable)
library(rstatix)
library(gtsummary)
library(forcats)
setwd("C:/Users/hanna/Documents/git/AHL/R/")
load("waves123.long.rda")
load("waves123.long.complete.rda")
load("waves123.wide.rda")
load("waves12.wide.complete.rda")
load("waves23.wide.complete.rda")
load("waves13.wide.complete.rda")
setwd("C:/Users/hanna/Documents/git/AHL/R/Mixed model")
# Tutorials
# https://lmudge13.github.io/sample_code/mixed_effects.html
# Converting html to pdf https://github.com/gorkang/html2latex/
```

```{r, include=FALSE}
options(tinytex.verbose = TRUE)
```


```{r path-data-recodes, echo = FALSE, results='hide'}
# Order Education levels
path.waves123.wide <- waves123.wide %>%
  mutate(waves123.wide = factor(Education_W1, levels = c("Less than High School", "HS Diploma/GED", 
                                                "Some College/AA Degree", "College Grad",
                                                "Graduate or Professional Degree"), labels = 1:5, ordered = TRUE))

# Order education levels
path.waves123.wide <- path.waves123.wide %>%
  mutate(path.waves123.wide = factor(Education_W2, levels = c("Less than High School", "HS Diploma/GED", 
                                                "Some College/AA Degree", "College Grad",
                                                "Graduate or Professional Degree"), labels = 1:5, ordered = TRUE))

# Order Education levels
path.waves123.wide <- path.waves123.wide %>%
  mutate(path.waves123.wide = factor(Education_W3, levels = c("Less than High School", "HS Diploma/GED", 
                                                "Some College/AA Degree", "College Grad",
                                                "Graduate or Professional Degree"), labels = 1:5, ordered = TRUE))


# Create dummy variables for race
path.waves123.wide <- dummy_cols(path.waves123.wide, select_columns = 'Race_W2', ignore_na = TRUE)
path.waves123.wide <- rename(path.waves123.wide, 
                             MexicanHispanic_W2 = "Race_W2_Mexican American and Other Hispanic",
                             Black_W2 = "Race_W2_Non-Hispanic Black", 
                             OtherRace_W2 = "Race_W2_Other Race",
                             White_W2 = "Race_W2_Non-Hispanic White")

# Order SRH levels
path.waves123.wide <- path.waves123.wide %>%
  mutate(waves123.wide = factor(SRH_W2, levels = c("Poor", "Fair", "Good",
                                                   "Very Good", "Excellent"), 
                                labels = 1:5, 
                                ordered = TRUE))


# Order SRH levels
path.waves123.wide <- path.waves123.wide %>%
  mutate(waves123.wide = factor(SRH_W3, levels = c("Poor", "Fair", "Good",
                                                   "Very Good", "Excellent"), 
                                labels = 1:5, 
                                ordered = TRUE))
# Order Sex_W1
path.waves123.wide <- path.waves123.wide %>% 
  mutate(waves123.wide = factor(Sex_W1, levels = c("Male", "Female"),
                                labels = 0:1, 
                                ordered = TRUE))

# Order 
```

```{r listwise-delete-path-data, echo =FALSE}
myvars <- c("mindbody_W2", "mindbody_W3", "altmed_W2", "altmed_W3", "pna_W2", "pna_W3", "manipulative_W2", "manipulative_W3", "totalCams_W2", "totalCams_W3", "SumChron_W2", "SumChron_W3", "SRH_W2", "SRH_W3", "LogIncome_W1", "Education_W1", "Sex_W1", "Age_W2", "Age_W3", "Marital_W2", "Marital_W3", "HlthInsurance_W2", "HlthInsurance_W3", "HLSelf_W2", "HLSelf_W3", "Spiritual_W2", "Spiritual_W3", "Religion_W2", "Religion_W3", "MexicanHispanic_W2", "Black_W2", "OtherRace_W2")

path.complete <- path.waves123.wide[myvars]

path.complete <- path.complete[complete.cases(path.complete),]

```

# Previous Research on SES and CAM Use

Those with higher levels of education tend to use CAMs at higher rates [@barnes2008; @clarke2015; @honda2005; @mbizo2018; @ni2002; @upchurch2018]. @clarke2015 found that in 2002, 18.6% of adults with less than a high school diploma reported CAM use, followed by 18.8% in 2007, and 15.6% in 2012. In 2002, 26.6% of adults with a high school diploma or General Educational Development high school equivalency diploma (GED) reported CAM use, followed by 28.1% in 2007, and 24.4% in 2012. In 2002, 35.6% of adults with some college education reported CAM use, followed by 41.3% in 2007, and 36.5% in 2012. In 2002, 42.1% of adults with a college degree or higher reported CAM use, followed by 46.7% in 2007, and 42.6% in 2012 [@clarke2015]. @barnes2008 reported the following rates of CAM use in 2007 for six educational categories: 20.8% of adults with less than a high school diploma, 31.0% of adults with a high school diploma or equivalent, 45% of adults with some college, 47.2% of adults with an Associates degree, 49.6% of those with a Bachelors, and 55.4% of those with a Masters, Doctorate, or Professional degree. @hildreth2007 also found that use of any CAMs increased by level of education; however, among those that used any CAM in the past year, the authors found a threshold effect. Only those with a college degree or more used significantly more types of CAMs compared to those without a high school diploma.

Findings on the rate of CAM use by income have been mixed across studies. @mbizo2018 found that overall CAM use was significantly different across five income categories. Overall CAM use increased by income across the first four income categories; however, the highest income category (\$75,000+) only reported greater use than the lowest income category (\<\$20,000). Among those who have utilized CAMs in the past year, @hildreth2007a did not find a significant association between income and any CAM use or number of CAMs utilized. @clarke2015 found that CAM use was higher for not-poor adults (measured as poverty-income ratio), followed by near poor, and lowest among the poor across 2002, 2007, and 2012. CAM use ranged from 20.6% in 2012 to 26.6% in 2002 among the poor, from 25.5% in 2012 to 27.7% in 2002 among the near poor, and 36.8% in 2002 to 40.3% in 2007 among the not poor. @ni2002a found that those making less than \$20,000 per year reported less CAM use than those making \$20,000 per year or more.

# The Relationship Between CAM Use and Health

For most CAMs, there is little to no evidence of clinical effectiveness, though this has been shown to vary by intended use. For example, in a systematic review of CAM studies, @ernst2000 found convincing evidence that acupuncture relieves nausea but no convincing evidence that acupuncture relieves chronic pain. Ernst also found that herbal supplements such as St. John's wort for depression and Ginkgo biloba for intermittent claudication (i.e. muscle pain with mild exertion) were both more effective than placebos. Ernst found no convincing clinical evidence for the effectiveness of chelation therapy, homeopathy, massage, reflexology, or spiritual healing for treating a variety of ailments. In a review of studies on the efficacy of CAM use for treating chronic pain, @tan2007 also found mixed evidence for CAMs as a group, though efficacy varied across the CAM domains. @tan2007 found biologically based medicine, some forms of energy medicine, mind-body medicine, and manipulative body-based medicine to range from possibly efficacious to evidently efficacious. Only hypnosis was found to be evidently efficacious and specific for treating chronic pain. Reiki, a form of energy healing, was not efficacious in treating chronic pain.

If the efficacy of CAMs is questionable at best, what motivates their use? A range of motivations have been considered by previous literature, including perceptions of effectiveness and safety, congruence with spiritual philosophy and health beliefs, a sense of control over one's health, dissatisfaction with conventional medicine, and treatment of specific conditions, particularly chronic pain [@barnes2008; @ernst2000; @greene2009; @sirois2002]. Whereas the effectiveness of CAMs has not been well-supported in clinical trials, CAM users report both physical and psychological health benefits, such as improved physical functioning, relief of negative physical symptoms, improved coping and resilience, and decreased symptoms of depression and anxiety [@greene2009]. Perceived effectiveness of CAMs among users appears to be amplified by a motivation toward general health and wellness. Drawing on 2012 National Health Interview Survey data, @rhee2018 found that compared to individuals who use CAMs for treatment only, individuals who utilize CAMs for general wellness in addition to the treatment of specific conditions report a better sense of control over their health and improved overall health. This may indicate that CAM use has particularly positive perceived benefits for those who are consciously motivated toward general health and well-being.

# Questions and hypotheses

This chapter examines the relationships between SES, CAM use, and health. Analysis is conducted in three parts. In the first step of analysis I address the question of whether CAM use is related to SES as measured by income and education. Outcomes include a measure of total CAMs used as well as binary indicators of whether respondents use each of the types of CAMs identified in the previous chapter (mind-body medicines, alternative medicines, physical and nutritional approaches, and manipulative treatments). I hypothesize that CAM use is positively related to income (hypothesis #1) and education (hypothesis #2).

In the second step of analysis I examine two possible mediation processes. First, I examine whether CAM use mediates the relationship between SES and health. I hypothesize that individuals with high SES are more likely to use CAMs, and that this in turn leads to better health outcomes (hypothesis #3). Second, I examine whether health mediates the relationship between SES and CAM use. While I expect that CAM use influences health, it is also possible that health influences CAM use. Thus it is important to examine both directions of this relationship. I expect to find that SES influences health, and that health in turn influences CAM use (hypothesis #4).

In the final step of analysis I examine income and education as moderators of the relationship between changes in health and changes in CAM use. First, I examine whether change in health status as measured by changes in chronic conditions and self-reported health. I expect to find that individuals who experience a decline in health status are more likely to adopt new CAMs (hypothesis #5). Second, I examine whether this relationship is moderated by income and education. I expect to find that individuals with higher incomes are more likely to adopt new CAMs in response to a decline in health compared to those with lower incomes (hypothesis #6). I also expect to find that individuals with higher levels of education are more likely to adopt new CAMs in response to a decline in health compared to those with lower levels of education (hypothesis #7).

In sum, I will be testing the following hypotheses.

1.  CAM use is positively related to income.
2.  CAM use is positively related to education.
3.  CAM use mediates the relationship between SES and health.
4.  Health mediates the relationship between SES and CAM use.
5.  A decline in health status will result in higher CAM use.
6.  Those with higher incomes are more likely to adopt new CAMs in the event of a health decline compared to those with lower incomes.
7.  Those with higher levels of education are more likely to adopt new CAMs in the event of a health decline compared to those with lower levels of education.

# Data 

Data from all three waves of MIDUS were used in various combinations depending on the analysis. Sample sizes varied depending on the data used. In the first stage of analysis, 
*n* = `r length(unique(waves123.long.complete$M2ID))`. The method used, generalized linear mixed modeling, allows for keeping all observations that responded to at least two waves. In the second stage of analysis, *n* = `r nrow(path.complete)`. Only cases that were complete on all included variables were included in analysis. In the final stage of analysis, values across waves were compared in the following combinations: waves 1 and 2, waves 2 and 3, and waves 1 and 3. The *n* varies depending on whether respondents participated in both of the included waves on all variables. The *n* for wave 1 and 2 comparisons is `r nrow(waves12.wide.complete)`, for wave 2 and 3 comparisons is `r nrow(waves23.wide.complete)`, and for wave 1 and 3 comparisons is `r nrow(waves13.wide.complete)`. 

CAM variables include total CAMs, mind-body medicine, alternative medicine, physical and nutritional approaches, and manipulative treatments. Total CAMs was calculated by summing the number of CAMs used at each wave. Mind-body medicine,alternative medicine, physical and nutritional approaches, and manipulative treatments are dummy variables indicating whether the respondent used any of the associated CAMs. In accordance with the factor analysis from the previous chapter, mind-body medicines include prayer or spiritual healing, energy healing, imagery techniques, relaxtion and meditation techniques, and hypnosis. Alternative medicines or medical systems include homeopathy, herbal therapy, and acupuncture. Physical and nutritional approaches include vitamins, exercise and movement, and special diets. Manipulative treatments include massage and chiropractic care. 

Health is measured by two variables, sum of chronic conditions and self-reported health. Sum of chronic conditions is simply the total chronic conditions reported. Chronic conditions included in the MIDUS survey include: asthma, bronchitis, or emphysema; tuberculosis; other lung problems; bone or joint diseases; sciatica, lumbago, recurring backache; persistent skin trouble; thyroid disease; hay fever; recurring stomach trouble; urinary and bladder problems; being constipated; gall bladder trouble; persistent foot trouble; varicose veins requiring treatment; AIDs or HIV infection; autoimmune disorders; trouble with gums or mouth; persistent trouble with teeth; high blood pressure; emotional disorder; alcohol or drug problems; migraine headaches; chronic sleeping problems; diabetes or high blood sugar; neurological disorders; stroke; ulcer; hernia or rupture; and piles or hemorrhoids. Self-reported health is measured as the respondent’s response to the question “In general, would you say your physical health is excellent, very good, good, fair, or poor?” 

Socioeconomic status is measured with income and education. Income represents household income. The original variable is coded in US dollars and top coded at \$300,000. Income is logged in analyses to address skewness. The variable education is an ordinal variable consisting of the following categories: less than high school, high school diploma or GED, some college or an associate's, college graduate, and graduate or professional degree. Less than high school is the reference category in analyses. 

Race, sex, marital status, health insurance, age, spirituality and religiosity are included as controls. Race at wave 1 includes categories for non-Hispanic White, non-Hispanic Black, and other race. Race additionally includes a category for Mexican American and other Hispanic at waves 2 and 3. White is the reference category in analyses. Sex is a dummy variable coded as 1 = female, 0 = male. Health insurance is a dummy variable coded as 1 = insured, 0 = uninsured. Age is measured as age in years. Spirituality is an summed index ranging from 0 to 8. Respondents were asked to indicate on a scale of 1 to 4 (1 = Very, 2 = Somewhat, 3 = Not very, and 4 = Not at all) their response to the following questions: “How spiritual are you?”; “How important is spirituality in your life?”. Religiosity is an summed index ranging from 0 to 24. Responses on a scale of 1 to 4 (1 = Very, 2 = Somewhat, 3 = Not very, and 4 = Not at all) were recorded for the following questions: “How religious are you?”; “How important is religion in your life?”; “How important is it for you -- or would it be if you had children now -- to send your children for religious or spiritual services or instruction?”; “How closely do you identify with being a member of your religious group?”; “How much do you prefer to be with other people who are the same religion as you?”; “How important do you think it is for people of your religion to marry other people who are the same religion?”; “How important is it for you to celebrate or practice on religious holidays with your family, friends, or members of your religious community?” and summed. 

# Methods

To address the question of whether CAM use is related to SES, I used generalized linear mixed models (GLMMs). I used logistic GLMMs to model the effect of SES on each of the CAM factor indices and a Poisson GLMM to model the effect of SES on total CAM use. For each CAM variable I run four models with the following predictors: (1) income, (2) education, (3) income and education, and (4) income, education, and controls. 

GLMMs are an extension of generalized linear models that account for the nested nature of data. In the MIDUS data, each respondent participated in the survey at one to three time points. Therefore measures at different time points are nested within the individual. GLMMs include fixed effects for level 1 predictors and random effects for level 2. The fixed effects in the models below include all predictors and covariates. Individual id numbers were used to obtain the random effects. The intercept for each individual can vary randomly. Logistic GLMMs were utilized to predict the binary factor indices. Given that the total CAMs variable is a count variable and no over dispersion was detected in the distribution a Poisson GLMM was used to predict the total CAMs variable. 

Path analysis, a type of structural equation modeling (SEM) was used to address the question of whether CAM use mediates the relationship between SES and health. Path analysis is a form of multiple regression used to assess causal relationships between variables. Unlike SEM, only one indicator is used to measure each latent variable. Path analysis allows for the inclusion of multiple dependent, or endogenous, variables. In the models below, total CAMs and health measures are included as dependent variables. SES at time 1 is the main predictor, wave 2 variables are used as mediators, and wave 3 variables are included as outcomes. In constructing the path model I utilize a cross-lagged panel design. Cross-lagged panel designs are useful when examining the relationship between two variables over time. In this case, one of my concerns is the direction of the relationship between total CAMs used and health. Do people utilize CAMs to address poor health? In this case health would predict CAM use. Or do people utilize CAMs as a preventative measure against poor health? In this case CAMs would predict health. A cross-lagged panel design allows me to test each of these relationships simultaneously. 

Model identification... Fit indices... unstandardized and standardized coefficients. Cross lagged... Indirect effects... total effects... 
(SEM description)  

(SEM process)

(Moderation description)

(Sequence of models for moderation)

All models were fit using R software. 


```{r educ-reorder-recodes, echo=FALSE}

#  Education.2 so that college graduate is the reference category. 
waves123.long.complete$Education.2 <- factor(waves123.long.complete$Education, 
                                              levels = c("College Grad", 
                                                         "Less than High School", 
                                                         "HS Diploma/GED", 
                                                         "Some College/AA Degree", 
                                                         "Graduate or Professional Degree"))

waves12.wide.complete$Education_W1.2 <- factor(waves12.wide.complete$Education_W1, 
                                              levels = c("College Grad", 
                                                         "Less than High School", 
                                                         "HS Diploma/GED", 
                                                         "Some College/AA Degree", 
                                                         "Graduate or Professional Degree"))


waves23.wide.complete$Education_W2.2 <- factor(waves23.wide.complete$Education_W2, 
                                              levels = c("College Grad", 
                                                         "Less than High School", 
                                                         "HS Diploma/GED", 
                                                         "Some College/AA Degree", 
                                                         "Graduate or Professional Degree"))

waves13.wide.complete$Education_W1.2 <- factor(waves13.wide.complete$Education_W1, 
                                              levels = c("College Grad", 
                                                         "Less than High School", 
                                                         "HS Diploma/GED", 
                                                         "Some College/AA Degree", 
                                                         "Graduate or Professional Degree"))

```

```{r models-waves12-chron-mod-income, echo = FALSE, results='hide'}

# Center diff chron 
waves12.wide.complete$DiffChronCenter <- scale(waves12.wide.complete$DiffChron, scale = FALSE)
waves12.wide.complete$DiffChronCenter <- as.numeric(waves12.wide.complete$DiffChronCenter)
# Center log income 
waves12.wide.complete$LogIncomeCenter <- scale(waves12.wide.complete$LogIncome_W1, scale = FALSE)
waves12.wide.complete$LogIncomeCenter <- as.numeric(waves12.wide.complete$LogIncomeCenter)
# Create interaction term 
waves12.wide.complete$DiffChronxLogIncome <- waves12.wide.complete$DiffChronCenter*waves12.wide.complete$LogIncomeCenter

# Run income model 
waves12.chron.income.1 <- lm(formula = DiffCams ~ DiffChronCenter + LogIncomeCenter, data = waves12.wide.complete)

# Run income model 
waves12.chron.income.2 <- lm(formula = DiffCams ~ DiffChronCenter + LogIncomeCenter + DiffChronCenter*LogIncomeCenter, data = waves12.wide.complete)

# Add Controls 
waves12.chron.income.3 <- lm(formula = DiffCams ~ DiffChronCenter + LogIncomeCenter + DiffChronCenter*LogIncomeCenter + Education_W1.2 + Age_W2 + Sex_W1 + Race_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + Spiritual_W2 + Religion_W2, data = waves12.wide.complete)

# Extract standard errors
waves12.chron.income.1.se <- summary(waves12.chron.income.1)$coef[,"Std. Error"]
waves12.chron.income.2.se <- summary(waves12.chron.income.2)$coef[,"Std. Error"]
waves12.chron.income.3.se <- summary(waves12.chron.income.3)$coef[,"Std. Error"]
```

```{r models-waves23-chron-mod-income, echo = FALSE, results='hide'}

# Center diff chron 
waves23.wide.complete$DiffChronCenter <- scale(waves23.wide.complete$DiffChron, scale = FALSE)
waves23.wide.complete$DiffChronCenter <- as.numeric(waves23.wide.complete$DiffChronCenter)
# Center log income 
waves23.wide.complete$LogIncomeCenter <- scale(waves23.wide.complete$LogIncome_W2, scale = FALSE)
# Create interaction term 
waves23.wide.complete$DiffChronxLogIncome <- waves23.wide.complete$DiffChronCenter*waves23.wide.complete$LogIncomeCenter

# Run income model 
waves23.chron.income.1 <- lm(formula = DiffCams ~ DiffChronCenter + LogIncomeCenter, data = waves23.wide.complete)

# Run income model 
waves23.chron.income.2 <- lm(formula = DiffCams ~ DiffChronCenter + LogIncomeCenter + DiffChronCenter*LogIncomeCenter, data = waves23.wide.complete)

# Add Controls 
waves23.chron.income.3 <- lm(formula = DiffCams ~ DiffChronCenter + LogIncomeCenter + DiffChronCenter*LogIncomeCenter + Education_W2.2 + Age_W3 + Sex_W2 + Race_W2 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3, data = waves23.wide.complete)

# Extract standard errors
waves23.chron.income.1.se <- summary(waves23.chron.income.1)$coef[,"Std. Error"]
waves23.chron.income.2.se <- summary(waves23.chron.income.2)$coef[,"Std. Error"]
waves23.chron.income.3.se <- summary(waves23.chron.income.3)$coef[,"Std. Error"]
```

```{r models-waves13-chron-mod-income, echo = FALSE, results='hide'}

# Center diff chron 
waves13.wide.complete$DiffChronCenter <- scale(waves13.wide.complete$DiffChron, scale = FALSE)
waves13.wide.complete$DiffChronCenter <- as.numeric(waves13.wide.complete$DiffChronCenter)
# Center log income 
waves13.wide.complete$LogIncomeCenter <- scale(waves13.wide.complete$LogIncome_W1, scale = FALSE)
# Create interaction term 
waves13.wide.complete$DiffChronxLogIncome <- waves13.wide.complete$DiffChronCenter*waves13.wide.complete$LogIncomeCenter

# Run income model 
waves13.chron.income.1 <- lm(formula = DiffCams ~ DiffChronCenter + LogIncomeCenter, data = waves13.wide.complete)

# Run income model 
waves13.chron.income.2 <- lm(formula = DiffCams ~ DiffChronCenter + LogIncomeCenter + DiffChronCenter*LogIncomeCenter, data = waves13.wide.complete)

# Add Controls
waves13.chron.income.3 <- lm(formula = DiffCams ~ DiffChronCenter + LogIncomeCenter + DiffChronCenter*LogIncomeCenter + Education_W1.2 + Age_W3 + Sex_W1 + Race_W3 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3, data = waves13.wide.complete)

waves13.chron.income.1.se <- summary(waves13.chron.income.1)$coef[,"Std. Error"]
waves13.chron.income.2.se <- summary(waves13.chron.income.2)$coef[,"Std. Error"]
waves13.chron.income.3.se <- summary(waves13.chron.income.3)$coef[,"Std. Error"]
```

```{r models-waves12-chron-mod-educ, echo = FALSE, results='hide'}

# Run income model 
waves12.chron.educ.1 <- lm(formula = DiffCams ~ DiffChronCenter + Education_W1.2, data = waves12.wide.complete)

# Run income model 
waves12.chron.educ.2 <- lm(formula = DiffCams ~ DiffChronCenter + Education_W1.2 + DiffChronCenter*Education_W1.2, data = waves12.wide.complete)

# Add Controls
waves12.chron.educ.3 <- lm(formula = DiffCams ~ DiffChronCenter + Education_W1.2 + DiffChronCenter*Education_W1.2 + LogIncome_W1 + Age_W2 + Sex_W1 + Race_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + Spiritual_W2 + Religion_W2, data = waves12.wide.complete)

# Extract standard errors
waves12.chron.educ.1.se <- summary(waves12.chron.educ.1)$coef[,"Std. Error"]
waves12.chron.educ.2.se <- summary(waves12.chron.educ.2)$coef[,"Std. Error"]
waves12.chron.educ.3.se <- summary(waves12.chron.educ.3)$coef[,"Std. Error"]
```

```{r models-waves23-chron-mod-educ, echo = FALSE, results='hide'}

# Run income model 
waves23.chron.educ.1 <- lm(formula = DiffCams ~ DiffChronCenter + Education_W2.2, data = waves23.wide.complete)

# Run income model 
waves23.chron.educ.2 <- lm(formula = DiffCams ~ DiffChronCenter + Education_W2.2 + DiffChronCenter*Education_W2.2, data = waves23.wide.complete)

# Add Controls
waves23.chron.educ.3 <- lm(formula = DiffCams ~ DiffChronCenter + Education_W2.2 + DiffChronCenter*Education_W2.2 + LogIncome_W2 + Age_W3 + Sex_W2 + Race_W2 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3, data = waves23.wide.complete)

# Extract standard errors
waves23.chron.educ.1.se <- summary(waves23.chron.educ.1)$coef[,"Std. Error"]
waves23.chron.educ.2.se <- summary(waves23.chron.educ.2)$coef[,"Std. Error"]
waves23.chron.educ.3.se <- summary(waves23.chron.educ.3)$coef[,"Std. Error"]
```

```{r models-waves13-chron-mod-educ, echo = FALSE, results='hide'}


# Run income model 
waves13.chron.educ.1 <- lm(formula = DiffCams ~ DiffChronCenter + Education_W1.2, data = waves13.wide.complete)

# Run income model 
waves13.chron.educ.2 <- lm(formula = DiffCams ~ DiffChronCenter + Education_W1.2 + DiffChronCenter*Education_W1.2, data = waves13.wide.complete)

# Add Controls
waves13.chron.educ.3 <- lm(formula = DiffCams ~ DiffChronCenter + Education_W1.2 + DiffChronCenter*Education_W1.2 + LogIncome_W1 + Age_W3 + Sex_W1 + Race_W3 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3, data = waves13.wide.complete)

# Extract standard errors
waves13.chron.educ.1.se <- summary(waves13.chron.educ.1)$coef[,"Std. Error"]
waves13.chron.educ.2.se <- summary(waves13.chron.educ.2)$coef[,"Std. Error"]
waves13.chron.educ.3.se <- summary(waves13.chron.educ.3)$coef[,"Std. Error"]

```

```{r model-waves12-SRH-mod-income, echo = FALSE, results='hide'}

# Center diff SRH 
waves12.wide.complete$DiffSRHCenter <- scale(waves12.wide.complete$DiffSRH, scale = FALSE)
waves12.wide.complete$DiffSRHCenter <- as.numeric(waves12.wide.complete$DiffSRHCenter)
# Create interaction term 
waves12.wide.complete$DiffSRHxLogIncome <- NA
waves12.wide.complete$DiffSRHxLogIncome <- waves12.wide.complete$DiffSRHCenter*waves12.wide.complete$LogIncomeCenter

# Run income model 
waves12.SRH.income.1 <- lm(formula = DiffCams ~ DiffSRHCenter + LogIncomeCenter, data = waves12.wide.complete)

# Run income model 
waves12.SRH.income.2 <- lm(formula = DiffCams ~ DiffSRHCenter + LogIncomeCenter + DiffSRHCenter*LogIncomeCenter, data = waves12.wide.complete)

# Add controls 
waves12.SRH.income.3 <- lm(formula = DiffCams ~ DiffSRHCenter + LogIncomeCenter + DiffSRHCenter*LogIncomeCenter + Education_W1.2 + Age_W2 + Sex_W1 + Race_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + Spiritual_W2 + Religion_W2, data = waves12.wide.complete)

# Extract standard errors
waves12.SRH.income.1.se <- summary(waves12.SRH.income.1)$coef[,"Std. Error"]
waves12.SRH.income.2.se <- summary(waves12.SRH.income.2)$coef[,"Std. Error"]
waves12.SRH.income.3.se <- summary(waves12.SRH.income.3)$coef[,"Std. Error"]

```

```{r models-waves23-SRH-mod-income, echo = FALSE, results='hide'}

# Center diff SRH 
waves23.wide.complete$DiffSRHCenter <- scale(waves23.wide.complete$DiffSRH, scale = FALSE)
waves23.wide.complete$DiffSRHCenter <- as.numeric(waves23.wide.complete$DiffSRHCenter)
# Create interaction term 
# waves23.wide.complete$DiffSRHxLogIncome <- NA
waves23.wide.complete$DiffSRHxLogIncome <- waves23.wide.complete$DiffSRHCenter*waves23.wide.complete$LogIncomeCenter


# Run income model 
waves23.SRH.income.1 <- lm(formula = DiffCams ~ DiffSRHCenter + LogIncomeCenter, data = waves23.wide.complete)

# Run income model 
waves23.SRH.income.2 <- lm(formula = DiffCams ~ DiffSRHCenter + LogIncomeCenter + DiffSRHCenter*LogIncomeCenter, data = waves23.wide.complete)

# Add Controls 
waves23.SRH.income.3 <- lm(formula = DiffCams ~ DiffSRHCenter + LogIncomeCenter + DiffSRHCenter*LogIncomeCenter + Education_W2.2 + Age_W3 + Sex_W2 + Race_W2 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3, data = waves23.wide.complete)

# Extract standard errors
waves23.SRH.income.1.se <- summary(waves23.SRH.income.1)$coef[,"Std. Error"]
waves23.SRH.income.2.se <- summary(waves23.SRH.income.2)$coef[,"Std. Error"]
waves23.SRH.income.3.se <- summary(waves23.SRH.income.3)$coef[,"Std. Error"]
```

```{r models-waves13-SRH-mod-income, echo = FALSE, results='hide'}

# Center diff chron 
waves13.wide.complete$DiffSRHCenter <- scale(waves13.wide.complete$DiffSRH, scale = FALSE)
waves13.wide.complete$DiffSRHCenter <- as.numeric(waves13.wide.complete$DiffSRHCenter)
# Center log income 
waves13.wide.complete$LogIncomeCenter <- scale(waves13.wide.complete$LogIncome_W1, scale = FALSE)
# Create interaction term 
waves13.wide.complete$DiffSRHxLogIncome <- waves13.wide.complete$DiffSRHCenter*waves13.wide.complete$LogIncomeCenter

# Run income model 
waves13.SRH.income.1 <- lm(formula = DiffCams ~ DiffSRHCenter + LogIncomeCenter, data = waves13.wide.complete)

# Run income model 
waves13.SRH.income.2 <- lm(formula = DiffCams ~ DiffSRHCenter + LogIncomeCenter + DiffSRHCenter*LogIncomeCenter, data = waves13.wide.complete)


# Add Controls
waves13.SRH.income.3 <- lm(formula = DiffCams ~ DiffSRHCenter + LogIncomeCenter + DiffSRHCenter*LogIncomeCenter + Education_W1.2 + Age_W3 + Sex_W1 + Race_W3 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3, data = waves13.wide.complete)

# Extract standard errors
waves13.SRH.income.1.se <- summary(waves13.SRH.income.1)$coef[,"Std. Error"]
waves13.SRH.income.2.se <- summary(waves13.SRH.income.2)$coef[,"Std. Error"]
waves13.SRH.income.3.se <- summary(waves13.SRH.income.3)$coef[,"Std. Error"]
```

```{r models-waves12-SRH-mod-educ, echo = FALSE, results='hide'}

# Run income model 
waves12.SRH.educ.1 <- lm(formula = DiffCams ~ DiffSRHCenter + Education_W1.2, data = waves12.wide.complete)

# Run income model 
waves12.SRH.educ.2 <- lm(formula = DiffCams ~ DiffSRHCenter + Education_W1.2 + DiffSRHCenter*Education_W1.2, data = waves12.wide.complete)

# Add Controls
waves12.SRH.educ.3 <- lm(formula = DiffCams ~ DiffSRHCenter + Education_W1.2 + DiffSRHCenter*Education_W1.2 + LogIncome_W1 + Age_W2 + Sex_W1 + Race_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + Spiritual_W2 + Religion_W2, data = waves12.wide.complete)

# Extract standard errors
waves12.SRH.educ.1.se <- summary(waves12.SRH.educ.1)$coef[,"Std. Error"]
waves12.SRH.educ.2.se <- summary(waves12.SRH.educ.2)$coef[,"Std. Error"]
waves12.SRH.educ.3.se <- summary(waves12.SRH.educ.3)$coef[,"Std. Error"]
```

```{r models-waves23-SRH-mod-educ, echo = FALSE, results='hide'}

# Run income model 
waves23.SRH.educ.1 <- lm(formula = DiffCams ~ DiffSRHCenter + Education_W2.2, data = waves23.wide.complete)

# Run income model 
waves23.SRH.educ.2 <- lm(formula = DiffCams ~ DiffSRHCenter + Education_W2.2 + DiffSRHCenter*Education_W2.2, data = waves23.wide.complete)

# Add Controls 
waves23.SRH.educ.3 <- lm(formula = DiffCams ~ DiffSRHCenter + Education_W2.2 + DiffSRHCenter*Education_W2.2 + LogIncome_W2 + Age_W3 + Sex_W2 + Race_W2 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3, data = waves23.wide.complete)

# Extract standard errors
waves23.SRH.educ.1.se <- summary(waves23.SRH.educ.1)$coef[,"Std. Error"]
waves23.SRH.educ.2.se <- summary(waves23.SRH.educ.2)$coef[,"Std. Error"]
waves23.SRH.educ.3.se <- summary(waves23.SRH.educ.3)$coef[,"Std. Error"]
```

```{r models-waves13-SRH-mod-educ, echo = FALSE, results='hide'}

# Run income model 
waves13.SRH.educ.1 <- lm(formula = DiffCams ~ DiffSRHCenter + Education_W1.2, data = waves13.wide.complete)

# Run income model 
waves13.SRH.educ.2 <- lm(formula = DiffCams ~ DiffSRHCenter + Education_W1.2 + DiffSRHCenter*Education_W1.2, data = waves13.wide.complete)

# Add Controls 
waves13.SRH.educ.3 <- lm(formula = DiffCams ~ DiffSRHCenter + Education_W1.2 + DiffSRHCenter*Education_W1.2 + LogIncome_W1 + Age_W3 + Sex_W1 + Race_W3 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3, data = waves13.wide.complete)

# Extract standard errors
waves13.SRH.educ.1.se <- summary(waves13.SRH.educ.1)$coef[,"Std. Error"]
waves13.SRH.educ.2.se <- summary(waves13.SRH.educ.2)$coef[,"Std. Error"]
waves13.SRH.educ.3.se <- summary(waves13.SRH.educ.3)$coef[,"Std. Error"]
```

```{r descriptives-table, echo = FALSE}
waves123.long %>% 
  ungroup %>% 
  dplyr::select(wave, totalCams, mindbody, altmed, pna, manipulative, SumChron, SRH, 
         Income, Education, Race, Sex, Marital, HlthInsurance, Age, Spiritual, Religion) %>%
  gtsummary::tbl_summary(
    by = wave,
    type = list(Spiritual ~ "continuous2",
                totalCams ~ "continuous2", 
                SumChron ~ "continuous2", 
                Income ~ "continuous2", 
                Age ~ "continuous2", 
                Religion ~ "continuous2"),
    statistic = list(all_continuous() ~ c("{N_nonmiss}/{N_obs}", 
                                          "{mean} ({sd})",
                                          "{min}, {max}"),
                     all_categorical() ~ "{n}/{N_nonmiss} ({p})%"),
    digits = all_continuous() ~ 2, 
    label = list(totalCams ~ "Total CAMs", 
                 mindbody ~ "Mind-Body Medicine",
                 altmed ~ "Alternative Medicines", 
                 pna ~ "Physical and Nutritional Approaches",
                 manipulative ~ "Manipulative Treatments", 
                 SumChron ~ "Sum of Chronic Conditions", 
                 SRH ~ "Self-Reported Health",
                 Marital ~ "Marital Status",
                 HlthInsurance ~ "Health Insurance",
                 Spiritual ~ "Spirituality",
                 Religion ~ "Religiosity"),
    missing_text = "(Missing)") %>% 
    bold_labels() %>% 
    as_kable_extra(
      longtable = TRUE,
      booktabs=TRUE,
      caption="Descriptive Statistics All Waves",
      escape = F,
      col.names = c("Variable", "Wave 1", "Wave 2", "Wave 3")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped", "repeat_header"),
                font_size = 7) 
```

```{r model-glmm-mb, echo = FALSE}
# baseline model 
baseline <- glmer(mindbody ~ 1 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with income
mb1 <- glmer(mindbody ~ LogIncome + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with education
mb2 <- glmer(mindbody ~ Education.2 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with income and education
mb3 <- glmer(mindbody ~ LogIncome + Education.2 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

#sjPlot::plot_model(mb2, 
#                   show.values=TRUE, show.p=TRUE,
#                   title="Effect of Income and Education on Mind Body Medicine Use")


# Model with all covariates
mb4 <- glmer(mindbody ~ LogIncome + Education.2 + Age + Sex + Race + Marital + HlthInsurance + HLSelf + Spiritual + Religion + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Store results for reporting 
summ.mb1 <- summary(mb1)
summ.mb2 <- summary(mb2)
summ.mb3 <- summary(mb3)
summ.mb4 <- summary(mb4)

# Create table with results
mb.tab.model <- tab_model(mb1, mb2, mb3, mb4,
          show.intercept = FALSE,
          pred.labels = c("Logged Income",  "Less than high school", "High School Diploma/GED",
                          "Some College/AA", "Graduate/Professional Degree", "Age", 
                          "Female", "Non-Hispanic Black", "Other Race", 
                          "Mexican American and Other Hispanic", "Married", "Insured",
                          "Health Locus of Control", "Spirituality", "Religiosity"),
          dv.labels= c("Model 1", "Model 2", "Model 3", "Model 4"),
          title = "Mixed Model: Mind Body Approaches")

 # first you parse the html, then you put it as table, taking the first
df <- data.frame(readHTMLTable(htmlParse(mb.tab.model))[1])
# first row as colnames
colnames(df) <- df[1,]
# remove the fake first row
df <- df[-1,]
```

```{r mindbody-fixed-table, echo=FALSE}
# Fixed effects table
# Drop random effects rows
df.1 <- df[c(1:15),]
# Drop row names
rownames(df.1)<-NULL
kable(df.1,
      booktabs = T,
      caption = "Mind Body Models: Fixed Effects") %>%
  add_header_above(c(" " = 1, "Model 1" = 3, "Model 2" = 3, 
                     "Model 3" = 3, "Model 4" = 3)) %>%
  kable_classic(html_font = "CMU Serif") %>% 
  kableExtra::landscape() %>% 
  kable_styling(latex_options = c("striped", "scale_down"))

# Compare models
# anova(mb1, mb2, mb3, mb4)
```

```{r mindbody-random-table, echo=FALSE}
# Random Effects Table 
# Drop fixed effects rows
df.1 <- df[c(17:22),]
# change column names
colnames(df.1) <- c(" ", "Model 1", "Model 2", "Model 3", "Model 4", "6", "7", "8", "9")
# Drop NA columns 
df.2 <- df.1 %>% 
  dplyr::select(-(6:13)) %>% 
  dplyr::select(-(1))

# Rename rows 
rownames(df.2) <- c("$\\sigma^2$", "$\\tau$00", "ICC", "N", "Observations", "Marginal R$^2$/Conditional R$^2$")

kable(df.2,
      booktabs = T,
      escape = F,
      caption = "Mind Body Models: Random Effects") %>%
   kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("$\\\\sigma^2$ = within subject variance. 
                       $\\\\tau$00 = between subject variance.
                       ICC = intraclass correlation coefficient"), 
           escape = F)

```

```{r model-glmm-altmed, echo = FALSE}
# baseline model 
baseline <- glmer(altmed ~ 1 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with income
am1 <- glmer(altmed ~ LogIncome + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with education
am2 <- glmer(altmed ~ Education.2 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with income and education
am3 <- glmer(altmed ~ LogIncome + Education.2 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

#sjPlot::plot_model(am2, 
#                   show.values=TRUE, show.p=TRUE,
#                   title="Effect of Income and Education on Mind Body Medicine Use")


# Model with all covariates
am4 <- glmer(altmed ~ LogIncome + Education.2 + Age + Sex + Race + Marital + HlthInsurance + HLSelf + Spiritual + Religion + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Store results for reporting 
summ.am1 <- summary(am1)
summ.am2 <- summary(am2)
summ.am3 <- summary(am3)
summ.am4 <- summary(am4)

# Create table with results
altmed.tab.model <- tab_model(am1, am2, am3, am4,
          show.intercept = FALSE,
          pred.labels = c("Logged Income", "Less than high school", "High School Diploma/GED",
                          "Some College/AA", "Graduate/Professional Degree", "Age", 
                          "Female", "Non-Hispanic Black", "Other Race", 
                          "Mexican American and Other Hispanic", "Married", "Insured",
                          "Health Locus of Control", "Spirituality", "Religiosity"),
          dv.labels= c("Model 1", "Model 2", "Model 3", "Model 4"),
          title = "Logistic GLMM: Alternative Medical Systems")

 # first you parse the html, then you put it as table, taking the first
df <- data.frame(readHTMLTable(htmlParse(altmed.tab.model))[1])
# first row as colnames
colnames(df) <- df[1,]
# remove the fake first row
df <- df[-1,]
```

```{r altmed-fixed-table, echo=FALSE}
# Fixed effects table
# Drop random effects rows
df.1 <- df[c(1:15),]
# Drop row names
rownames(df.1)<-NULL
kable(df.1,
      booktabs = T,
      caption = "Alternative Medical Systems: Fixed Effects")  %>%
  add_header_above(c(" " = 1, "Model 1" = 3, "Model 2" = 3, 
                     "Model 3" = 3, "Model 4" = 3)) %>%
  kable_classic(html_font = "CMU Serif") %>% 
  kableExtra::landscape() %>% 
  kable_styling(latex_options = c("striped", "scale_down"))


# Compare models
# anova(am1, am2, am3, am4)
```

```{r altmed-random-table, echo=FALSE}
# Random Effects Table 
# Drop fixed effects rows
df.1 <- df[c(17:22),]
# change column names
colnames(df.1) <- c(" ", "Model 1", "Model 2", "Model 3", "Model 4", "6", "7", "8", "9")
# Drop NA columns 
df.2 <- df.1 %>% 
  dplyr::select(-(6:13)) %>% 
  dplyr::select(-(1))

# Rename rows 
rownames(df.2) <- c("$\\sigma^2$", "$\\tau$00", "ICC", "N", "Observations", "Marginal R$^2$/Conditional R$^2$")

kable(df.2,
      booktabs = T,
      escape = F, 
      caption = "Alternative Medical Systems: Random Effects") %>%
   kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("$\\\\sigma^2$ = within subject variance. 
                       $\\\\tau$00 = between subject variance.
                       ICC = intraclass correlation coefficient"), 
           escape = F) 

```

```{r model-glmm-pna, echo = FALSE}
# baseline model 
baseline <- glmer(pna ~ 1 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with income
pna1 <- glmer(pna ~ LogIncome + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with education
pna2 <- glmer(pna ~ Education.2 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with income and education
pna3 <- glmer(pna ~ LogIncome + Education.2 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

#sjPlot::plot_model(pna2, 
#                   show.values=TRUE, show.p=TRUE,
#                   title="Effect of Income and Education on Mind Body Medicine Use")


# Model with all covariates
pna4 <- glmer(pna ~ LogIncome + Education.2 + Age + Sex + Race + Marital + HlthInsurance + HLSelf + Spiritual + Religion + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Store results for reporting 
summ.pna1 <- summary(pna1)
summ.pna2 <- summary(pna2)
summ.pna3 <- summary(pna3)
summ.pna4 <- summary(pna4)

# Create table with results
pna.tab.model <- tab_model(pna1, pna2, pna3, pna4,
          show.intercept = FALSE,
          pred.labels = c("Logged Income", "Less than high school", "High School Diploma/GED",
                          "Some College/AA", "Graduate/Professional Degree", "Age", 
                          "Female", "Non-Hispanic Black", "Other Race", 
                          "Mexican American and Other Hispanic", "Married", "Insured",
                          "Health Locus of Control", "Spirituality", "Religiosity"),
          dv.labels= c("Model 1", "Model 2", "Model 3", "Model 4"),
          title = "Mixed Model: Physical and Nutritional Approaches")

 # first you parse the html, then you put it as table, taking the first
df <- data.frame(readHTMLTable(htmlParse(pna.tab.model))[1])
# first row as colnames
colnames(df) <- df[1,]
# remove the fake first row
df <- df[-1,]
```

```{r pna-fixed-table, echo=FALSE}
# Fixed effects table
# Drop random effects rows
df.1 <- df[c(1:15),]
# Drop row names
rownames(df.1)<-NULL
kable(df.1,
      booktabs = T,
      caption = "Physical and Nutritional: Fixed Effects") %>%
  add_header_above(c(" " = 1, "Model 1" = 3, "Model 2" = 3, 
                     "Model 3" = 3, "Model 4" = 3)) %>%
  kable_classic(html_font = "CMU Serif") %>% 
  kableExtra::landscape() %>% 
  kable_styling(latex_options = c("striped", "scale_down"))
```

```{r pna-random-table, echo=FALSE}
# Random Effects Table 
# Drop fixed effects rows
df.1 <- df[c(17:22),]
# change column names
colnames(df.1) <- c(" ", "Model 1", "Model 2", "Model 3", "Model 4", "6", "7", "8", "9")
# Drop NA columns 
df.2 <- df.1 %>% 
  dplyr::select(-(6:13)) %>% 
  dplyr::select(-(1))

# Rename rows 
rownames(df.2) <- c("$\\sigma^2$", "$\\tau$00", "ICC", "N", "Observations", "Marginal R$^2$/Conditional R$^2$")

kable(df.2,
      booktabs = T,
      escape = F, 
      caption = "Physical and Nutritional Approaches: Random Effects") %>%
   kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("$\\\\sigma^2$ = within subject variance. 
                       $\\\\tau$00 = between subject variance.
                       ICC = intraclass correlation coefficient"), 
           escape = F) 


# Compare models
# anova(pna1, pna2, pna3, pna4)
```

```{r model-glmm-manipulative, echo = FALSE}
# baseline model 
baseline <- glmer(manipulative ~ 1 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with income
manipulative1 <- glmer(manipulative ~ LogIncome + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with education
manipulative2 <- glmer(manipulative ~ Education.2 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Model with income and education
manipulative3 <- glmer(manipulative ~ LogIncome + Education.2 + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

#sjPlot::plot_model(manipulative2, 
#                   show.values=TRUE, show.p=TRUE,
#                   title="Effect of Income and Education on Mind Body Medicine Use")


# Model with all covariates
manipulative4 <- glmer(manipulative ~ LogIncome + Education.2 + Age + Sex + Race + Marital + HlthInsurance + HLSelf + Spiritual + Religion + (1|M2ID), data = waves123.long.complete, family = binomial, nAGQ = 0)

# Store results for reporting 
summ.manipulative1 <- summary(manipulative1)
summ.manipulative2 <- summary(manipulative2)
summ.manipulative3 <- summary(manipulative3)
summ.manipulative4 <- summary(manipulative4)

# Create table with results
manipulative.tab.model <- tab_model(manipulative1, manipulative2, manipulative3, manipulative4,
          show.intercept = FALSE,
          pred.labels = c("Logged Income", "Less than high school", "High School Diploma/GED",
                          "Some College/AA", "Graduate/Professional Degree", "Age", 
                          "Female", "Non-Hispanic Black", "Other Race", 
                          "Mexican American and Other Hispanic", "Married", "Insured",
                          "Health Locus of Control", "Spirituality", "Religiosity"),
          dv.labels= c("Model 1", "Model 2", "Model 3", "Model 4"),
          title = "Mixed Model: Manipulative Treatments")

 # first you parse the html, then you put it as table, taking the first
df <- data.frame(readHTMLTable(htmlParse(manipulative.tab.model))[1])
# first row as colnames
colnames(df) <- df[1,]
# remove the fake first row
df <- df[-1,]
```

```{r manipulative-fixed-table, echo=FALSE}
# Fixed effects table
# Drop random effects rows
df.1 <- df[c(1:15),]
# Drop row names
rownames(df.1)<-NULL
kable(df.1,
      booktabs = T,
      caption = "Manipulative Treatments: Fixed Effects") %>%
  add_header_above(c(" " = 1, "Model 1" = 3, "Model 2" = 3, 
                     "Model 3" = 3, "Model 4" = 3)) %>%
  kable_classic(html_font = "CMU Serif") %>% 
  kableExtra::landscape() %>% 
  kable_styling(latex_options = c("striped", "scale_down"))
```

```{r manipulative-random-table, echo=FALSE}
# Random Effects Table 
# Drop fixed effects rows
df.1 <- df[c(17:22),]
# change column names
colnames(df.1) <- c(" ", "Model 1", "Model 2", "Model 3", "Model 4", "6", "7", "8", "9")
# Drop NA columns 
df.2 <- df.1 %>% 
  dplyr::select(-(6:13)) %>% 
  dplyr::select(-(1))

# Rename rows 
rownames(df.2) <- c("$\\sigma^2$", "$\\tau$00", "ICC", "N", "Observations", "Marginal R$^2$/Conditional R$^2$")

kable(df.2,
      booktabs = T,
      escape = F, 
      caption = "Manipulative Treatments: Random Effects") %>%
   kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("$\\\\sigma^2$ = within subject variance. 
                       $\\\\tau$00 = between subject variance.
                       ICC = intraclass correlation coefficient"), 
           escape = F) 


# Compare models
# anova(manipulative1, manipulative2, manipulative3, manipulative4)
```

```{r model-glmm-totcams, echo = FALSE}
# Model with income
tot1 <- glmer(totalCams ~ LogIncome + (1|M2ID), data = waves123.long.complete, family = poisson, nAGQ = 0)
# check_overdispersion(tot1)

# Model with education
tot2 <- glmer(totalCams ~ Education.2 + (1|M2ID), data = waves123.long.complete, family = poisson, nAGQ = 0)
# check_overdispersion(tot2)

# Model with income and education
tot3 <- glmer(totalCams ~ LogIncome + Education.2 + (1|M2ID), data = waves123.long.complete, family = poisson, nAGQ = 0)
# check_overdispersion(tot3)

# Model with all covariates
tot4 <- glmer(totalCams ~ LogIncome + Education.2 + Age + Sex + Race + Marital + HlthInsurance + HLSelf + Spiritual + Religion + (1|M2ID), data = waves123.long.complete, family = poisson, nAGQ = 0)

# Store results for reporting 
summ.tot1 <- summary(tot1)
summ.tot2 <- summary(tot2)
summ.tot3 <- summary(tot3)
summ.tot4 <- summary(tot4)

# Check for overdispersion 
# If the dispersion ratio is close to one, a Poisson model fits well to the data. Dispersion ratios larger than one indicate overdispersion, thus a negative binomial model or similar might fit better to the data. A p-value < .05 indicates overdispersion.

# check_overdispersion(tot4)

# Create table with results
tot.tab.model <- tab_model(tot1, tot2, tot3, tot4,
          show.intercept = FALSE,
          pred.labels = c("Logged Income", "Less than high school", "High School Diploma/GED",
                          "Some College/AA", "Graduate/Professional Degree", "Age", 
                          "Female", "Non-Hispanic Black", "Other Race", 
                          "Mexican American and Other Hispanic", "Married", "Insured",
                          "Health Locus of Control", "Spirituality", "Religiosity"),
          dv.labels= c("Model 1", "Model 2", "Model 3", "Model 4"),
          title = "Poisson GLMM: Total CAMs")

 # first you parse the html, then you put it as table, taking the first
df <- data.frame(readHTMLTable(htmlParse(tot.tab.model))[1])
# first row as colnames
colnames(df) <- df[1,]
# remove the fake first row
df <- df[-1,]
```

```{r total-fixed-table, echo = FALSE}
# Fixed effects table
# Drop random effects rows
df.1 <- df[c(1:15),]
# Drop row names
rownames(df.1)<-NULL
kable(df.1,
      booktabs = T,
      caption = "Total CAMs: Fixed Effects") %>%
  add_header_above(c(" " = 1, "Model 1" = 3, "Model 2" = 3, 
                     "Model 3" = 3, "Model 4" = 3)) %>%
  kable_classic(html_font = "CMU Serif") %>% 
  kableExtra::landscape() %>% 
  kable_styling(latex_options = c("striped", "scale_down"))
```

```{r total-random-table, echo=FALSE}
# Random Effects Table 
# Drop fixed effects rows
df.1 <- df[c(17:22),]
# change column names
colnames(df.1) <- c(" ", "Model 1", "Model 2", "Model 3", "Model 4", "6", "7", "8", "9")
# Drop NA columns 
df.2 <- df.1 %>% 
  dplyr::select(-(6:13)) %>% 
  dplyr::select(-(1))

# Rename rows 
rownames(df.2) <- c("$\\sigma^2$", "$\\tau$00", "ICC", "N", "Observations", "Marginal R$^2$/Conditional R$^2$")

kable(df.2,
      booktabs = T,
      escape = F,
      caption = "Total CAMs: Random Effects") %>%
   kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("$\\\\sigma^2$ = within subject variance. 
                       $\\\\tau$00 = between subject variance.
                       ICC = intraclass correlation coefficient"), 
           escape = F) 

#anova(tot1, tot2, tot3,tot4)
```


```{r model-totcams-chron, echo = FALSE, results='hide', fig.show='hide'}
model <- '
# Regressions
# Direct effect - log income 
totalCams_W3 ~ a*LogIncome_W1 
SumChron_W3 ~ b*LogIncome_W1
# Direct Effect - Education
totalCams_W3 ~ c*Education_W1
SumChron_W3 ~ d*Education_W1
# Mediator effects - Income 
SumChron_W2 ~ e*LogIncome_W1 
totalCams_W3 ~ f*SumChron_W2
totalCams_W2 ~ g*LogIncome_W1
SumChron_W3 ~ h*totalCams_W2
# Mediator effects - Education
totalCams_W2 ~ i*Education_W1
SumChron_W2 ~ j*Education_W1 
# Control for previous wave
totalCams_W3 ~ totalCams_W2
SumChron_W3 ~ SumChron_W2
# Indirect effect 
ef := e*f
gh := g*h
jf := j*f
ih := i*h
# total effect
total1 := a + (e*f)
total2 := b + (g*h)
total3 := c + (j*f)
total4 := d + (i*h)
# Controls
totalCams_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + Spiritual_W2 + Religion_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SumChron_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
totalCams_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SumChron_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
# Covariances
totalCams_W2 ~~ SumChron_W2
totalCams_W3 ~~ SumChron_W3
'


# Run model and get summary and fit statistics
set.seed(1234)
model.summ <- sem(model, data = path.complete, ordered = c("Sex_W1", "Marital_W2", "HlthInsurance_W2", "Marital_W3", ) estimator = "DWLS")
summary(model.summ, standardized = TRUE, fit.measures = TRUE)
fitMeasures(model.summ, c("cfi", "rmsea", "srmr"))
#modificationindices(model.summ)

# Create object with model fit measures
fit.totcams.chron <- lavInspect(model.summ, what = "fit")

# Create object with parameter estimates
est.totcams.chron <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized = TRUE)


m <- matrix(NA, 4, 3)
m[1, 1] <- "LogIncome_W1"
m[4, 1] <- "Education_W1"
m[2, 2] <- "totalCams_W2"
m[3, 2] <- "SumChron_W2"
m[1, 3] <- "totalCams_W3"
m[4, 3] <- "SumChron_W3"

# Drop controls from path diagram
path_dia <- semptools::drop_nodes(
                object = semPlotModel(model.summ),
                nodes = c("Age_W3", "Sex_W1", "Marital_W3", "HlthInsurance_W3", "HLSelf_W3", "Spiritual_W3", "Religion_W3", "MexicanHispanic_W2", "Black_W2", "OtherRace_W2", "Age_W2", "Marital_W2", "HlthInsurance_W2", "HLSelf_W2", "Spiritual_W2", "Religion_W2"))

# Create path diagram
path_dia2 <- semPaths(path_dia, whatLabels = "std",
           sizeMan = 8,
           edge.label.cex = .8,
           edge.color = "black",
           style = "ram",
           layout = m, 
           exoCov = FALSE,
           nCharNodes = 0, nCharEdges = 0)

# Create list to rearrange positions of node edges that were blocking each other
my_position_list <- c("totalCams_W3 ~ Education_W1" = .20, 
                      "SumChron_W3 ~ LogIncome_W1" = .75)
# Change label position
path_dia3 <- set_edge_label_position(path_dia2, my_position_list)

path_dia4 <- change_node_label(path_dia3,
                           c(LogIncome_W1 = "Income W1",
                             Education_W1 = "Education W1",
                             totalCams_W2 = "Total CAMs W2",
                             SumChron_W2 = "Sum Chron W2", 
                             totalCams_W3 = "Total CAMs W3",
                             SumChron_W3 = "Sum Chron W3"),
                           label.cex = 1.1)

path_dia5 <- mark_sig(path_dia4, model.summ, alpha = c("(n.s.)" = 1.00, "*" = .05))

```

```{r path-totcams-chron, echo = FALSE, fig.cap="Path Model: SES, Total CAMs, and Chronic Conditions"}
# Create final plot
plot(path_dia5)
```

```{r de-totcams-chron, echo = FALSE}
# Create Direct Effects Table 
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == "~") %>%  
  select(Outcome=lhs, Indicator=rhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper, 'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "pna_W2", "PNA Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Education_W1", "Education Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Sex_W1", "Sex")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W2", "Age Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W3", "Age Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W2", "Married Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W3", "Married Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Black_W2", "Black")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "OtherRace_W2", "Other Race")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "pna_W2", "PNA Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Education_W1", "Education Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Sex_W1", "Sex")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W2", "Age Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W3", "Age Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W2", "Married Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W3", "Married Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Black_W2", "Black")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "OtherRace_W2", "Other Race")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>% 
  knitr::kable(digits = 3,
             booktabs=TRUE,
             caption="Direct Effects: SES, Total CAMs, Chronic Conditions",
             escape = F,
             col.names = c("Outcome", "Indicator", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped"),
                font_size = 7) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape()
```

```{r create-ie-totcams-chron, echo = FALSE, results='hide'}
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=")

# Create Indirect Effects Table 

# Convert output to dataframe with desired rows and columns 
tab.IE.totCams <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=") %>% 
  select('Path'=lhs, "*b*"=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper,'p-value'=pvalue, "$\\beta$"=std.all) %>%
  as.data.frame() 


# create a vector rows in desired order
x <- c("ef", "total1", "gh", "total2", "jf", "total3", "ih", "total4")

# Reorder rows
tab.IE.totCams <- tab.IE.totCams %>%
  slice(match(x, Path))
```

```{r ie-totcams-chron, echo=FALSE}
tab.IE.totCams %>% 
  mutate(Path = replace(Path, Path == "ef", "Indirect Effect: Income \U2192 Chronic Conditions \U2192 Total CAMs")) %>%
  mutate(Path = replace(Path, Path == "total1", "Total Effect: Income \U2192 Chronic Conditions \U2192 Total CAMs")) %>%
  mutate(Path = replace(Path, Path == "gh", "Indirect Effect: Income \U2192 Total CAMs \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "total2", "Total Effect: Income \U2192 Total CAMs \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "jf", "Indirect Effect: Education \U2192 Chronic Conditions \U2192 Total CAMs")) %>%
  mutate(Path = replace(Path, Path == "total3", "Total Effect: Education \U2192 Chronic Conditions \U2192 Total CAMs")) %>%
  mutate(Path = replace(Path, Path == "ih", "Indirect Effect: Education \U2192 Total CAMs \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "total4", "Total Effect: Education \U2192 Total CAMs \U2192 Chronic Conditions")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Indirect and Total Effects: SES, Total CAMs, and Chronic Conditions",
               escape = F, 
               col.names = c("Path", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>%  
  kableExtra::landscape()

```

```{r fit-totcams-chron, echo = FALSE}
# Create fit statistics table 
fitMeasures(model.summ, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea",  "srmr")) %>%
  as.data.frame() %>% 
  t() %>%  
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               escape = F, 
               caption="Fit Statistics: SES, Chronic Conditions, and Total CAMs Path Model",
               col.names=c("$\\chi^2$","df","\\textit{p}-value", "CFI", "TLI", "RMSEA", "SRMR")) %>%  
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  add_footnote(c("CFI = Comparitive Fit Index.", "TLI = Tucker Lewis-Index.", "RMSEA = root mean square error of approximation.", "SRMR = standardized root mean square residual."), notation = "none")
```

```{r model-mb-chron, echo = FALSE, results='hide', fig.show='hide'}
model <- '
# Regressions
# Direct effect - log income 
mindbody_W3 ~ a*LogIncome_W1 
SumChron_W3 ~ b*LogIncome_W1
# Direct Effect - Education
mindbody_W3 ~ c*Education_W1
SumChron_W3 ~ d*Education_W1
# Mediator effects - Income 
SumChron_W2 ~ e*LogIncome_W1 
mindbody_W3 ~ f*SumChron_W2
mindbody_W2 ~ g*LogIncome_W1
SumChron_W3 ~ h*mindbody_W2
# Mediator effects - Education
mindbody_W2 ~ i*Education_W1
SumChron_W2 ~ j*Education_W1 
# Control for previous wave
mindbody_W3 ~ mindbody_W2
SumChron_W3 ~ SumChron_W2
# Indirect effect 
ef := e*f
gh := g*h
jf := j*f
ih := i*h
# total effect
total1 := a + (e*f)
total2 := b + (g*h)
total3 := c + (j*f)
total4 := d + (i*h)
# Controls
mindbody_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + Spiritual_W2 + Religion_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SumChron_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
mindbody_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SumChron_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
# Covariances
mindbody_W2 ~~ SumChron_W2
mindbody_W3 ~~ SumChron_W3
'


# Run model and get summary and fit statistics
set.seed(1234)
model.summ <- sem(model, data = path.complete)
summary(model.summ, standardized = TRUE)
fitMeasures(model.summ, c("cfi", "rmsea", "srmr"))
#modificationindices(model.summ)

# Create object with model fit measures
fit.mb.chron <- lavInspect(model.summ, what = "fit")

# Create object with parameter estimates
est.mb.chron <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized = TRUE)


m <- matrix(NA, 4, 3)
m[1, 1] <- "LogIncome_W1"
m[4, 1] <- "Education_W1"
m[2, 2] <- "mindbody_W2"
m[3, 2] <- "SumChron_W2"
m[1, 3] <- "mindbody_W3"
m[4, 3] <- "SumChron_W3"

# Drop controls from path diagram
path_dia <- semptools::drop_nodes(
                object = semPlotModel(model.summ),
                nodes = c("Age_W3", "Sex_W1", "Marital_W3", "HlthInsurance_W3", "HLSelf_W3", "Spiritual_W3", "Religion_W3", "MexicanHispanic_W2", "Black_W2", "OtherRace_W2", "Age_W2", "Marital_W2", "HlthInsurance_W2", "HLSelf_W2", "Spiritual_W2", "Religion_W2"))

# Create path diagram
path_dia2 <- semPaths(path_dia, whatLabels = "std",
           sizeMan = 8,
           edge.label.cex = .8,
           edge.color = "black",
           style = "ram",
           layout = m, 
           exoCov = FALSE,
           nCharNodes = 0, nCharEdges = 0)

# Create list to rearrange positions of node edges that were blocking each other
my_position_list <- c("mindbody_W3 ~ Education_W1" = .20, 
                      "SumChron_W3 ~ LogIncome_W1" = .75)
# Change label position
path_dia3 <- set_edge_label_position(path_dia2, my_position_list)

path_dia4 <- change_node_label(path_dia3,
                           c(LogIncome_W1 = "Income W1",
                             Education_W1 = "Education W1",
                             mindbody_W2 = "Mind Body W2",
                             SumChron_W2 = "Sum Chron W2", 
                             mindbody_W3 = "Mind Body W3",
                             SumChron_W3 = "Sum Chron W3"),
                           label.cex = 1.1)

path_dia5 <- mark_sig(path_dia4, model.summ, alpha = c("(n.s.)" = 1.00, "*" = .05))

```

```{r path-mb-chron, echo = FALSE, fig.cap="Path Model: SES, Mind-Body Medicine, and Chronic Conditions"}
# Create final plot
plot(path_dia5)
```

```{r de-mb-chron, echo = FALSE}
# Create Direct Effects Table 
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == "~") %>%  
  select(Outcome=lhs, Indicator=rhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper, 'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "pna_W2", "PNA Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Education_W1", "Education Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Sex_W1", "Sex")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W2", "Age Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W3", "Age Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W2", "Married Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W3", "Married Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Black_W2", "Black")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "OtherRace_W2", "Other Race")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "pna_W2", "PNA Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Education_W1", "Education Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Sex_W1", "Sex")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W2", "Age Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W3", "Age Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W2", "Married Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W3", "Married Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Black_W2", "Black")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "OtherRace_W2", "Other Race")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%  
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Direct Effects: SES, Mind-Body Medicine, and Chronic Conditions",
               escape = F, 
               col.names = c("Outcome", "Indicator", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped"),
                font_size = 7) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>%  
  kableExtra::landscape() 
```

```{r create-ie-mb, echo = FALSE, results='hide'}
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=")

# Create Indirect Effects Table 

# Convert output to dataframe with desired rows and columns 
tab.IE.mb <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=") %>% 
  select('Path'=lhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper,'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() 


# create a vector rows in desired order
x <- c("ef", "total1", "gh", "total2", "jf", "total3", "ih", "total4")

# Reorder rows
tab.IE.mb <- tab.IE.mb %>%
  slice(match(x, Path))
```

```{r ie-mb-chron, echo=FALSE}
tab.IE.mb %>% 
  mutate(Path = replace(Path, Path == "ef", "Indirect Effect: Income \U2192 Chronic Conditions \U2192 Mind-Body Medicine")) %>%
  mutate(Path = replace(Path, Path == "total1", "Total Effect: Income \U2192 Chronic Conditions \U2192 Mind-Body Medicine")) %>%
  mutate(Path = replace(Path, Path == "gh", "Indirect Effect: Income \U2192 Mind-Body Medicine \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "total2", "Total Effect: Income \U2192 Mind-Body Medicine \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "jf", "Indirect Effect: Education \U2192 Chronic Conditions \U2192 Mind-Body Medicine")) %>%
  mutate(Path = replace(Path, Path == "total3", "Total Effect: Education \U2192 Chronic Conditions \U2192 Mind-Body Medicine")) %>%
  mutate(Path = replace(Path, Path == "ih", "Indirect Effect: Education \U2192 Mind-Body Medicine \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "total4", "Total Effect: Education \U2192 Mind-Body Medicine \U2192 Chronic Conditions")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               escape = F, 
               col.names = c("Path", "\\textit{b}", "Lower CI", "Upper CI", "\\textit{p}-value", " ", "$\\beta$"),
               caption="Indirect and Total Effects: SES, Mind-Body Medicines, and Chronic Conditions") %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape()
```

```{r fit-mb-chron, echo = FALSE}
# Create fit statistics table 
fitMeasures(model.summ, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea",  "srmr")) %>%
  as.data.frame() %>% 
  t() %>%  
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               escape = F, 
               caption="Fit Statistics: SES, Chronic Conditions, and Mind-Body Medicines Path Model",
               col.names=c("$\\chi^2$","df","\\textit{p}-value", "CFI", "TLI", "RMSEA", "SRMR")) %>%  
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  add_footnote(c("CFI = Comparitive Fit Index.", "TLI = Tucker Lewis-Index.", "RMSEA = root mean square error of approximation.", "SRMR = standardized root mean square residual."), notation = "none")
```

```{r model-altmed-chron, echo = FALSE, results='hide', fig.show='hide'}
model <- '
# Regressions
# Direct effect - log income 
altmed_W3 ~ a*LogIncome_W1 
SumChron_W3 ~ b*LogIncome_W1
# Direct Effect - Education
altmed_W3 ~ c*Education_W1
SumChron_W3 ~ d*Education_W1
# Mediator effects - Income 
SumChron_W2 ~ e*LogIncome_W1 
altmed_W3 ~ f*SumChron_W2
altmed_W2 ~ g*LogIncome_W1
SumChron_W3 ~ h*altmed_W2
# Mediator effects - Education
altmed_W2 ~ i*Education_W1
SumChron_W2 ~ j*Education_W1 
# Control for previous wave
altmed_W3 ~ altmed_W2
SumChron_W3 ~ SumChron_W2
# Indirect effect 
ef := e*f
gh := g*h
jf := j*f
ih := i*h
# total effect
total1 := a + (e*f)
total2 := b + (g*h)
total3 := c + (j*f)
total4 := d + (i*h)
# Controls
altmed_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SumChron_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
altmed_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SumChron_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
# Covariances
altmed_W2 ~~ SumChron_W2
altmed_W3 ~~ SumChron_W3
'


# Run model and get summary and fit statistics
set.seed(1234)
model.summ <- sem(model, data = path.complete)
summary(model.summ, standardized = TRUE)
fitMeasures(model.summ, c("cfi", "rmsea", "srmr"))
#modificationindices(model.summ)

# Create object with model fit measures
fit.altmed.chron <- lavInspect(model.summ, what = "fit")

# Create object with parameter estimates
est.altmed.chron <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized = TRUE)


m <- matrix(NA, 4, 3)
m[1, 1] <- "LogIncome_W1"
m[4, 1] <- "Education_W1"
m[2, 2] <- "altmed_W2"
m[3, 2] <- "SumChron_W2"
m[1, 3] <- "altmed_W3"
m[4, 3] <- "SumChron_W3"

# Drop controls from path diagram
path_dia <- semptools::drop_nodes(
                object = semPlotModel(model.summ),
                nodes = c("Age_W3", "Sex_W1", "Marital_W3", "HlthInsurance_W3", "HLSelf_W3", "Spiritual_W3", "Religion_W3", "MexicanHispanic_W2", "Black_W2", "OtherRace_W2", "Age_W2", "Marital_W2", "HlthInsurance_W2", "HLSelf_W2", "Spiritual_W2", "Religion_W2"))

# Create path diagram
path_dia2 <- semPaths(path_dia, whatLabels = "std",
           sizeMan = 8,
           edge.label.cex = .8,
           edge.color = "black",
           style = "ram",
           layout = m, 
           exoCov = FALSE,
           nCharNodes = 0, nCharEdges = 0)

# Create list to rearrange positions of node edges that were blocking each other
my_position_list <- c("altmed_W3 ~ Education_W1" = .20, 
                      "SumChron_W3 ~ LogIncome_W1" = .75)
# Change label position
path_dia3 <- set_edge_label_position(path_dia2, my_position_list)

path_dia4 <- change_node_label(path_dia3,
                           c(LogIncome_W1 = "Income W1",
                             Education_W1 = "Education W1",
                             altmed_W2 = "Alt Med W2",
                             SumChron_W2 = "Sum Chron W2", 
                             altmed_W3 = "Alt Med W3",
                             SumChron_W3 = "Sum Chron W3"),
                           label.cex = 1.1)

path_dia5 <- mark_sig(path_dia4, model.summ, alpha = c("(n.s.)" = 1.00, "*" = .05))





```

```{r path-altmed-chron, echo = FALSE, fig.cap="Path Model: SES, Alternative Medicines, and Chronic Conditions"}
# Create final plot
plot(path_dia5)
```

```{r de-altmed-chron, echo = FALSE}
# Create Direct Effects Table 
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == "~") %>%  
  select(Outcome=lhs, Indicator=rhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper, 'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "pna_W2", "PNA Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Education_W1", "Education Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Sex_W1", "Sex")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W2", "Age Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W3", "Age Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W2", "Married Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W3", "Married Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Black_W2", "Black")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "OtherRace_W2", "Other Race")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "pna_W2", "PNA Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Education_W1", "Education Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Sex_W1", "Sex")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W2", "Age Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W3", "Age Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W2", "Married Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W3", "Married Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Black_W2", "Black")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "OtherRace_W2", "Other Race")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%  
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Direct Effects: SES, Alternative Medicines, Chronic Conditions",
               escape = F, 
               col.names = c("Outcome", "Indicator", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped"),
                font_size = 7) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape()
```

```{r create-ie-altmed-chron, echo = FALSE, results='hide'}
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=")

# Create Indirect Effects Table 

# Convert output to dataframe with desired rows and columns 
tab.IE.altmed <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=") %>% 
  select('Path'=lhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper,'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() 


# create a vector rows in desired order
x <- c("ef", "total1", "gh", "total2", "jf", "total3", "ih", "total4")

# Reorder rows
tab.IE.altmed <- tab.IE.altmed %>%
  slice(match(x, Path))
```

```{r ie-altmed-chron, echo=FALSE}
tab.IE.altmed %>% 
  mutate(Path = replace(Path, Path == "ef", "Indirect Effect: Income \U2192 Chronic Conditions \U2192 Alternative Medicines")) %>%
  mutate(Path = replace(Path, Path == "total1", "Total Effect: Income \U2192 Chronic Conditions \U2192 Alternative Medicines")) %>%
  mutate(Path = replace(Path, Path == "gh", "Indirect Effect: Income \U2192 Alternative Medicines \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "total2", "Total Effect: Income \U2192 Alternative Medicines \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "jf", "Indirect Effect: Education \U2192 Chronic Conditions \U2192 Alternative Medicines")) %>%
  mutate(Path = replace(Path, Path == "total3", "Total Effect: Education \U2192 Chronic Conditions \U2192 Alternative Medicines")) %>%
  mutate(Path = replace(Path, Path == "ih", "Indirect Effect: Education \U2192 Alternative Medicines \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "total4", "Total Effect: Education \U2192 Alternative Medicines \U2192 Chronic Conditions")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Indirect and Total Effects: SES, Alternative Medicines, and Chronic Conditions",
               escape = F, 
               col.names = c("Path", "\\textit{b}", "Lower CI", "Upper CI",
                             "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape()

```

```{r fit-altmed-chron, echo = FALSE}
# Create fit statistics table 
fitMeasures(model.summ, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea",  "srmr")) %>%
  as.data.frame() %>% 
  t() %>%  
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Fit Statistics: SES, Chronic Conditions, and Alternative Medicines Path Model", 
               escape = F,
               col.names=c("$\\chi^2$","df","\\textit{p}-value", "CFI", "TLI", "RMSEA", "SRMR")) %>%  
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  add_footnote(c("CFI = Comparitive Fit Index.", "TLI = Tucker Lewis-Index.", "RMSEA = root mean square error of approximation.", "SRMR = standardized root mean square residual."), notation = "none")
```

```{r model-pna-chron, echo = FALSE, results='hide', fig.show='hide'}
model <- '
# Regressions
# Direct effect - log income 
pna_W3 ~ a*LogIncome_W1 
SumChron_W3 ~ b*LogIncome_W1
# Direct Effect - Education
pna_W3 ~ c*Education_W1
SumChron_W3 ~ d*Education_W1
# Mediator effects - Income 
SumChron_W2 ~ e*LogIncome_W1 
pna_W3 ~ f*SumChron_W2
pna_W2 ~ g*LogIncome_W1
SumChron_W3 ~ h*pna_W2
# Mediator effects - Education
pna_W2 ~ i*Education_W1
SumChron_W2 ~ j*Education_W1 
# Control for previous wave
pna_W3 ~ pna_W2
SumChron_W3 ~ SumChron_W2
# Indirect effect 
ef := e*f
gh := g*h
jf := j*f
ih := i*h
# total effect
total1 := a + (e*f)
total2 := b + (g*h)
total3 := c + (j*f)
total4 := d + (i*h)
# Controls
pna_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SumChron_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
pna_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SumChron_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
# Covariances
pna_W2 ~~ SumChron_W2
pna_W3 ~~ SumChron_W3
'


# Run model and get summary and fit statistics
set.seed(1234)
model.summ <- sem(model, data = path.complete)
summary(model.summ, standardized = TRUE)
fitMeasures(model.summ, c("cfi", "rmsea", "srmr"))
#modificationindices(model.summ)

# Create object with model fit measures
fit.pna.chron <- lavInspect(model.summ, what = "fit")

# Create object with parameter estimates
est.pna.chron <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized = TRUE)


m <- matrix(NA, 4, 3)
m[1, 1] <- "LogIncome_W1"
m[4, 1] <- "Education_W1"
m[2, 2] <- "pna_W2"
m[3, 2] <- "SumChron_W2"
m[1, 3] <- "pna_W3"
m[4, 3] <- "SumChron_W3"

# Drop controls from path diagram
path_dia <- semptools::drop_nodes(
                object = semPlotModel(model.summ),
                nodes = c("Age_W3", "Sex_W1", "Marital_W3", "HlthInsurance_W3", "HLSelf_W3", "Spiritual_W3", "Religion_W3", "MexicanHispanic_W2", "Black_W2", "OtherRace_W2", "Age_W2", "Marital_W2", "HlthInsurance_W2", "HLSelf_W2", "Spiritual_W2", "Religion_W2"))

# Create path diagram
path_dia2 <- semPaths(path_dia, whatLabels = "std",
           sizeMan = 8,
           edge.label.cex = .8,
           edge.color = "black",
           style = "ram",
           layout = m, 
           exoCov = FALSE,
           nCharNodes = 0, nCharEdges = 0)

# Create list to rearrange positions of node edges that were blocking each other
my_position_list <- c("pna_W3 ~ Education_W1" = .20, 
                      "SumChron_W3 ~ LogIncome_W1" = .75)
# Change label position
path_dia3 <- set_edge_label_position(path_dia2, my_position_list)

path_dia4 <- change_node_label(path_dia3,
                           c(LogIncome_W1 = "Income W1",
                             Education_W1 = "Education W1",
                             pna_W2 = "PNA W2",
                             SumChron_W2 = "Sum Chron W2", 
                             pna_W3 = "PNA W3",
                             SumChron_W3 = "Sum Chron W3"),
                           label.cex = 1.1)

path_dia5 <- mark_sig(path_dia4, model.summ, alpha = c("(n.s.)" = 1.00, "*" = .05))





```

```{r path-pna-chron, echo = FALSE, fig.cap="Path Model: SES, Alternative Medicines, and Chronic Conditions"}
# Create final plot
plot(path_dia5)
```

```{r de-pna-chron, echo = FALSE}
# Create Direct Effects Table 
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == "~") %>%  
  select(Outcome=lhs, Indicator=rhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper, 'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "pna_W2", "PNA Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Education_W1", "Education Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Sex_W1", "Sex")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W2", "Age Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W3", "Age Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W2", "Married Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W3", "Married Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Black_W2", "Black")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "OtherRace_W2", "Other Race")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "pna_W2", "PNA Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Education_W1", "Education Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Sex_W1", "Sex")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W2", "Age Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W3", "Age Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W2", "Married Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W3", "Married Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Black_W2", "Black")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "OtherRace_W2", "Other Race")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>% 
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Direct Effects: SES, Physical and Nutritional Approaches, Chronic Conditions",
               escape = F, 
               col.names = c("Outcome", "Indicator", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped"),
                font_size = 7) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>%  
  kableExtra::landscape()
```

```{r create-ie-pna-chron, echo = FALSE, results='hide'}
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=")

# Create Indirect Effects Table 

# Convert output to dataframe with desired rows and columns 
tab.IE.pna <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=") %>% 
  select('Path'=lhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper,'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() 


# create a vector rows in desired order
x <- c("ef", "total1", "gh", "total2", "jf", "total3", "ih", "total4")

# Reorder rows
tab.IE.pna <- tab.IE.pna %>%
  slice(match(x, Path))
```

```{r ie-pna-chron, echo=FALSE}
tab.IE.pna %>% 
  mutate(Path = replace(Path, Path == "ef", "Indirect Effect: Income \U2192 Chronic Conditions \U2192 Physical and Nutritional Approaches")) %>%
  mutate(Path = replace(Path, Path == "total1", "Total Effect: Income \U2192 Chronic Conditions \U2192 Physical and Nutritional Approaches")) %>%
  mutate(Path = replace(Path, Path == "gh", "Indirect Effect: Income \U2192 Physical and Nutritional Approaches \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "total2", "Total Effect: Income \U2192 Physical and Nutritional Approaches \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "jf", "Indirect Effect: Education \U2192 Chronic Conditions \U2192 Physical and Nutritional Approaches")) %>%
  mutate(Path = replace(Path, Path == "total3", "Total Effect: Education \U2192 Chronic Conditions \U2192 Physical and Nutritional Approaches")) %>%
  mutate(Path = replace(Path, Path == "ih", "Indirect Effect: Education \U2192 Physical and Nutritional Approaches \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "total4", "Total Effect: Education \U2192 Physical and Nutritional Approaches \U2192 Chronic Conditions")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Indirect and Total Effects: SES, Physical and Nutritional Approaches, and Chronic Conditions",
               escape = F, 
               col.names = c("Path", "\\textit{b}", "Lower CI", "Upper CI",
                             "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape()
```

```{r fit-pna-chron, echo = FALSE}
# Create fit statistics table 
fitMeasures(model.summ, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea",  "srmr")) %>%
  as.data.frame() %>% 
  t() %>%  
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Fit Statistics: SES, Chronic Conditions, and Physical and Nutritional Approaches Path Model",                
               escape = F,
               col.names=c("$\\chi^2$","df","\\textit{p}-value", 
                           "CFI", "TLI", "RMSEA", "SRMR")) %>%  
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  add_footnote(c("CFI = Comparitive Fit Index.", "TLI = Tucker Lewis-Index.", "RMSEA = root mean square error of approximation.", "SRMR = standardized root mean square residual."), notation = "none")
```

```{r model-manipulative-chron, echo = FALSE, results='hide', fig.show='hide'}
model <- '
# Regressions
# Direct effect - log income 
manipulative_W3 ~ a*LogIncome_W1 
SumChron_W3 ~ b*LogIncome_W1
# Direct Effect - Education
manipulative_W3 ~ c*Education_W1
SumChron_W3 ~ d*Education_W1
# Mediator effects - Income 
SumChron_W2 ~ e*LogIncome_W1 
manipulative_W3 ~ f*SumChron_W2
manipulative_W2 ~ g*LogIncome_W1
SumChron_W3 ~ h*manipulative_W2
# Mediator effects - Education
manipulative_W2 ~ i*Education_W1
SumChron_W2 ~ j*Education_W1 
# Control for previous wave
manipulative_W3 ~ manipulative_W2
SumChron_W3 ~ SumChron_W2
# Indirect effect 
ef := e*f
gh := g*h
jf := j*f
ih := i*h
# total effect
total1 := a + (e*f)
total2 := b + (g*h)
total3 := c + (j*f)
total4 := d + (i*h)
# Controls
manipulative_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SumChron_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
manipulative_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SumChron_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
# Covariances
manipulative_W2 ~~ SumChron_W2
manipulative_W3 ~~ SumChron_W3
'


# Run model and get summary and fit statistics
set.seed(1234)
model.summ <- sem(model, data = path.complete)
summary(model.summ, standardized = TRUE)
fitMeasures(model.summ, c("cfi", "rmsea", "srmr"))
#modificationindices(model.summ)

# Create object with model fit measures
fit.manipulative.chron <- lavInspect(model.summ, what = "fit")

# Create object with parameter estimates
est.manipulative.chron <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized = TRUE)


m <- matrix(NA, 4, 3)
m[1, 1] <- "LogIncome_W1"
m[4, 1] <- "Education_W1"
m[2, 2] <- "manipulative_W2"
m[3, 2] <- "SumChron_W2"
m[1, 3] <- "manipulative_W3"
m[4, 3] <- "SumChron_W3"

# Drop controls from path diagram
path_dia <- semptools::drop_nodes(
                object = semPlotModel(model.summ),
                nodes = c("Age_W3", "Sex_W1", "Marital_W3", "HlthInsurance_W3", "HLSelf_W3", "Spiritual_W3", "Religion_W3", "MexicanHispanic_W2", "Black_W2", "OtherRace_W2", "Age_W2", "Marital_W2", "HlthInsurance_W2", "HLSelf_W2", "Spiritual_W2", "Religion_W2"))

# Create path diagram
path_dia2 <- semPaths(path_dia, whatLabels = "std",
           sizeMan = 8,
           edge.label.cex = .8,
           edge.color = "black",
           style = "ram",
           layout = m, 
           exoCov = FALSE,
           nCharNodes = 0, nCharEdges = 0)

# Create list to rearrange positions of node edges that were blocking each other
my_position_list <- c("manipulative_W3 ~ Education_W1" = .20, 
                      "SumChron_W3 ~ LogIncome_W1" = .75)
# Change label position
path_dia3 <- set_edge_label_position(path_dia2, my_position_list)

path_dia4 <- change_node_label(path_dia3,
                           c(LogIncome_W1 = "Income W1",
                             Education_W1 = "Education W1",
                             manipulative_W2 = "Manipulative W2",
                             SumChron_W2 = "Sum Chron W2", 
                             manipulative_W3 = "Manipulative W3",
                             SumChron_W3 = "Sum Chron W3"),
                           label.cex = 1.1)

path_dia5 <- mark_sig(path_dia4, model.summ, alpha = c("(n.s.)" = 1.00, "*" = .05))





```

```{r path-manipulative-chron, echo = FALSE, fig.cap="Path Model: SES,Manipulative Treatments, and Chronic Conditions"}
# Create final plot
plot(path_dia5)
```

```{r de-manipulative-chron, echo = FALSE}
# Create Direct Effects Table 
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == "~") %>%  
  select(Outcome=lhs, Indicator=rhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper, 'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "pna_W2", "PNA Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Education_W1", "Education Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Sex_W1", "Sex")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W2", "Age Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W3", "Age Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W2", "Married Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W3", "Married Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Black_W2", "Black")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "OtherRace_W2", "Other Race")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "pna_W2", "PNA Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Education_W1", "Education Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Sex_W1", "Sex")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W2", "Age Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W3", "Age Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W2", "Married Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W3", "Married Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Black_W2", "Black")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "OtherRace_W2", "Other Race")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>% 
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Direct Effects: SES, Manipulative Treatments, Chronic Conditions",
               escape = F, 
               col.names = c("Outcome", "Indicator", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped"),
                font_size = 7) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>%  
  kableExtra::landscape() 
```

```{r create-ie-manipulative-chron, echo = FALSE, results='hide'}
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=")

# Create Indirect Effects Table 

# Convert output to dataframe with desired rows and columns 
tab.IE.manipulative <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=") %>% 
  select('Path'=lhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper,'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() 


# create a vector rows in desired order
x <- c("ef", "total1", "gh", "total2", "jf", "total3", "ih", "total4")

# Reorder rows
tab.IE.manipulative <- tab.IE.manipulative %>%
  slice(match(x, Path))
```

```{r ie-manipulative-chron, echo=FALSE}
tab.IE.manipulative %>% 
  mutate(Path = replace(Path, Path == "ef", "Indirect Effect: Income \U2192 Chronic Conditions \U2192 Manipulative Treatments")) %>%
  mutate(Path = replace(Path, Path == "total1", "Total Effect: Income \U2192 Chronic Conditions \U2192 Manipulative Treatments")) %>%
  mutate(Path = replace(Path, Path == "gh", "Indirect Effect: Income \U2192 Manipulative Treatments \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "total2", "Total Effect: Income \U2192 Manipulative Treatments \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "jf", "Indirect Effect: Education \U2192 Chronic Conditions \U2192 Manipulative Treatments")) %>%
  mutate(Path = replace(Path, Path == "total3", "Total Effect: Education \U2192 Chronic Conditions \U2192 Manipulative Treatments")) %>%
  mutate(Path = replace(Path, Path == "ih", "Indirect Effect: Education \U2192 Manipulative Treatments \U2192 Chronic Conditions")) %>%
  mutate(Path = replace(Path, Path == "total4", "Total Effect: Education \U2192 Manipulative Treatments \U2192 Chronic Conditions")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Indirect and Total Effects: SES, Manipulative Treatments, and Chronic Conditions",              
               escape = F, 
               col.names = c("Path", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>%  
  kableExtra::landscape()

```

```{r fit-manipulative-chron, echo = FALSE}
# Create fit statistics table 
fitMeasures(model.summ, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea",  "srmr")) %>%
  as.data.frame() %>% 
  t() %>%  
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Fit Statistics: SES, Chronic Conditions, and Manipulative Treatments Path Model", 
               escape = F,
               col.names=c("$\\chi^2$","df","\\textit{p}-value", "CFI", 
                           "TLI", "RMSEA", "SRMR")) %>%  
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  add_footnote(c("CFI = Comparitive Fit Index.", "TLI = Tucker Lewis-Index.", "RMSEA = root mean square error of approximation.", "SRMR = standardized root mean square residual."), notation = "none")
```

```{r model-totcams-srh, echo = FALSE, results='hide', fig.show='hide'}
model <- '
# Regressions
# Direct effect - log income 
totalCams_W3 ~ a*LogIncome_W1 
SRH_W3 ~ b*LogIncome_W1
# Direct Effect - Education
totalCams_W3 ~ c*Education_W1
SRH_W3 ~ d*Education_W1
# Mediator effects - Income 
SRH_W2 ~ e*LogIncome_W1 
totalCams_W3 ~ f*SRH_W2
totalCams_W2 ~ g*LogIncome_W1
SRH_W3 ~ h*totalCams_W2
# Mediator effects - Education
totalCams_W2 ~ i*Education_W1
SRH_W2 ~ j*Education_W1 
# Control for previous wave
totalCams_W3 ~ totalCams_W2
SRH_W3 ~ SRH_W2
# Indirect effect 
ef := e*f
gh := g*h
jf := j*f
ih := i*h
# total effect
total1 := a + (e*f)
total2 := b + (g*h)
total3 := c + (j*f)
total4 := d + (i*h)
# Controls
totalCams_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + Spiritual_W2 + Religion_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SRH_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
totalCams_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SRH_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
# Covariances
totalCams_W2 ~~ SRH_W2
totalCams_W3 ~~ SRH_W3
'

# Run model and get summary and fit statistics
set.seed(1234)
model.summ <- sem(model, data = path.complete)
summary(model.summ, standardized = TRUE, fit.measures = TRUE)
fitMeasures(model.summ, c("cfi", "rmsea", "srmr"))
#modificationindices(model.summ)

# Create object with model fit measures
fit.totcams.SRH <- lavInspect(model.summ, what = "fit")

# Create object with parameter estimates
est.totcams.SRH <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized = TRUE)


m <- matrix(NA, 4, 3)
m[1, 1] <- "LogIncome_W1"
m[4, 1] <- "Education_W1"
m[2, 2] <- "totalCams_W2"
m[3, 2] <- "SRH_W2"
m[1, 3] <- "totalCams_W3"
m[4, 3] <- "SRH_W3"

# Drop controls from path diagram
path_dia <- semptools::drop_nodes(
                object = semPlotModel(model.summ),
                nodes = c("Age_W3", "Sex_W1", "Marital_W3", "HlthInsurance_W3", "HLSelf_W3", "Spiritual_W3", "Religion_W3", "MexicanHispanic_W2", "Black_W2", "OtherRace_W2", "Age_W2", "Marital_W2", "HlthInsurance_W2", "HLSelf_W2", "Spiritual_W2", "Religion_W2"))

# Create path diagram
path_dia2 <- semPaths(path_dia, whatLabels = "std",
           sizeMan = 8,
           edge.label.cex = .8,
           edge.color = "black",
           style = "ram",
           layout = m, 
           exoCov = FALSE,
           nCharNodes = 0, nCharEdges = 0)

# Create list to rearrange positions of node edges that were blocking each other
my_position_list <- c("totalCams_W3 ~ Education_W1" = .20, 
                      "SRH_W3 ~ LogIncome_W1" = .75)
# Change label position
path_dia3 <- set_edge_label_position(path_dia2, my_position_list)

path_dia4 <- change_node_label(path_dia3,
                           c(LogIncome_W1 = "Income W1",
                             Education_W1 = "Education W1",
                             totalCams_W2 = "Total CAMs W2",
                             SRH_W2 = "SRH W2", 
                             totalCams_W3 = "Total CAMs W3",
                             SRH_W3 = "SRH W3"),
                           label.cex = 1.1)

path_dia5 <- mark_sig(path_dia4, model.summ, alpha = c("(n.s.)" = 1.00, "*" = .05))

```

```{r path-totcams-srh, echo = FALSE, fig.cap="Path Model: SES, Total CAMs, and Self-Reported Health"}
# Create final plot
plot(path_dia5)
```

```{r de-totcams-srh, echo = FALSE}
# Create Direct Effects Table 
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == "~") %>%  
  select(Outcome=lhs, Indicator=rhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper, 'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "pna_W2", "PNA Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Education_W1", "Education Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Sex_W1", "Sex")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W2", "Age Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W3", "Age Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W2", "Married Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W3", "Married Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Black_W2", "Black")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "OtherRace_W2", "Other Race")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "pna_W2", "PNA Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Education_W1", "Education Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Sex_W1", "Sex")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W2", "Age Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W3", "Age Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W2", "Married Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W3", "Married Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Black_W2", "Black")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "OtherRace_W2", "Other Race")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>% 
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Direct Effects: SES, Total CAMs, Self-Reported Health",
               escape = F, 
               col.names = c("Outcome", "Indicator", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped"),
                font_size = 7) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>%  
  kableExtra::landscape()
```

```{r create-ie-totcams-srh, echo = FALSE, results='hide'}
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=")

# Create Indirect Effects Table 

# Convert output to dataframe with desired rows and columns 
tab.IE.totCams.srh <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=") %>% 
  select('Path'=lhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper,'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() 


# create a vector rows in desired order
x <- c("ef", "total1", "gh", "total2", "jf", "total3", "ih", "total4")

# Reorder rows
tab.IE.totCams.srh <- tab.IE.totCams.srh %>%
  slice(match(x, Path))
```

```{r ie-totcams-srh, echo=FALSE}
tab.IE.totCams.srh %>% 
  mutate(Path = replace(Path, Path == "ef", "Indirect Effect: Income \U2192 Self-Reported Health \U2192 Total CAMs")) %>%
  mutate(Path = replace(Path, Path == "total1", "Total Effect: Income \U2192 Self-Reported Health \U2192 Total CAMs")) %>%
  mutate(Path = replace(Path, Path == "gh", "Indirect Effect: Income \U2192 Total CAMs \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "total2", "Total Effect: Income \U2192 Total CAMs \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "jf", "Indirect Effect: Education \U2192 Self-Reported Health \U2192 Total CAMs")) %>%
  mutate(Path = replace(Path, Path == "total3", "Total Effect: Education \U2192 Self-Reported Health \U2192 Total CAMs")) %>%
  mutate(Path = replace(Path, Path == "ih", "Indirect Effect: Education \U2192 Total CAMs \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "total4", "Total Effect: Education \U2192 Total CAMs \U2192 Self-Reported Health")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Indirect and Total Effects: SES, Total CAMs, and Self-Reported Health",                
               escape = F, 
               col.names = c("Path", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>%  
  kableExtra::landscape() 

```

```{r fit-totcams-srh, echo = FALSE}
# Create fit statistics table 
fitMeasures(model.summ, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea",  "srmr")) %>%
  as.data.frame() %>% 
  t() %>%  
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Fit Statistics: SES, Self-Reported Health, and Total CAMs Path Model",                
               escape = F,
               col.names=c("$\\chi^2$","df","\\textit{p}-value", "CFI", 
                           "TLI", "RMSEA", "SRMR")) %>%  
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  add_footnote(c("CFI = Comparitive Fit Index.", "TLI = Tucker Lewis-Index.", "RMSEA = root mean square error of approximation.", "SRMR = standardized root mean square residual."), notation = "none")
```

```{r model-mb-srh, echo = FALSE, results='hide', fig.show='hide'}
model <- '
# Regressions
# Direct effect - log income 
mindbody_W3 ~ a*LogIncome_W1 
SRH_W3 ~ b*LogIncome_W1
# Direct Effect - Education
mindbody_W3 ~ c*Education_W1
SRH_W3 ~ d*Education_W1
# Mediator effects - Income 
SRH_W2 ~ e*LogIncome_W1 
mindbody_W3 ~ f*SRH_W2
mindbody_W2 ~ g*LogIncome_W1
SRH_W3 ~ h*mindbody_W2
# Mediator effects - Education
mindbody_W2 ~ i*Education_W1
SRH_W2 ~ j*Education_W1 
# Control for previous wave
mindbody_W3 ~ mindbody_W2
SRH_W3 ~ SRH_W2
# Indirect effect 
ef := e*f
gh := g*h
jf := j*f
ih := i*h
# total effect
total1 := a + (e*f)
total2 := b + (g*h)
total3 := c + (j*f)
total4 := d + (i*h)
# Controls
mindbody_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + Spiritual_W2 + Religion_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SRH_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
mindbody_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SRH_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
# Covariances
mindbody_W2 ~~ SRH_W2
mindbody_W3 ~~ SRH_W3
'


# Run model and get summary and fit statistics
set.seed(1234)
model.summ <- sem(model, data = path.complete)
summary(model.summ, standardized = TRUE)
fitMeasures(model.summ, c("cfi", "rmsea", "srmr"))
#modificationindices(model.summ)

# Create object with model fit measures
fit.mb.SRH <- lavInspect(model.summ, what = "fit")

# Create object with parameter estimates
est.mb.SRH <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized = TRUE)



m <- matrix(NA, 4, 3)
m[1, 1] <- "LogIncome_W1"
m[4, 1] <- "Education_W1"
m[2, 2] <- "mindbody_W2"
m[3, 2] <- "SRH_W2"
m[1, 3] <- "mindbody_W3"
m[4, 3] <- "SRH_W3"

# Drop controls from path diagram
path_dia <- semptools::drop_nodes(
                object = semPlotModel(model.summ),
                nodes = c("Age_W3", "Sex_W1", "Marital_W3", "HlthInsurance_W3", "HLSelf_W3", "Spiritual_W3", "Religion_W3", "MexicanHispanic_W2", "Black_W2", "OtherRace_W2", "Age_W2", "Marital_W2", "HlthInsurance_W2", "HLSelf_W2", "Spiritual_W2", "Religion_W2"))

# Create path diagram
path_dia2 <- semPaths(path_dia, whatLabels = "std",
           sizeMan = 8,
           edge.label.cex = .8,
           edge.color = "black",
           style = "ram",
           layout = m, 
           exoCov = FALSE,
           nCharNodes = 0, nCharEdges = 0)

# Create list to rearrange positions of node edges that were blocking each other
my_position_list <- c("mindbody_W3 ~ Education_W1" = .20, 
                      "SRH_W3 ~ LogIncome_W1" = .75)
# Change label position
path_dia3 <- set_edge_label_position(path_dia2, my_position_list)

path_dia4 <- change_node_label(path_dia3,
                           c(LogIncome_W1 = "Income W1",
                             Education_W1 = "Education W1",
                             mindbody_W2 = "Mind Body W2",
                             SRH_W2 = "SRH W2", 
                             mindbody_W3 = "Mind Body W3",
                             SRH_W3 = "SRH W3"),
                           label.cex = 1.1)

path_dia5 <- mark_sig(path_dia4, model.summ, alpha = c("(n.s.)" = 1.00, "*" = .05))





```

```{r path-mb-srh, echo = FALSE, fig.cap="Path Model: SES, Mind-Body Medicines, and Self-Reported Health"}
# Create final plot
plot(path_dia5)
```

```{r de-mb-srh, echo = FALSE}
# Create Direct Effects Table 
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == "~") %>%  
  select(Outcome=lhs, Indicator=rhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper, 'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "pna_W2", "PNA Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Education_W1", "Education Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Sex_W1", "Sex")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W2", "Age Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W3", "Age Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W2", "Married Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W3", "Married Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Black_W2", "Black")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "OtherRace_W2", "Other Race")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "pna_W2", "PNA Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Education_W1", "Education Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Sex_W1", "Sex")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W2", "Age Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W3", "Age Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W2", "Married Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W3", "Married Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Black_W2", "Black")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "OtherRace_W2", "Other Race")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%  
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Direct Effects: SES, Mind-Body Medicines, Self-Reported Health",
               escape = F, 
               col.names = c("Outcome", "Indicator", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped"),
                font_size = 7) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>%  
  kableExtra::landscape()
```

```{r create-ie-mb-srh, echo = FALSE, results='hide'}
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=")

# Create Indirect Effects Table 

# Convert output to dataframe with desired rows and columns 
tab.IE.mb.srh <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=") %>% 
  select('Path'=lhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper,'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() 


# create a vector rows in desired order
x <- c("ef", "total1", "gh", "total2", "jf", "total3", "ih", "total4")

# Reorder rows
tab.IE.mb.srh <- tab.IE.mb.srh %>%
  slice(match(x, Path))
```

```{r ie-mb-srh, echo=FALSE}
tab.IE.totCams.srh %>% 
  mutate(Path = replace(Path, Path == "ef", "Indirect Effect: Income \U2192 Self-Reported Health \U2192 Mind-Body Medicines")) %>%
  mutate(Path = replace(Path, Path == "total1", "Total Effect: Income \U2192 Self-Reported Health \U2192 Mind-Body Medicines")) %>%
  mutate(Path = replace(Path, Path == "gh", "Indirect Effect: Income \U2192 Mind-Body Medicines \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "total2", "Total Effect: Income \U2192 Mind-Body Medicines \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "jf", "Indirect Effect: Education \U2192 Self-Reported Health \U2192 Mind-Body Medicines")) %>%
  mutate(Path = replace(Path, Path == "total3", "Total Effect: Education \U2192 Self-Reported Health \U2192 Mind-Body Medicines")) %>%
  mutate(Path = replace(Path, Path == "ih", "Indirect Effect: Education \U2192 Mind-Body Medicines \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "total4", "Total Effect: Education \U2192 Mind-Body Medicines \U2192 Self-Reported Health")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>% 
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Indirect and Total Effects: SES, Mind-Body Medicines, and Self-Reported Health",               
               escape = F, 
               col.names = c("Path", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape()

```

```{r fit-mb-srh, echo = FALSE}
# Create fit statistics table 
fitMeasures(model.summ, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea",  "srmr")) %>%
  as.data.frame() %>% 
  t() %>%  
  knitr::kable(digits = 3, booktabs=TRUE, caption="Fit Statistics: SES, Self-Reported Health, and Mind-Body Medicines Path Model",              
               escape = F,
               col.names=c("$\\chi^2$","df","\\textit{p}-value", "CFI", 
                           "TLI", "RMSEA", "SRMR")) %>%  
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  add_footnote(c("CFI = Comparitive Fit Index.", "TLI = Tucker Lewis-Index.", "RMSEA = root mean square error of approximation.", "SRMR = standardized root mean square residual."), notation = "none")
```

```{r model-altmed-srh, echo = FALSE, results='hide', fig.show='hide'}
model <- '
# Regressions
# Direct effect - log income 
altmed_W3 ~ a*LogIncome_W1 
SRH_W3 ~ b*LogIncome_W1
# Direct Effect - Education
altmed_W3 ~ c*Education_W1
SRH_W3 ~ d*Education_W1
# Mediator effects - Income 
SRH_W2 ~ e*LogIncome_W1 
altmed_W3 ~ f*SRH_W2
altmed_W2 ~ g*LogIncome_W1
SRH_W3 ~ h*altmed_W2
# Mediator effects - Education
altmed_W2 ~ i*Education_W1
SRH_W2 ~ j*Education_W1 
# Control for previous wave
altmed_W3 ~ altmed_W2
SRH_W3 ~ SRH_W2
# Indirect effect 
ef := e*f
gh := g*h
jf := j*f
ih := i*h
# total effect
total1 := a + (e*f)
total2 := b + (g*h)
total3 := c + (j*f)
total4 := d + (i*h)
# Controls
altmed_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + Spiritual_W2 + Religion_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SRH_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
altmed_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SRH_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
# Covariances
altmed_W2 ~~ SRH_W2
altmed_W3 ~~ SRH_W3
'


# Run model and get summary and fit statistics
set.seed(1234)
model.summ <- sem(model, data = path.complete)
summary(model.summ, standardized = TRUE)
fitMeasures(model.summ, c("cfi", "rmsea", "srmr"))
#modificationindices(model.summ)

# Create object with model fit measures
fit.altmed.SRH <- lavInspect(model.summ, what = "fit")

# Create object with parameter estimates
est.altmed.SRH <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized = TRUE)



m <- matrix(NA, 4, 3)
m[1, 1] <- "LogIncome_W1"
m[4, 1] <- "Education_W1"
m[2, 2] <- "altmed_W2"
m[3, 2] <- "SRH_W2"
m[1, 3] <- "altmed_W3"
m[4, 3] <- "SRH_W3"

# Drop controls from path diagram
path_dia <- semptools::drop_nodes(
                object = semPlotModel(model.summ),
                nodes = c("Age_W3", "Sex_W1", "Marital_W3", "HlthInsurance_W3", "HLSelf_W3", "Spiritual_W3", "Religion_W3", "MexicanHispanic_W2", "Black_W2", "OtherRace_W2", "Age_W2", "Marital_W2", "HlthInsurance_W2", "HLSelf_W2", "Spiritual_W2", "Religion_W2"))

# Create path diagram
path_dia2 <- semPaths(path_dia, whatLabels = "std",
           sizeMan = 8,
           edge.label.cex = .8,
           edge.color = "black",
           style = "ram",
           layout = m, 
           exoCov = FALSE,
           nCharNodes = 0, nCharEdges = 0)

# Create list to rearrange positions of node edges that were blocking each other
my_position_list <- c("altmed_W3 ~ Education_W1" = .20, 
                      "SRH_W3 ~ LogIncome_W1" = .75)
# Change label position
path_dia3 <- set_edge_label_position(path_dia2, my_position_list)

path_dia4 <- change_node_label(path_dia3,
                           c(LogIncome_W1 = "Income W1",
                             Education_W1 = "Education W1",
                             altmed_W2 = "Alt Med W2",
                             SRH_W2 = "SRH W2", 
                             altmed_W3 = "Alt Med W3",
                             SRH_W3 = "SRH W3"),
                           label.cex = 1.1)

path_dia5 <- mark_sig(path_dia4, model.summ, alpha = c("(n.s.)" = 1.00, "*" = .05))





```

```{r path-altmed-srh, echo = FALSE, fig.cap="Path Model: SES, Alternative Medicines, and Self-Reported Health"}
# Create final plot
plot(path_dia5)
```

```{r de-altmed-srh, echo = FALSE}
# Create Direct Effects Table 
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == "~") %>%  
  select(Outcome=lhs, Indicator=rhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper, 'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "pna_W2", "PNA Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Education_W1", "Education Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Sex_W1", "Sex")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W2", "Age Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W3", "Age Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W2", "Married Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W3", "Married Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Black_W2", "Black")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "OtherRace_W2", "Other Race")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "pna_W2", "PNA Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Education_W1", "Education Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Sex_W1", "Sex")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W2", "Age Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W3", "Age Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W2", "Married Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W3", "Married Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Black_W2", "Black")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "OtherRace_W2", "Other Race")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>% 
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Direct Effects: SES, Alternative Medicines, Self-Reported Health",
               escape = F, 
               col.names = c("Outcome", "Indicator", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped"),
                font_size = 7) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape()
```

```{r create-ie-altmed-srh, echo = FALSE, results='hide'}
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=")

# Create Indirect Effects Table 

# Convert output to dataframe with desired rows and columns 
tab.IE.altmed.srh <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=") %>% 
  select('Path'=lhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper,'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() 


# create a vector rows in desired order
x <- c("ef", "total1", "gh", "total2", "jf", "total3", "ih", "total4")

# Reorder rows
tab.IE.altmed.srh <- tab.IE.altmed.srh %>%
  slice(match(x, Path))
```

```{r ie-altmed-srh, echo=FALSE}
tab.IE.altmed.srh %>% 
  mutate(Path = replace(Path, Path == "ef", "Indirect Effect: Income \U2192 Self-Reported Health \U2192 Alternative Medicines")) %>%
  mutate(Path = replace(Path, Path == "total1", "Total Effect: Income \U2192 Self-Reported Health \U2192 Alternative Medicines")) %>%
  mutate(Path = replace(Path, Path == "gh", "Indirect Effect: Income \U2192 Alternative Medicines \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "total2", "Total Effect: Income \U2192 Alternative Medicines \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "jf", "Indirect Effect: Education \U2192 Self-Reported Health \U2192 Alternative Medicines")) %>%
  mutate(Path = replace(Path, Path == "total3", "Total Effect: Education \U2192 Self-Reported Health \U2192 Alternative Medicines")) %>%
  mutate(Path = replace(Path, Path == "ih", "Indirect Effect: Education \U2192 Alternative Medicines \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "total4", "Total Effect: Education \U2192 Alternative Medicines \U2192 Self-Reported Health")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Indirect and Total Effects: SES, Alternative Medicines, and Self-Reported Health",
               escape = F, 
               col.names = c("Path", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape()

```

```{r fit-altmed-srh, echo = FALSE}
# Create fit statistics table 
fitMeasures(model.summ, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea",  "srmr")) %>%
  as.data.frame() %>% 
  t() %>%  
  knitr::kable(digits = 3, booktabs=TRUE, caption="Fit Statistics: SES, Self-Reported Health, and Altnerative Medicines Path Model",               
               escape = F,
               col.names=c("$\\chi^2$","df","\\textit{p}-value", "CFI", 
                           "TLI", "RMSEA", "SRMR")) %>%  
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  add_footnote(c("CFI = Comparitive Fit Index.", "TLI = Tucker Lewis-Index.", "RMSEA = root mean square error of approximation.", "SRMR = standardized root mean square residual."), notation = "none")
```

```{r model-pna-srh, echo = FALSE, results='hide', fig.show='hide'}
model <- '
# Regressions
# Direct effect - log income 
pna_W3 ~ a*LogIncome_W1 
SRH_W3 ~ b*LogIncome_W1
# Direct Effect - Education
pna_W3 ~ c*Education_W1
SRH_W3 ~ d*Education_W1
# Mediator effects - Income 
SRH_W2 ~ e*LogIncome_W1 
pna_W3 ~ f*SRH_W2
pna_W2 ~ g*LogIncome_W1
SRH_W3 ~ h*pna_W2
# Mediator effects - Education
pna_W2 ~ i*Education_W1
SRH_W2 ~ j*Education_W1 
# Control for previous wave
pna_W3 ~ pna_W2
SRH_W3 ~ SRH_W2
# Indirect effect 
ef := e*f
gh := g*h
jf := j*f
ih := i*h
# total effect
total1 := a + (e*f)
total2 := b + (g*h)
total3 := c + (j*f)
total4 := d + (i*h)
# Controls
pna_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SRH_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
pna_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SRH_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
# Covariances
pna_W2 ~~ SRH_W2
pna_W3 ~~ SRH_W3
'


# Run model and get summary and fit statistics
set.seed(1234)
model.summ <- sem(model, data = path.complete)
summary(model.summ, standardized = TRUE)
fitMeasures(model.summ, c("cfi", "rmsea", "srmr"))
#modificationindices(model.summ)

# Create object with model fit measures
fit.pna.SRH <- lavInspect(model.summ, what = "fit")

# Create object with parameter estimates
est.pna.SRH <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized = TRUE)



m <- matrix(NA, 4, 3)
m[1, 1] <- "LogIncome_W1"
m[4, 1] <- "Education_W1"
m[2, 2] <- "pna_W2"
m[3, 2] <- "SRH_W2"
m[1, 3] <- "pna_W3"
m[4, 3] <- "SRH_W3"

# Drop controls from path diagram
path_dia <- semptools::drop_nodes(
                object = semPlotModel(model.summ),
                nodes = c("Age_W3", "Sex_W1", "Marital_W3", "HlthInsurance_W3", "HLSelf_W3", "Spiritual_W3", "Religion_W3", "MexicanHispanic_W2", "Black_W2", "OtherRace_W2", "Age_W2", "Marital_W2", "HlthInsurance_W2", "HLSelf_W2", "Spiritual_W2", "Religion_W2"))

# Create path diagram
path_dia2 <- semPaths(path_dia, whatLabels = "std",
           sizeMan = 8,
           edge.label.cex = .8,
           edge.color = "black",
           style = "ram",
           layout = m, 
           exoCov = FALSE,
           nCharNodes = 0, nCharEdges = 0)

# Create list to rearrange positions of node edges that were blocking each other
my_position_list <- c("pna_W3 ~ Education_W1" = .20, 
                      "SRH_W3 ~ LogIncome_W1" = .75)
# Change label position
path_dia3 <- set_edge_label_position(path_dia2, my_position_list)

path_dia4 <- change_node_label(path_dia3,
                           c(LogIncome_W1 = "Income W1",
                             Education_W1 = "Education W1",
                             pna_W2 = "PNA W2",
                             SRH_W2 = "SRH W2", 
                             pna_W3 = "PNA W3",
                             SRH_W3 = "SRH W3"),
                           label.cex = 1.1)

path_dia5 <- mark_sig(path_dia4, model.summ, alpha = c("(n.s.)" = 1.00, "*" = .05))

```

```{r path-pna-srh, echo = FALSE, fig.cap="Path Model: SES, Physical and Nutritional Approaches, and Self-Reported Health"}
# Create final plot
plot(path_dia5)
```

```{r de-pna-srh, echo = FALSE}
# Create Direct Effects Table 
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == "~") %>%  
  select(Outcome=lhs, Indicator=rhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper, 'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "pna_W2", "PNA Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Education_W1", "Education Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Sex_W1", "Sex")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W2", "Age Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W3", "Age Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W2", "Married Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W3", "Married Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Black_W2", "Black")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "OtherRace_W2", "Other Race")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "pna_W2", "PNA Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Education_W1", "Education Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Sex_W1", "Sex")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W2", "Age Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W3", "Age Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W2", "Married Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W3", "Married Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Black_W2", "Black")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "OtherRace_W2", "Other Race")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>% 
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Direct Effects: SES, Physical and Nutritional Approaches, Self-Reported Health",
               escape = F, 
               col.names = c("Outcome", "Indicator", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped"),
                font_size = 7) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape() 
```

```{r create-ie-pna-srh, echo = FALSE, results='hide'}
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=")

# Create Indirect Effects Table 

# Convert output to dataframe with desired rows and columns 
tab.IE.pna.srh <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=") %>% 
  select('Path'=lhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper,'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() 


# create a vector rows in desired order
x <- c("ef", "total1", "gh", "total2", "jf", "total3", "ih", "total4")

# Reorder rows
tab.IE.pna.srh <- tab.IE.pna.srh %>%
  slice(match(x, Path))
```

```{r ie-pna-srh, echo=FALSE}
tab.IE.totCams.srh %>% 
  mutate(Path = replace(Path, Path == "ef", "Indirect Effect: Income \U2192 Self-Reported Health \U2192 Physical and Nutritional Approaches")) %>%
  mutate(Path = replace(Path, Path == "total1", "Total Effect: Income \U2192 Self-Reported Health \U2192 Physical and Nutritional Approaches")) %>%
  mutate(Path = replace(Path, Path == "gh", "Indirect Effect: Income \U2192 Physical and Nutritional Approaches \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "total2", "Total Effect: Income \U2192 Physical and Nutritional Approaches \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "jf", "Indirect Effect: Education \U2192 Self-Reported Health \U2192 Physical and Nutritional Approaches")) %>%
  mutate(Path = replace(Path, Path == "total3", "Total Effect: Education \U2192 Self-Reported Health \U2192 Physical and Nutritional Approaches")) %>%
  mutate(Path = replace(Path, Path == "ih", "Indirect Effect: Education \U2192 Physical and Nutritional Approaches \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "total4", "Total Effect: Education \U2192 Physical and Nutritional Approaches \U2192 Self-Reported Health")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Indirect and Total Effects: SES, Physical and Nutritional Approaches, and Self-Reported Health",               
               escape = F, 
               col.names = c("Path", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape()

```

```{r fit-pna-srh, echo = FALSE}
# Create fit statistics table 
fitMeasures(model.summ, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea",  "srmr")) %>%
  as.data.frame() %>% 
  t() %>%  
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Fit Statistics: SES, Self-Reported Health, and Physical and Nutritional Approaches Path Model",
               escape = F,
               col.names=c("$\\chi^2$","df","\\textit{p}-value", "CFI", 
                           "TLI", "RMSEA", "SRMR")) %>%  
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  add_footnote(c("CFI = Comparitive Fit Index.", "TLI = Tucker Lewis-Index.", "RMSEA = root mean square error of approximation.", "SRMR = standardized root mean square residual."), notation = "none")
```

```{r model-manipulative-srh, echo = FALSE, results='hide', fig.show='hide'}
model <- '
# Regressions
# Direct effect - log income 
manipulative_W3 ~ a*LogIncome_W1 
SRH_W3 ~ b*LogIncome_W1
# Direct Effect - Education
manipulative_W3 ~ c*Education_W1
SRH_W3 ~ d*Education_W1
# Mediator effects - Income 
SRH_W2 ~ e*LogIncome_W1 
manipulative_W3 ~ f*SRH_W2
manipulative_W2 ~ g*LogIncome_W1
SRH_W3 ~ h*manipulative_W2
# Mediator effects - Education
manipulative_W2 ~ i*Education_W1
SRH_W2 ~ j*Education_W1 
# Control for previous wave
manipulative_W3 ~ manipulative_W2
SRH_W3 ~ SRH_W2
# Indirect effect 
ef := e*f
gh := g*h
jf := j*f
ih := i*h
# total effect
total1 := a + (e*f)
total2 := b + (g*h)
total3 := c + (j*f)
total4 := d + (i*h)
# Controls
manipulative_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + HlthInsurance_W2 + HLSelf_W2 + Spiritual_W2 + Religion_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SRH_W2 ~ Sex_W1 + Age_W2 + Marital_W2 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
manipulative_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + HlthInsurance_W3 + HLSelf_W3 + Spiritual_W3 + Religion_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
SRH_W3 ~ Age_W3 + Sex_W1 + Marital_W3 + MexicanHispanic_W2 + Black_W2 + OtherRace_W2
# Covariances
manipulative_W2 ~~ SRH_W2
manipulative_W3 ~~ SRH_W3
'


# Run model and get summary and fit statistics
set.seed(1234)
model.summ <- sem(model, data = path.complete)
summary(model.summ, standardized = TRUE)
fitMeasures(model.summ, c("cfi", "rmsea", "srmr"))
#modificationindices(model.summ)

# Create object with model fit measures
fit.manipulative.SRH <- lavInspect(model.summ, what = "fit")

# Create object with parameter estimates
est.manipulative.SRH <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized = TRUE)

m <- matrix(NA, 4, 3)
m[1, 1] <- "LogIncome_W1"
m[4, 1] <- "Education_W1"
m[2, 2] <- "manipulative_W2"
m[3, 2] <- "SRH_W2"
m[1, 3] <- "manipulative_W3"
m[4, 3] <- "SRH_W3"

# Drop controls from path diagram
path_dia <- semptools::drop_nodes(
                object = semPlotModel(model.summ),
                nodes = c("Age_W3", "Sex_W1", "Marital_W3", "HlthInsurance_W3", "HLSelf_W3", "Spiritual_W3", "Religion_W3", "MexicanHispanic_W2", "Black_W2", "OtherRace_W2", "Age_W2", "Marital_W2", "HlthInsurance_W2", "HLSelf_W2", "Spiritual_W2", "Religion_W2"))

# Create path diagram
path_dia2 <- semPaths(path_dia, whatLabels = "std",
           sizeMan = 8,
           edge.label.cex = .8,
           edge.color = "black",
           style = "ram",
           layout = m, 
           exoCov = FALSE,
           nCharNodes = 0, nCharEdges = 0)

# Create list to rearrange positions of node edges that were blocking each other
my_position_list <- c("manipulative_W3 ~ Education_W1" = .20, 
                      "SRH_W3 ~ LogIncome_W1" = .75)
# Change label position
path_dia3 <- set_edge_label_position(path_dia2, my_position_list)

path_dia4 <- change_node_label(path_dia3,
                           c(LogIncome_W1 = "Income W1",
                             Education_W1 = "Education W1",
                             manipulative_W2 = "Manipulative W2",
                             SRH_W2 = "SRH W2", 
                             manipulative_W3 = "Manipulative W3",
                             SRH_W3 = "SRH W3"),
                           label.cex = 1.1)

path_dia5 <- mark_sig(path_dia4, model.summ, alpha = c("(n.s.)" = 1.00, "*" = .05))
```

```{r path-manipulative-srh, echo = FALSE, fig.cap="Path Model: SES, Manipulative Treatments, and Self-Reported Health"}
# Create final plot
plot(path_dia5)
```

```{r de-manipulative-srh, echo = FALSE}
# Create Direct Effects Table 
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == "~") %>%  
  select(Outcome=lhs, Indicator=rhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper, 'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "pna_W2", "PNA Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Indicator = replace(Indicator, Indicator == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Education_W1", "Education Wave 1")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Sex_W1", "Sex")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W2", "Age Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Age_W3", "Age Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W2", "Married Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Marital_W3", "Married Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "Black_W2", "Black")) %>%
  mutate(Indicator = replace(Indicator, Indicator == "OtherRace_W2", "Other Race")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W2", "Mind Body Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "mindbody_W3", "Mind Body Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W2", "Alt Med Wave 2")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "altmed_W3", "Alt Med Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "pna_W2", "PNA Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "pna_W3", "PNA Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W2", "Manipulative Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "manipulative_W3", "Manipulative Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W2", "Total CAMs Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "totalCams_W3", "Total CAMs Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W2", "Sum Chron Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SumChron_W3", "Sum Chron Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W2", "SRH Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "SRH_W3", "SRH Wave 3")) %>% 
  mutate(Outcome = replace(Outcome, Outcome == "LogIncome_W1", "Logged Income Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Education_W1", "Education Wave 1")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Sex_W1", "Sex")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W2", "Age Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Age_W3", "Age Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W2", "Married Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Marital_W3", "Married Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W2", "Health Insurance Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HlthInsurance_W3", "Health Insurance Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W2", "Health Locus of Control Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "HLSelf_W3", "Health Locus of Control Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W2", "Spirituality Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Spiritual_W3", "Spirituality Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W2", "Religiosity Wave 2")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Religion_W3", "Religiosity Wave 3")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "MexicanHispanic_W2", "Mexican American/Hispanic")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "Black_W2", "Black")) %>%
  mutate(Outcome = replace(Outcome, Outcome == "OtherRace_W2", "Other Race")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>% 
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Direct Effects: SES, Manipulative Treatments, Self-Reported Health",
               escape = F, 
               col.names = c("Outcome", "Indicator", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped"),
                font_size = 7) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape()
```

```{r create-ie-manipulative-srh, echo = FALSE, results='hide'}
parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=")

# Create Indirect Effects Table 

# Convert output to dataframe with desired rows and columns 
tab.IE.manipulative.srh <- parameterEstimates(model.summ, boot.ci.type = "bca.simple", standardized=TRUE) %>% 
  filter(op == ":=") %>% 
  select('Path'=lhs, B=est, 'Lower CI'= ci.lower, 'Upper CI'= ci.upper,'p-value'=pvalue, Beta=std.all) %>%
  as.data.frame() 


# create a vector rows in desired order
x <- c("ef", "total1", "gh", "total2", "jf", "total3", "ih", "total4")

# Reorder rows
tab.IE.manipulative.srh <- tab.IE.manipulative.srh %>%
  slice(match(x, Path))
```

```{r ie-manipulative-srh, echo=FALSE}
tab.IE.manipulative.srh %>% 
  mutate(Path = replace(Path, Path == "ef", "Indirect Effect: Income \U2192 Self-Reported Health \U2192 Manipulative Treatments")) %>%
  mutate(Path = replace(Path, Path == "total1", "Total Effect: Income \U2192 Self-Reported Health \U2192 Manipulative Treatments")) %>%
  mutate(Path = replace(Path, Path == "gh", "Indirect Effect: Income \U2192 Manipulative Treatments \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "total2", "Total Effect: Income \U2192 Manipulative Treatments \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "jf", "Indirect Effect: Education \U2192 Self-Reported Health \U2192 Manipulative Treatments")) %>%
  mutate(Path = replace(Path, Path == "total3", "Total Effect: Education \U2192 Self-Reported Health \U2192 Manipulative Treatments")) %>%
  mutate(Path = replace(Path, Path == "ih", "Indirect Effect: Education \U2192 Manipulative Treatments \U2192 Self-Reported Health")) %>%
  mutate(Path = replace(Path, Path == "total4", "Total Effect: Education \U2192 Manipulative Treatments \U2192 Self-Reported Health")) %>% 
  add_significance(p.col = "p-value",
                   output.col = "Significance Level",
                   cutpoints = c(0, 0.001, 0.01, 0.05, 1),
                   symbols = c("***", "**", "*", " ")) %>% 
  dplyr::relocate("Significance Level", .after = "p-value") %>%
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Indirect and Total Effects: SES, Manipulative Treatments, and Self-Reported Health",
               escape = F, 
               col.names = c("Path", "\\textit{b}", "Lower CI", 
                             "Upper CI", "\\textit{p}-value", " ", "$\\beta$")) %>%
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  footnote(general = c("\\\\textit{b} = unstandardized coefficient. 
                       $\\\\beta$ = standardized coefficient."),
           symbol = c("$p<.05.$", "$p<.01.$", "$p<.001.$"),
           symbol_manual = c("$^{*}$", "$^{**}$", "$^{***}$"),
           threeparttable = TRUE, 
           footnote_as_chunk = TRUE, 
           escape = F) %>% 
  kableExtra::landscape()

```

```{r fit-manipulative-srh, echo = FALSE}
# Create fit statistics table 
fitMeasures(model.summ, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea",  "srmr")) %>%
  as.data.frame() %>% 
  t() %>%  
  knitr::kable(digits = 3, 
               booktabs=TRUE, 
               caption="Fit Statistics: SES, Self-Reported Health, and Manipulative Treatments Path Model",
               escape = F,
               col.names=c("$\\chi^2$","df","\\textit{p}-value", "CFI", 
                           "TLI", "RMSEA", "SRMR")) %>%  
  kable_classic(html_font = "CMU Serif") %>%
  kable_styling(latex_options = c("striped")) %>% 
  add_footnote(c("CFI = Comparitive Fit Index.", "TLI = Tucker Lewis-Index.", "RMSEA = root mean square error of approximation.", "SRMR = standardized root mean square residual."), notation = "none")
```

```{r waves12-chron-mod-income, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves12.chron.income.1, waves12.chron.income.2, waves12.chron.income.3, 
          title = "Waves 1 and 2 Difference in CAMs Regressed on Difference in Chronic Conditions Moderated by Income", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in Chronic Conditions", "Logged Income", 
                               "Less than High School", "HS Diploma/GED", 
                               "Some College/AA Degree", "Graduate/Professional Degree",
                               "Age at Wave 2", "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race",
                               "Married", "Insured", "Health Locus of Control",
                               "Spirituality", "Religiosity",
                               "Difference in Chronic Conditions x Logged Income"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE, 
          notes = c("White is the reference category for race.",
                    "Standard errors shown in parentheses."), 
          notes.align = "r", 
          label = "tab:waves12-chron-mod-income",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001)) 

```

```{r plot-waves12-chron-income-3, echo = FALSE, fig.cap= "Income Moderation Effects on Relationship Between Difference in Chronic Conditions and Difference in Total CAMs Used Between Waves 1 and 2"}
library(interactions)
interact_plot(waves12.chron.income.3, pred = DiffChronCenter, modx = LogIncomeCenter, 
              x.label = "Difference in Chronic Conditions", 
              y.label = "Difference in Total CAMs",
              legend.main = "Logged Income")
```

```{r waves23-chron-mod-income, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves23.chron.income.1, waves23.chron.income.2, waves23.chron.income.3, 
          title = "Waves 2 and 3 Difference in CAMs Regressed on Difference in Chronic Conditions Moderated by Income", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in Chronic Conditions", "Logged Income", 
                               "Less than High School", "HS Diploma/GED", 
                               "Some College/AA Degree", "Graduate/Professional Degree",
                               "Age at Wave 3", "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race",
                               "Married", "Insured", "Health Locus of Control", 
                               "Spirituality", "Religiosity",  
                               "Difference in Chronic Conditions x Logged Income"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE,
          notes = c("White is the reference category for race.", 
                    "Standard errors shown in parentheses."), 
          notes.align = "r", 
          label = "tab:waves23-chron-mod-income",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001)) 

```
```{r plot-waves23-chron-income-3, echo = FALSE, fig.cap= "Income Moderation Effects on Relationship Between Difference in Chronic Conditions and Difference in Total CAMs Used Between Waves 2 and 3"}
library(interactions)
interact_plot(waves23.chron.income.3, pred = DiffChronCenter, modx = LogIncomeCenter, 
              x.label = "Difference in Chronic Conditions", 
              y.label = "Difference in Total CAMs",
              legend.main = "Logged Income")
```

```{r waves13-chron-mod-income, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves13.chron.income.1, waves13.chron.income.2, waves13.chron.income.3,
          title = "Waves 1 and 3 Difference in CAMs Regressed on Difference in Chronic Conditions Moderated by Income", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in Chronic Conditions", "Logged Income", 
                               "Less than High School", "HS Diploma/GED", 
                               "Some College/AA Degree", "Graduate/Professional Degree",
                               "Age at Wave 3", "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race",
                               "Married", "Insured", "Health Locus of Control",
                               "Spirituality", "Religiosity", 
                               "Difference in Chronic Conditions x Logged Income"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE,
          notes = c("White is the reference category for race.",
                    "Standard errors shown in parentheses."),
          notes.align = "r", 
          label = "tab:waves13-chron-mod-income",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001))

```

```{r plot-waves13-chron-income-3, echo = FALSE, fig.cap= "Income Moderation Effects on Relationship Between Difference in Chronic Conditions and Difference in Total CAMs Used Between Waves 1 and 3"}
library(interactions)
interact_plot(waves13.chron.income.3, pred = DiffChronCenter, modx = LogIncomeCenter, 
              x.label = "Difference in Chronic Conditions", 
              y.label = "Difference in Total CAMs",
              legend.main = "Logged Income")
```

```{r waves12-chron-mod-educ, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves12.chron.educ.1, waves12.chron.educ.2, waves12.chron.educ.3, 
          title = "Waves 1 and 2 Difference in CAMs Regressed on Difference in Chronic Conditions Moderated by Education", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in Chronic Conditions", "Less than high school", "HS Diploma/GED", 
                               "Some College/AA Degree","Graduate or Professional Degree", 
                               "Logged Income", "Age at Wave 2",
                               "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race", "Married", 
                               "Insured", "Health Locus of Control", "Spirituality", "Religiosity", 
                               "Difference in Chronic Conditions x Less than HS Diploma", 
                               "Difference in Chronic Conditions x High School Diploma/GED", 
                               "Difference in Chronic Conditions x Some College/AA Degree", 
                               "Difference in Chronic Conditions x Professional or Graduate Degree"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE,
          notes = c("College graduate is the reference category for education.",
                    "White is the reference category for race.",
                    "Standard errors shown in parentheses."), 
          notes.align = "r", 
          float.env = "sidewaystable", 
          label = "tab:waves12-chron-mod-educ",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001))
```

```{r plot-waves12-chron-educ-3, echo=FALSE, fig.cap= "Education Moderation Effects on Relationship Between Difference in Chronic Conditions and Difference in Total CAMs Used Between Waves 1 and 2"}
plot_model(waves12.chron.educ.3, 
           type = "pred", 
           terms = c("DiffChronCenter", "Education_W1.2"), 
           title = "",
           axis.title = c("Difference in CAMs", "Difference in Chronic Conditions"),
           legend.title = "Education")

```

```{r waves23-chron-mod-educ, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves23.chron.educ.1, waves23.chron.educ.2, waves23.chron.educ.3, 
          title = "Waves 2 and 3 Difference in CAMs Regressed on Difference in Chronic Conditions Moderated by Education", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in Chronic Conditions", "Less than high school", "HS Diploma/GED", 
                               "Some College/AA Degree","Graduate or Professional Degree",
                               "Logged Income", "Age at Wave 3",
                               "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race", "Married", 
                               "Insured", "Health Locus of Control", "Spirituality", "Religiosity", 
                               "Difference in Chronic Conditions x Less than HS Diploma", 
                               "Difference in Chronic Conditions x High School Diploma/GED", 
                               "Difference in Chronic Conditions x Some College/AA Degree", 
                               "Difference in Chronic Conditions x Professional or Graduate Degree"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE,
          notes = c("College graduate is the reference category for education.",
                    "White is the reference category for race.", 
                    "Standard errors shown in parentheses."),
          notes.align = "r", 
          float.env = "sidewaystable", 
          label = "tab:waves23-chron-mod-educ",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001))
```

```{r plot-waves23-chron-educ-3, echo=FALSE, fig.cap= "Education Moderation Effects on Relationship Between Difference in Chronic Conditions and Difference in Total CAMs Used Between Waves 2 and 3"}
plot_model(waves23.chron.educ.3, 
           type = "pred", 
           terms = c("DiffChronCenter", "Education_W2.2"), 
           title = "",
           axis.title = c("Difference in CAMs", "Difference in Chronic Conditions"),
           legend.title = "Education")

```

```{r waves13-chron-mod-educ, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves13.chron.educ.1, waves13.chron.educ.2, waves13.chron.educ.3,
          title = "Waves 1 and 3 Difference in CAMs Regressed on Difference in Chronic Conditions Moderated by Education", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in Chronic Conditions", "Less than high school", "HS Diploma/GED", 
                               "Some College/AA Degree","Graduate or Professional Degree", 
                               "Logged Income", "Age at Wave 3",
                               "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race", "Married", 
                               "Insured", "Health Locus of Control", "Spirituality", "Religiosity", 
                               "Difference in Chronic Conditions x Less than HS Diploma", 
                               "Difference in Chronic Conditions x High School Diploma/GED", 
                               "Difference in Chronic Conditions x Some College/AA Degree", 
                               "Difference in Chronic Conditions x Professional or Graduate Degree"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE,
          notes = c("College graduate is the reference category for education.", 
                    "White is the reference category for race.", 
                    "Standard errors shown in parentheses."), 
          notes.align = "r", 
          float.env = "sidewaystable", 
          label = "tab:waves13-chron-mod-educ",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001))
```

```{r plot-waves13-chron-educ-3, echo=FALSE, fig.cap= "Education Moderation Effects on Relationship Between Difference in Chronic Conditions and Difference in Total CAMs Used Between Waves 1 and 3"}
plot_model(waves13.chron.educ.3, 
           type = "pred", 
           terms = c("DiffChronCenter", "Education_W1.2"), 
           title = "",
           axis.title = c("Difference in CAMs", "Difference in Chronic Conditions"),
           legend.title = "Education")

```

```{r waves12-SRH-mod-income, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves12.SRH.income.1, waves12.SRH.income.2, waves12.SRH.income.3,
          title = "Waves 1 and 2 Difference in CAMs Regressed on Difference in SRH Moderated by Income", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in SRH", "Logged Income", 
                               "Less than High School", "HS Diploma/GED", 
                               "Some College/AA Degree", "Graduate/Professional Degree",
                               "Age at Wave 2", "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race",
                               "Married", "Insured", "Health Locus of Control",
                               "Spirituality", "Religiosity", 
                               "Difference in SRH x Logged Income"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE, 
          notes = c("White is the reference category for race.", 
                    "Standard errors shown in parentheses.", 
                    "SRH: Self-Reported Health."), 
          notes.align = "r", 
          label = "tab:waves12-SRH-mod-income",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001)) 

```

```{r plot-waves12-SRH-income-3, echo = FALSE, fig.cap= "Income Moderation Effects on Relationship Between Difference in Self-Reported Health and Difference in Total CAMs Used Between Waves 1 and 2"}
library(interactions)
interact_plot(waves12.SRH.income.3, pred = DiffSRHCenter, modx = LogIncomeCenter, 
              x.label = "Difference in Self-Reported Health", 
              y.label = "Difference in Total CAMs",
              legend.main = "Logged Income")
```

```{r waves23-SRH-mod-income, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves23.SRH.income.1, waves23.SRH.income.2, waves23.SRH.income.3, 
          title = "Waves 2 and 3 Difference in CAMs Regressed on Difference in SRH Moderated by Income", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in SRH", "Logged Income", 
                               "Less than High School", "HS Diploma/GED", 
                               "Some College/AA Degree", "Graduate/Professional Degree",
                               "Age at Wave 3", "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race",
                               "Married", "Insured", "Health Locus of Control",
                               "Spirituality", "Religiosity", 
                               "Difference in SRH x Logged Income"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE, 
          notes = c("White is the reference category for race.", 
                    "Standard errors shown in parentheses.", 
                    "SRH: Self-Reported Health."), 
          notes.align = "r", 
          label = "tab:waves23-SRH-mod-income",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001)) 

```

```{r plot-waves23-SRH-income-3, echo = FALSE, fig.cap= "Income Moderation Effects on Relationship Between Difference in Self-Reported Health and Difference in Total CAMs Used Between Waves 2 and 3"}
library(interactions)
interact_plot(waves23.SRH.income.3, pred = DiffSRHCenter, modx = LogIncomeCenter, 
              x.label = "Difference in Self-Reported Health", 
              y.label = "Difference in Total CAMs",
              legend.main = "Logged Income")
```

```{r waves13-SRH-mod-income, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves13.SRH.income.1, waves13.SRH.income.2, waves13.SRH.income.3,
          title = "Waves 1 and 3 Difference in CAMs Regressed on Difference in SRH Moderated by Income", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in SRH", "Logged Income", 
                               "Less than High School", "HS Diploma/GED", 
                               "Some College/AA Degree", "Graduate/Professional Degree",
                               "Age at Wave 3", "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race",
                               "Married", "Insured", "Health Locus of Control",
                               "Spirituality", "Religiosity", 
                               "Difference in SRH x Logged Income"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE,
          notes = c("White is the reference category for race.", 
                    "Standard errors shown in parentheses.", 
                    "SRH: Self-Reported Health"), 
          notes.align = "r", 
          label = "tab:waves13-SRH-mod-income",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001))

```

```{r plot-waves13-SRH-income-3, echo = FALSE, fig.cap= "Income Moderation Effects on Relationship Between Difference in Self-Reported Health and Difference in Total CAMs Used Between Waves 1 and 3"}
library(interactions)
interact_plot(waves13.SRH.income.3, pred = DiffSRHCenter, modx = LogIncomeCenter, 
              x.label = "Difference in Self-Reported Health", 
              y.label = "Difference in Total CAMs",
              legend.main = "Logged Income")
```

```{r plot-waves12-SRH-educ-3, echo=FALSE, fig.cap= "Education Moderation Effects on Relationship Between Difference in SRH and Difference in Total CAMs Used Between Waves 1 and 2"}
plot_model(waves12.SRH.educ.3, 
           type = "pred", 
           terms = c("DiffSRHCenter", "Education_W1.2"), 
           title = "",
           axis.title = c("Difference in CAMs", "Difference in SRH"),
           legend.title = "Education")

```

```{r waves12-SRH-mod-educ, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves12.SRH.educ.1, waves12.SRH.educ.2, waves12.SRH.educ.3,  
          title = "Waves 1 and 2 Difference in CAMs Regressed on Difference in SRH Moderated by Education", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in SRH", "Less than high school", "HS Diploma/GED", 
                               "Some College/AA Degree","Graduate or Professional Degree",
                               "Logged Income", "Age at Wave 2",
                               "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race", "Married", 
                               "Insured", "Health Locus of Control", "Spirituality", "Religiosity", 
                               "Difference in Chronic Conditions x Less than HS Diploma", 
                               "Difference in Chronic Conditions x High School Diploma/GED", 
                               "Difference in Chronic Conditions x Some College/AA Degree", 
                               "Difference in Chronic Conditions x Professional or Graduate Degree"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE,
          notes = c("College graduate is the reference category for education.", 
                    "White is the reference category for race.", 
                    "Standard errors shown in parentheses.", 
                    "SRH: Self-Reported Health."), 
          notes.align = "r", 
          float.env = "sidewaystable", 
          label = "tab:waves12-SRH-mod-educ",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001))
```

```{r plot-waves23-SRH-educ-3, echo=FALSE, fig.cap= "Education Moderation Effects on Relationship Between Difference in SRH and Difference in Total CAMs Used Between Waves 2 and 3"}
plot_model(waves23.SRH.educ.3, 
           type = "pred", 
           terms = c("DiffSRHCenter", "Education_W2.2"), 
           title = "",
           axis.title = c("Difference in CAMs", "Difference in SRH"),
           legend.title = "Education")

```

```{r waves23-SRH-mod-educ, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves23.SRH.educ.1, waves23.SRH.educ.2, waves23.SRH.educ.3,  
          title = "Waves 2 and 3 Difference in CAMs Regressed on Difference in SRH Moderated by Education", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in SRH", "Less than high school", "HS Diploma/GED", 
                               "Some College/AA Degree", "Graduate or Professional Degree",
                               "Logged Income", "Age at Wave 2",
                               "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race", "Married", 
                               "Insured", "Health Locus of Control", "Spirituality", "Religiosity", 
                               "Difference in Chronic Conditions x Less than HS Diploma", 
                               "Difference in Chronic Conditions x High School Diploma/GED", 
                               "Difference in Chronic Conditions x Some College/AA Degree", 
                               "Difference in Chronic Conditions x Professional or Graduate Degree"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE,
          notes = c("College graduate is the reference category for education.", 
                    "White is the reference category for race.", 
                    "Standard errors shown in parentheses.", 
                    "SRH: Self-Reported Health."), 
          notes.align = "r", 
          float.env = "sidewaystable", 
          label = "tab:waves12-SRH-mod-educ",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001))
```

```{r plot-waves13-SRH-educ-3, echo=FALSE, fig.cap= "Education Moderation Effects on Relationship Between Difference in SRH and Difference in Total CAMs Used Between Waves 1 and 3"}
plot_model(waves12.SRH.educ.3, 
           type = "pred", 
           terms = c("DiffSRHCenter", "Education_W1.2"), 
           title = "",
           axis.title = c("Difference in CAMs", "Difference in SRH"),
           legend.title = "Education")

```

```{r waves13-SRH-mod-educ, echo = FALSE, results='asis'}
# Create regression results table
stargazer(waves13.SRH.educ.1, waves13.SRH.educ.2, waves13.SRH.educ.3, 
          title = "Waves 1 and 3 Difference in CAMs Regressed on Difference in SRH Moderated by Education", 
          column.labels = c("Model 1", "Model 2", "Model 3"), 
          covariate.labels = c("Difference in SRH", "Less than high school", "HS Diploma/GED", 
                               "Some College/AA Degree","Graduate or Professional Degree",
                               "Logged Income", "Age at Wave 2",
                               "Female", "Non-Hispanic Black", 
                               "Mexican American and Other Hispanic", "Other Race", "Married", 
                               "Insured", "Health Locus of Control", "Spirituality", "Religiosity", 
                               "Difference in Chronic Conditions x Less than HS Diploma", 
                               "Difference in Chronic Conditions x High School Diploma/GED", 
                               "Difference in Chronic Conditions x Some College/AA Degree", 
                               "Difference in Chronic Conditions x Professional or Graduate Degree"),
          dep.var.caption  = "", 
          dep.var.labels.include = FALSE,
          model.numbers          = FALSE, 
          keep.stat = c("n", "rsq", "adj.rsq"), 
          column.sep.width = "3pt", # to reduce column width
          single.row = TRUE, # to put coefficients and standard errors on same line
          font.size = "small",
          header = FALSE,
          notes = c("College graduate is the reference category for education.", 
                    "White is the reference category for race.", 
                    "Standard errors shown in parentheses.", 
                    "SRH: Self-Reported Health."), 
          notes.align = "r", 
          float.env = "sidewaystable", 
          label = "tab:waves12-SRH-mod-educ",
          star.char = c("*", "**", "***"),
          star.cutoffs = c(.05, .01, .001))
```

# Results

Table \ref{tab:descriptives-table} shows summary statistics for variables across all three waves included in the following analyses along with information about missing data.

## Relationship Between SES and CAM Use

### Mind Body

Table \ref{tab:mindbody-fixed-table} shows results for the level 1 predictors and \ref{tab:mindbody-random-table} shows results for the level 2 predictors for all mind body approaches. Model 1 assesses the association between the use of mind body approaches and logged income. The odds of using mind body approaches at different levels of logged income do not differ significantly. The marginal $R^2$ is 0.00 and the conditional $R^2$ is 0.47, indicating that income does not explain any of the variance in the model.

Model 2 assesses the association between the use of mind body approaches and levels of education, using a reference category of less than a high school education. The odds of using mind body approaches increase with each level of education so that the odds of using mind-body approaches are 63% lower for those with less than a high school education (OR = `r round(exp(summ.mb2$coefficients[2]),3)`, 95% CI: `r round(exp(summ.mb2$coefficients[2] - 1.96 * summ.mb2$coefficients[7]),3)`, `r round(exp(summ.mb2$coefficients[2] + 1.96 * summ.mb2$coefficients[7]),3)`, *p* \< 0.001), 50% lower for those with a high school diploma or GED (OR = `r round(exp(summ.mb2$coefficients[3]),3)`, 95% CI: `r round(exp(summ.mb2$coefficients[3] - 1.96 * summ.mb2$coefficients[8]),3)`, `r round(exp(summ.mb2$coefficients[3] + 1.96 * summ.mb2$coefficients[8]),3)`, *p* \< 0.001), and 25% lower for those with some college or an associate's degree (OR = `r round(exp(summ.mb2$coefficients[4]),3)`, 95% CI: `r round(exp(summ.mb2$coefficients[4] - 1.96 * summ.mb2$coefficients[9]),3)`, `r round(exp(summ.mb2$coefficients[4] + 1.96 * summ.mb2$coefficients[9]),3)`, *p* \< 0.01) compared to those with a college degree. There is no significant difference in use of mind-body medicines between those with a college degree and those with a graduate or professional degree. The marginal $R^2$ is 0.018 and the conditional $R^2$ is 0.467, indicating that education explains approximately 1.8% of the variance in the model. Models 1 and 2 suggest that education has a strong, significant, direct relationship with use of mind-body approaches, while income does not.

Model 3 includes both logged income and education as predictors of the use of mind body approaches. when accounting for education, logged income has a significant positive effect. For each one unit increase in logged income the odds of using mind body approaches decreases by 11% (OR = `r round(exp(summ.mb3$coefficients[2]),3)`, 95% CI: `r round(exp(summ.mb3$coefficients[2] - 1.96 * summ.mb3$coefficients[8]),3)`, `r round(exp(summ.mb3$coefficients[2] + 1.96 * summ.mb3$coefficients[8]),3)`, *p* \< 0.001). In this model, the odds of using mind-body approaches are 67% lower for those with less than a high school education (OR = `r round(exp(summ.mb3$coefficients[3]),3)`, 95% CI: `r round(exp(summ.mb3$coefficients[3] - 1.96 * summ.mb3$coefficients[9]),3)`, `r round(exp(summ.mb3$coefficients[3] + 1.96 * summ.mb3$coefficients[9]),3)`, *p* \< 0.001), 53% lower for those with a high school diploma or GED (OR = `r round(exp(summ.mb3$coefficients[4]),3)`, 95% CI: `r round(exp(summ.mb3$coefficients[4] - 1.96 * summ.mb3$coefficients[10]),3)`, `r round(exp(summ.mb3$coefficients[4] + 1.96 * summ.mb3$coefficients[10]),3)`, *p* \< 0.001), and 28% lower for those with some college or an associate's degree (OR = `r round(exp(summ.mb3$coefficients[5]),3)`, 95% CI: `r round(exp(summ.mb3$coefficients[5] - 1.96 * summ.mb3$coefficients[11]),3)`, `r round(exp(summ.mb3$coefficients[5] + 1.96 * summ.mb3$coefficients[11]),3)`, *p* \< 0.001) compared to those with a college degree. There was no significant difference in mind-body medicine use between those with a college degree and those with a graduate or professional degree. The marginal $R^2$ is 0.020 and the conditional $R^2$ is 0.466, indicating that income and education together explain approximately 2% of the variance explained in the model.

Model 4 adds control variables and logged income is no longer a significant predictor of the use of mind body approaches. The effects of education remain significant in this model, and the odds increase with each level of education. The odds of using mind-body approaches are 61% lower for those with less than a high school education (OR = `r round(exp(summ.mb4$coefficients[3]),3)`, 95% CI: `r round(exp(summ.mb4$coefficients[3] - 1.96 * summ.mb4$coefficients[19]),3)`, `r round(exp(summ.mb4$coefficients[3] + 1.96 * summ.mb4$coefficients[19]),3)`, *p* \< 0.001), 54% lower for those with a high school diploma or GED (OR = `r round(exp(summ.mb4$coefficients[4]),3)`, 95% CI: `r round(exp(summ.mb4$coefficients[4] - 1.96 * summ.mb4$coefficients[20]),3)`, `r round(exp(summ.mb4$coefficients[4] + 1.96 * summ.mb4$coefficients[20]),3)`, *p* \< 0.001), and 33% lower for those with some college or an associate's degree (OR = `r round(exp(summ.mb4$coefficients[5]),3)`, 95% CI: `r round(exp(summ.mb4$coefficients[5] - 1.96 * summ.mb4$coefficients[21]),3)`, `r round(exp(summ.mb4$coefficients[5] + 1.96 * summ.mb4$coefficients[21]),3)`, *p* \< 0.001) compared to those with a college degree. There was no significant difference in mind-body medicine use between those with a college degree and those with a graduate or professional degree. The marginal $R^2$ is 0.217 and the conditional $R^2$ is 0.453, indicating that income, education, and the control variables explain 21.7% of the variance in the model. 

As \ref{tab:mindbody-random-table} illustrates, within-subject variance is 3.29 across all 4 models and between-subject variance ranges from 1.42 in Model 4 to 2.91 in Model 1. The Intraclass Correlation Coefficient also ranges from 0.30-0.47, indicating that 30-47% of the variation in use of mind-body approaches occurs between-subjects. Thus while income and education significantly predict the use of mind-body approaches, most of the variation in the use of these CAMs is explained by differences between-subjects that the data do not account for rather than by the predictors in the models. Also, it is notable that income has no significant effect without accounting for education, which suggests that income matters for mind-body CAM use within education groups but only when the larger effects of education are taken into account.

### Alternative medicine

Table \ref{tab:altmed-fixed-table} shows results for level 1 predictors and \ref{tab:altmed-random-table} shows results for the level 2 predictors for all alternative medicine models. Model 1 assesses the relationship between logged income and the use of alternative medical systems. The odds of using alternative medicines at different levels of logged income do not differ significantly. The marginal $R^2$ is 0.00 and the conditional $R^2$ is 0.462, indicating that income explains 0% of the variance in the model.

Model 2 assesses the association between level of education and the use of alternative medical systems and the odds of using alternative medical systems tend to increase with education. The odds of using alternative medical systems are 62% lower for those with less than a high school diploma (OR = `r round(exp(summ.am2$coefficients[2]),3)`, 95% CI: `r round(exp(summ.am2$coefficients[2] - 1.96 * summ.am2$coefficients[7]),3)`, `r round(exp(summ.am2$coefficients[2] + 1.96 * summ.am2$coefficients[7]),3)`, *p* \< 0.001), 47% lower for those with a high school diploma or GED (OR = `r round(exp(summ.am2$coefficients[3]),3)`, 95% CI: `r round(exp(summ.am2$coefficients[3] - 1.96 * summ.am2$coefficients[8]),3)`, `r round(exp(summ.am2$coefficients[3] + 1.96 * summ.am2$coefficients[8]),3)`, *p* \< 0.001), and 28% lower for those with some college or an associate's degree (OR = `r round(exp(summ.am2$coefficients[4]),3)`, 95% CI: `r round(exp(summ.am2$coefficients[4] - 1.96 * summ.am2$coefficients[9]),3)`, `r round(exp(summ.am2$coefficients[4] + 1.96 * summ.am2$coefficients[9]),3)`, *p* \< 0.01) compared to those with a college degree. There is not a significant difference in mind-body medicine use between those with a college degree and those with a graduate or professional degree. The marginal $R^2$ is 0.014 and the conditional $R^2$ is 0.462, indicating that education explains 1.4% of the variance in the model.

Model 3 includes both logged income and education as predictors of the use of alternative medical systems. When accounting for education, logged income does not significantly predict use of alternative medical systems. When accounting for the effect of logged income, the odds of using alternative medical systems are 65% lower for those with less than a high school diploma (OR = `r round(exp(summ.am3$coefficients[3]),3)`, 95% CI: `r round(exp(summ.am3$coefficients[3] - 1.96 * summ.am3$coefficients[9]),3)`, `r round(exp(summ.am3$coefficients[3] + 1.96 * summ.am3$coefficients[9]),3)`, *p* \< 0.001), 49% lower for those wiht a high school diploma or GED (OR = `r round(exp(summ.am3$coefficients[4]),3)`, 95% CI: `r round(exp(summ.am3$coefficients[4] - 1.96 * summ.am3$coefficients[10]),3)`, `r round(exp(summ.am3$coefficients[4] + 1.96 * summ.am3$coefficients[10]),3)`, *p* \< 0.001), and 30% lower for those with some college or an associate's degree (OR = `r round(exp(summ.am3$coefficients[5]),3)`, 95% CI: `r round(exp(summ.am3$coefficients[5] - 1.96 * summ.am3$coefficients[11]),3)`, `r round(exp(summ.am3$coefficients[5] + 1.96 * summ.am3$coefficients[11]),3)`, *p* \< 0.10) compared to those with a college degree. There is no significant difference between those with a college degree and those with a graduate or professional degree. The marginal $R^2$ is 0.015 and the conditional $R^2$ is 0.460, indicating that education and income together explain approximately 1.5% of the variance in the model.

Model 4 adds control variables. Logged income does not significantly predict the use of alternative medical systems. The effects of education compared to having a college degree remain significant for those with some college or less education. When accounting for the effect of logged income, the odds of using alternative medical systems are 60% lower for those with less than a high school diploma (OR = `r round(exp(summ.am4$coefficients[3]),3)`, 95% CI: `r round(exp(summ.am4$coefficients[3] - 1.96 * summ.am4$coefficients[19]),3)`, `r round(exp(summ.am4$coefficients[3] + 1.96 * summ.am4$coefficients[19]),3)`, *p* \< 0.001), 50% lower for those with a high school diploma or GED (OR = `r round(exp(summ.am4$coefficients[4]),3)`, 95% CI: `r round(exp(summ.am4$coefficients[4] - 1.96 * summ.am4$coefficients[20]),3)`, `r round(exp(summ.am4$coefficients[4] + 1.96 * summ.am4$coefficients[20]),3)`, *p* \< 0.001), and 36% lower for those with some college or an associate's degree (OR = `r round(exp(summ.am4$coefficients[5]),3)`, 95% CI: `r round(exp(summ.am4$coefficients[5] - 1.96 * summ.am4$coefficients[21]),3)`, `r round(exp(summ.am4$coefficients[5] + 1.96 * summ.am4$coefficients[21]),3)`, *p* \< 0.10) compared to those with a college degree. There is no significant difference between those with a college degree and those with a graduate or professional degree. The marginal $R^2$ is 0.092 and the conditional $R^2$ is 0.468, indicating that education, income, and the controls explain 9.2% of the variance in the model.

The results of these models indicate that education significantly predicts the use of alternative medical systems, although education and demographic variables explain a much smaller amount of the variation than unmeasured differences between subjects. As shown in \ref{tab: altmed-random-table}, within-subject variance is 3.29 across all 4 models and between-subject variance ranges from 2.33 in Model 4 and 2.83 in Model 1. The ICC also ranges from 0.41-0.46, indicating that 41-46% of the variation in use of alternative medical systems occurs between-subjects. Thus, while education significantly predicts the use of alternative medical systems, most of the variation in the use of these CAMs is explained by differences between subjects that the data do not account for rather the by the predictors in the model.

### Physical and nutritional approaches

Table \ref{tab:pna-fixed-table} shows results for the level 1 predictors and Table \ref{tab:pna-random-table} shows results for the level 2 predictor for all physical and nutritional approaches models. Model 1 assesses the relationship between logged income and the use of physical and nutritional approaches. Results show for each additional unit of logged income the odds of using physical and nutritional approaches increases by 5% (OR = `r round(exp(summ.pna1$coefficients[2]),3)`, 95% CI: `r round(exp(summ.pna1$coefficients[2] - 1.96 * summ.pna1$coefficients[4]),3)`, `r round(exp(summ.pna1$coefficients[2] + 1.96 * summ.pna1$coefficients[4]),3)`, *p* \< 0.05). The marginal $R^2$ is 0.001 and the conditional $R^2$ is 0.201, indicating that the variance explained in the model is due to the level 2 predictor rather than the level 1 predictors.

Model 2 assesses the association between the use of physical and nutritional approaches and levels of education using less than a high school education as a reference category. The odds of using physical and nutritional approaches increase with each level of education so that the odds of using physical and nutritional approaches are 52% lower for those with less than a high school diploma (OR = `r round(exp(summ.pna2$coefficients[2]),3)`, 95% CI: `r round(exp(summ.pna2$coefficients[2] - 1.96 * summ.pna2$coefficients[7]),3)`, `r round(exp(summ.pna2$coefficients[2] + 1.96 * summ.pna2$coefficients[7]),3)`, *p* \< 0.001), 37% lower for those with a high school diploma or GED (OR = `r round(exp(summ.pna2$coefficients[3]),3)`, 95% CI: `r round(exp(summ.pna2$coefficients[3] - 1.96 * summ.pna2$coefficients[8]),3)`, `r round(exp(summ.pna2$coefficients[3] + 1.96 * summ.pna2$coefficients[8]),3)`, *p* \< 0.001), and 17% lower for those with some college or an associate's degree (OR = `r round(exp(summ.pna2$coefficients[4]),3)`, 95% CI: `r round(exp(summ.pna2$coefficients[4] - 1.96 * summ.pna2$coefficients[9]),3)`, `r round(exp(summ.pna2$coefficients[4] + 1.96 * summ.pna2$coefficients[9]),3)`, *p* \< 0.01) compared to those with a college degree. There is not a significant difference in use of physical and nutritional approaches between those with college degree and those with a graduate or professional degree. The marginal $R^2$ is 0.015 and the conditional $R^2$ is 0.205, indicating that education explains 1.5% of the variance in the model.

Model 3 includes both logged income and education as predictors of the use of physical and nutritional approaches. When accounting for education, logged income does not significantly predict the use of physical and nutritional approaches. In this model, the odds of using physical and nutritional approaches are 53% lower for those with less than a high school diploma (OR = `r round(exp(summ.pna3$coefficients[3]),3)`, 95% CI: `r round(exp(summ.pna3$coefficients[3] - 1.96 * summ.pna3$coefficients[9]),3)`, `r round(exp(summ.pna3$coefficients[3] + 1.96 * summ.pna3$coefficients[9]),3)`, *p* \< 0.001), 38% lower for those wiht a high school diploma or GED (OR = `r round(exp(summ.pna3$coefficients[4]),3)`, 95% CI: `r round(exp(summ.pna3$coefficients[4] - 1.96 * summ.pna3$coefficients[10]),3)`, `r round(exp(summ.pna3$coefficients[4] + 1.96 * summ.pna3$coefficients[10]),3)`, *p* \< 0.001), and 17% lower for those with some college or an associate's degree (OR = `r round(exp(summ.pna3$coefficients[5]),3)`, 95% CI: `r round(exp(summ.pna3$coefficients[5] - 1.96 * summ.pna3$coefficients[11]),3)`, `r round(exp(summ.pna3$coefficients[5] + 1.96 * summ.pna3$coefficients[11]),3)`, *p* \< 0.10) compared to those with a college degree. There is no significant difference between those with a college degree and those with a graduate or professional degree. The marginal $R^2$ is 0.015 and the conditional $R^2$ is 0.205, indicating that income and education together explain approximately 1.5% of the variance in the model.

Model 4 adds control variables and logged income does not significantly predict the use of physical and nutritional approaches. The effects of education remain significant in this model. The odds of using physical and nutritional approaches are 52% lower for those with less than a high school diploma (OR = `r round(exp(summ.pna4$coefficients[3]),3)`, 95% CI: `r round(exp(summ.pna4$coefficients[3] - 1.96 * summ.pna4$coefficients[19]),3)`, `r round(exp(summ.pna4$coefficients[3] + 1.96 * summ.pna4$coefficients[19]),3)`, *p* \< 0.001), 41% lower for those with a high school diploma or GED (OR = `r round(exp(summ.pna4$coefficients[4]),3)`, 95% CI: `r round(exp(summ.pna4$coefficients[4] - 1.96 * summ.pna4$coefficients[20]),3)`, `r round(exp(summ.pna4$coefficients[4] + 1.96 * summ.pna4$coefficients[20]),3)`, *p* \< 0.001), and 22% lower for those with some college or an associate's degree (OR = `r round(exp(summ.pna4$coefficients[5]),3)`, 95% CI: `r round(exp(summ.pna4$coefficients[5] - 1.96 * summ.pna4$coefficients[21]),3)`, `r round(exp(summ.pna4$coefficients[5] + 1.96 * summ.pna4$coefficients[21]),3)`, *p* \< 0.001) compared to those with a college degree. There is no significant difference between those with a college degree and those with a graduate or professional degree. The marginal $R^2$ is 0.065 and the conditional $R^2$ is 0.243, indicating that income, education, and the controls altogether explain 6.5% of the variance explained in the model.

As Table \ref{tab:pna-random-table} demonstrates within-subject variance is 3.29 across all 4 models and between-subject variance ranges from 0.77 in Model 4 to 0.83 in Model 1. The ICC also ranges from 0.19-0.20, indicating that 19-20% of the variation in the use of physical and nutritional approaches occurs between-subjects. While income and education significantly predict the use of physical and nutritional approaches, most of the variation is explained by differences between-subjects that the data do not account for rather than the predictors in the model.

### Manipulative

Table \ref{tab:pna-fixed-table} shows results for level 1 predictors Table \ref{tab:pna-random-table} shows results for all level 2 predictors for all manipulative treatment models. Model 1 assesses the relationship between logged income and the use of manipulative treatments. The odds of using manipulative treatments are 15% higher for each additional unit of logged income (OR = `r round(exp(summ.manipulative1$coefficients[2]),3)`, 95% CI: `r round(exp(summ.manipulative1$coefficients[2] - 1.96 * summ.manipulative1$coefficients[4]),3)`, `r round(exp(summ.manipulative1$coefficients[2] + 1.96 * summ.manipulative1$coefficients[4]),3)`, *p* \< 0.001). The marginal $R^2$ is 0.003 and the conditional $R^2$ is 0.426, indicating that the variance explained in the model is due to the level 2 rather than level 1 effects.

Model 2 assesses the association between the use of manipulative treatments and levels of education using less than a high school education as a reference category. The odds of using manipulative treatments are 50% lower for those with less than a high school diploma (OR = `r round(exp(summ.manipulative2$coefficients[2]),3)`, 95% CI: `r round(exp(summ.manipulative2$coefficients[2] - 1.96 * summ.manipulative2$coefficients[7]),3)`, `r round(exp(summ.manipulative2$coefficients[2] + 1.96 * summ.manipulative2$coefficients[7]),3)`, *p* \< 0.001) and 27% lower for those with a high school diploma or GED (OR = `r round(exp(summ.manipulative2$coefficients[3]),3)`, 95% CI: `r round(exp(summ.manipulative2$coefficients[3] - 1.96 * summ.manipulative2$coefficients[8]),3)`, `r round(exp(summ.manipulative2$coefficients[3] + 1.96 * summ.manipulative2$coefficients[8]),3)`, *p* \< 0.001) compared to those with a college degree. There is not a significant difference in use of physical and nutritional approaches between those with college degree and those with some college or an associate's degree or those with a graduate or professional degree. The marginal $R^2$ is 0.008 and the conditional $R^2$ is 0.429, education does not explain the variance in the model.

Model 3 includes both logged income and education as predictors of the use of manipulative treatments. When accounting for education, logged income significantly predicts the use of manipulative treatments. For each one unit increase in logged income the odds of using manipulative treatments increases by 10% (OR = `r round(exp(summ.manipulative3$coefficients[2]),3)`, 95% CI: `r round(exp(summ.manipulative3$coefficients[2] - 1.96 * summ.manipulative3$coefficients[8]),3)`, `r round(exp(summ.manipulative3$coefficients[2] + 1.96 * summ.manipulative3$coefficients[8]),3)` *p* \<0.010). When accounting for the effect of logged income, the odds of using manipulative treatments are 46% lower for those with less than a high school diploma (OR = `r round(exp(summ.manipulative3$coefficients[3]),3)`, 95% CI: `r round(exp(summ.manipulative3$coefficients[3] - 1.96 * summ.manipulative3$coefficients[9]),3)`, `r round(exp(summ.manipulative3$coefficients[3] + 1.96 * summ.manipulative3$coefficients[9]),3)`, *p* \< 0.001) and 23% lower for those wiht a high school diploma or GED (OR = `r round(exp(summ.manipulative3$coefficients[4]),3)`, 95% CI: `r round(exp(summ.manipulative3$coefficients[4] - 1.96 * summ.manipulative3$coefficients[10]),3)`, `r round(exp(summ.manipulative3$coefficients[4] + 1.96 * summ.manipulative3$coefficients[10]),3)`, *p* \< 0.001) compared to those with a college degree. There is not a significant difference in use of physical and nutritional approaches between those with college degree and those with some college or an associate's degree or those with a graduate or professional degree. The marginal $R^2$ is 0.009 and the conditional $R^2$ is 0.431, indicating that income and education do not explain the variance in the model.

Model 4 adds control variables. Income remains a significant predictors of manipulative treatment use. For each one unit increase in logged income the odds of using manipulative treatments increase by 16% (OR = `r round(exp(summ.manipulative4$coefficients[2]),3)`, 95% CI: `r round(exp(summ.manipulative4$coefficients[2] - 1.96 * summ.manipulative4$coefficients[18]),3)`, `r round(exp(summ.manipulative4$coefficients[2] + 1.96 * summ.manipulative4$coefficients[18]),3)`, *p* \< 0.001). The odds of using manipulative treatments are 40% lower for those with less than a high school diploma (OR = `r round(exp(summ.manipulative4$coefficients[3]),3)`, 95% CI: `r round(exp(summ.manipulative4$coefficients[3] - 1.96 * summ.manipulative4$coefficients[19]),3)`, `r round(exp(summ.manipulative4$coefficients[3] + 1.96 * summ.manipulative4$coefficients[19]),3)`, *p* \< 0.001) and 22% lower for those with a high school diploma or GED (OR = `r round(exp(summ.manipulative4$coefficients[4]),3)`, 95% CI: `r round(exp(summ.manipulative4$coefficients[4] - 1.96 * summ.manipulative4$coefficients[20]),3)`, `r round(exp(summ.manipulative4$coefficients[4] + 1.96 * summ.manipulative4$coefficients[20]),3)`, *p* \< 0.050) compared to those with a college degree. There is no significant difference between those with a college degree and those with some college or an associate's degree or those with a graduate or professional degree. The marginal $R^2$ is 0.034 and the conditional $R^2$ is 0.440, indicating that 3.4% of the variance explained in the model is due to income, education, and the controls.

As Table \ref{tab:pna-random-table} illustrates, within-in subject variance is 3.29 across all 4 models and between-subject variance ranges from 2.39 in Model 4 to 2.44 in Model 3. The ICC also ranges from 0.42-0.43, indicating that 42-43% of the variation in manipulative treatment use occurs between subjects.

Overall, the results in Tables \ref{tab:mindbody-fixed-table} - \ref{tab:pna-random-table} reveal that education has consistent, positive effects on the odds of using each type of CAM. While income has less consistent effects, the effect of education suggests a positive relationship between SES and CAM use. Next, I examine the effects of SES on the total number of CAMs that individuals used.

### Total CAMs

Table \ref{tab:total-fixed-table} shows results for the level 1 predictors for all total CAMs models and Table \ref{tab:total-random-table} shows results for the level 2 predictors. Model 1 assesses the association between CAMs used and income. In Model 1, the relationship between logged income and total CAMs used is statistically significant (OR = `r round(exp(summ.tot1$coefficients[2]),3)`, 95% CI: `r round(exp(summ.tot1$coefficients[2] - 1.96 * summ.tot1$coefficients[4]),3)`, `r round(exp(summ.tot1$coefficients[2] + 1.96 * summ.tot1$coefficients[4]),3)`, *p* \< 0.050). The marginal $R^2$ is 0.000 and the conditional $R^2$ is 0.559, indicating income does not explain the variance in the model.

Model 2 assesses the association between total CAMs used and levels of education. The expected count of total CAMs used increases with each level of education. The expected number of CAMs used decreases by a factor of 0.53 for those with less than a high school education(IRR = `r round(exp(summ.tot2$coefficients[2]),3)`, 95% CI: `r round(exp(summ.tot2$coefficients[2] - 1.96 * summ.tot2$coefficients[7]),3)`, `r round(exp(summ.tot2$coefficients[2] + 1.96 * summ.tot2$coefficients[7]),3)`, *p* \< 0.001), decreases by a factor of 0.69 for those with a high school diploma or GED (OR = `r round(exp(summ.tot2$coefficients[3]),3)`, 95% CI: `r round(exp(summ.tot2$coefficients[3] - 1.96 * summ.tot2$coefficients[8]),3)`, `r round(exp(summ.tot2$coefficients[3] + 1.96 * summ.tot2$coefficients[8]),3)`, *p* \< 0.001), decreases by a factor of .87 for those with some college or an associate's degree (IRR = `r round(exp(summ.tot2$coefficients[4]),3)`, 95% CI: `r round(exp(summ.tot2$coefficients[4] - 1.96 * summ.tot2$coefficients[9]),3)`, `r round(exp(summ.tot2$coefficients[4] + 1.96 * summ.tot2$coefficients[9]),3)`  *p* \< 0.001), and increases by a factor of 1.09 for those with a graduate or professional degree (IRR = `r round(exp(summ.tot2$coefficients[5]),3)`, 95% CI: `r round(exp(summ.tot2$coefficients[5] - 1.96 * summ.tot2$coefficients[10]),3)`, `r round(exp(summ.tot2$coefficients[5] + 1.96 * summ.tot2$coefficients[10]),3)`, *p* \< 0.050) compared to those with a college degree. Within subject variance is 0.64 and between subject variance is 0.77. The ICC is 0.55, indicating that 55% of the variance in total CAMs used is between subjects. The marginal $R^2$ is 0.029 and the conditional $R^2$ is 0.557, indicating that 2.9% of the variance explained in the model is due to the fixed effects.

Model 3 includes both logged income and education as predictors of total CAMs used. When accounting for education, logged income does not significantly predict total CAMs used. When accounting for the effect of logged income, the expected count of total CAMs used decreases by a factor of 0.52 for those with less than a high school diploma (IRR = `r round(exp(summ.tot3$coefficients[3]),3)`, 95% CI: `r round(exp(summ.tot3$coefficients[3] - 1.96 * summ.tot3$coefficients[9]),3)`, `r round(exp(summ.tot3$coefficients[3] + 1.96 * summ.tot3$coefficients[9]),3)`, *p* \< 0.001), decreases by a factor of 0.69 for those with a high school diploma or GED (IRR =  `r round(exp(summ.tot3$coefficients[4]),3)`, 95% CI: `r round(exp(summ.tot3$coefficients[4] - 1.96 * summ.tot3$coefficients[10]),3)`, `r round(exp(summ.tot3$coefficients[4] + 1.96 * summ.tot3$coefficients[10]),3)`, *p* \< 0.001), decrease by a factor of 0.87 for those with some college or an associate's degree (IRR = `r round(exp(summ.tot3$coefficients[5]),3)`, 95% CI: `r round(exp(summ.tot3$coefficients[5] - 1.96 * summ.tot3$coefficients[11]),3)`, `r round(exp(summ.tot3$coefficients[5] + 1.96 * summ.tot3$coefficients[11]),3)`, *p* \< 0.001), and increases by a factor of 1.09 for those with a graduate or professional degree (IRR = `r round(exp(summ.tot3$coefficients[6]),3)`, 95% CI: `r round(exp(summ.tot3$coefficients[6] - 1.96 * summ.tot3$coefficients[12]),3)`, `r round(exp(summ.tot3$coefficients[6] + 1.96 * summ.tot3$coefficients[12]),3)`, *p* \< 0.050) compared to those with a college degree. The marginal $R^2$ is 0.029 and the conditional $R^2$ is 0.557, indicating that 2.9% of the variance explained in the model is due to the fixed effects.

In model 4, control variables are added to model 3. For each one unit increase in logged income the expected count of total CAMs used increases by a factor of 1.03 (IRR = `r round(exp(summ.tot4$coefficients[2]),3)`, 95% CI: `r round(exp(summ.tot4$coefficients[2] - 1.96 * summ.tot4$coefficients[18]),3)`, `r round(exp(summ.tot4$coefficients[2] + 1.96 * summ.tot4$coefficients[18]),3)`, *p* \< 0.010). The expected count of total CAMs used decreases by a factor of 0.56 for those with less than a high school diploma (OR = `r round(exp(summ.tot4$coefficients[3]),3)`, 95% CI: `r round(exp(summ.tot4$coefficients[3] - 1.96 * summ.tot4$coefficients[19]),3)`, `r round(exp(summ.tot4$coefficients[3] + 1.96 * summ.tot4$coefficients[19]),3)`, *p* \< 0.001), decreases by a factor of 0.68 for those with a high school diploma or GED (IRR = `r round(exp(summ.tot4$coefficients[4]),3)`, 95% CI: `r round(exp(summ.tot4$coefficients[4] - 1.96 * summ.tot4$coefficients[20]),3)`, `r round(exp(summ.tot4$coefficients[4] + 1.96 * summ.tot4$coefficients[20]),3)`, *p* \< 0.050) and decreases by a factor of 0.84 for those with some college or and associate's degree(IRR = `r round(exp(summ.tot4$coefficients[5]),3)`, 95% CI: `r round(exp(summ.tot4$coefficients[5] - 1.96 * summ.tot4$coefficients[21]),3)`, `r round(exp(summ.tot4$coefficients[5] + 1.96 * summ.tot4$coefficients[21]),3)`, *p* \< 0.001) compared to those with a college degree. The marginal $R^2$ is 0.152 and the conditional $R^2$ is 0.554, indicating that 15.2% of the variance explained in the model is due to the level 1 predictors.

As shown in Table \ref{tab:total-random-table}, within-in subject variance is 3.29 across all 4 models and between-subject variance ranges from 0.58 in Model 4 to 0.82 in Model 1. The ICC also ranges from 0.47-0.56, indicating that 47-56% of the variation in total CAMs used occurs between subjects.

## Mediation Models

In the following section, I will report results from several models testing whether CAM use mediates the relationship between SES and health as well as whether health mediates the relationship between SES and CAM use. Controls were included in all path models but were excluded from the path diagrams for ease of interpretation. Coefficients presented in the path diagrams are standardized coefficients.

### Chronic Conditions and CAM Use

The path diagram representing the relationships between SES, total CAMs used, and chronic conditions can be seen in Figure \ref{fig:path-totcams-chron}. The model fits the data well according to some goodness of fit indices (CFI = `r round(fit.totcams.chron[9], 3)`; RMSEA = `r round(fit.totcams.chron[23],3)`; SRMR = `r round(fit.totcams.chron[29],3)`) and poorly according to others ( \$\\chi\$^2^(`r round(fit.totcams.chron[4], 3)`)=`r round(fit.totcams.chron[3], 3)`, *p* \<.001.; TLI = `r round(fit.totcams.chron[10], 3)`). Income at wave 1 does not have a direct or indirect effect total CAMs used or number of chronic conditions at wave 3 (See Table \ref{tab:de-totcams-chron} for direct effects and Table \ref{tab:ie-totcams-chron} for indirect and total effects). Education at wave 1 has a positive direct effect on total CAMs used at wave 3 (*b* = `r round(est.totcams.chron$est[3], 3)`, 95% CI: `r round(est.totcams.chron$ci.lower[3],3)`, `r round(est.totcams.chron$ci.upper[3],3)`, *p* \< 0.01) but the relationship is not mediated by chronic conditions. Education at wave 1 has a negative direct effect on chronic conditions at wave 3 (*b* = `r round(est.totcams.chron$est[4], 3)`, 95% CI: `r round(est.totcams.chron$ci.lower[4], 3)`, `r round(est.totcams.chron$ci.upper[4], 3)`, *p* \< 0.01) but the relationship is not mediated by total CAMs used.

The next model assesses the relationships between SES, use of mind-body medicines, and sum of chronic conditions. Most goodness of fit indices indicate good model fit (See Table \ref{tab:fit-mb-chron}; \$\\chi\$^2^(`r round(fit.mb.chron[4],3)`) = `r round(fit.mb.chron[3],3)`, *p* \< 0.001; CFI = `r round(fit.mb.chron[9], 3)`; TLI = `r round(fit.mb.chron[10],3)`; RMSEA = `r round(fit.mb.chron[23],3)`, SRMR = `r round(fit.mb.chron[29],3)`). Logged income at wave 1 does not have a significant direct effect on mind-body medicine or sum of chronic conditions at wave 3 (See \ref{fig:path-mb-chron} for path diagram, Table \ref{tab:de-mb-chron} for direct effects, and Table \ref{tab:ie-mb-chron} for indirect and total effects). Education has a negative direct effect on sum of chronic conditions at wave 3 (*b* = `r round(est.mb.chron$est[4], 3)`, 95% CI: `r round(est.mb.chron$ci.lower[4],3)`, `r round(est.mb.chron$ci.upper[4],3)`, *p* \< 0.01) but the relationship is not mediated by use of mind-body medicines. Education at wave 1 has a positive direct effect on use of mind-body medicines at wave 3 (*b* = `r round(est.mb.chron$est[3],3)`, 95% CI: `r round(est.mb.chron$ci.lower[3],3)`, `r round(est.mb.chron$ci.upper[3],3)`, *p* \< 0.001) but this relationship is not mediated by sum of chronic conditions at wave 2.

The next model investigates the relationship between SES, use of alternative medicines, and sum of chronic conditions. Most goodness of fit indices indicate good model fit (See Table \ref{tab:fit-altmed-chron}; \$\\chi\$^2^(`r round(fit.altmed.chron[4],3)`) = `r round(fit.altmed.chron[3],3)`, *p* \< 0.001; CFI = `r round(fit.altmed.chron[9], 3)`; TLI = `r round(fit.altmed.chron[10],3)`; RMSEA = `r round(fit.altmed.chron[23],3)`, SRMR = `r round(fit.altmed.chron[29],3)`). Logged income at wave 1 does not have a significant direct effect on alternative medicine use or sum of chronic conditions at wave 3 (See \ref{fig:path-altmed-chron} for path diagram, Table \ref{tab:de-altmed-chron} for direct effects, and Table \ref{tab:ie-altmed-chron} for indirect and total effects). Education has a negative direct effect on sum of chronic conditions at wave 3 (*b* = `r round(est.altmed.chron$est[4], 3)`, 95% CI: `r round(est.altmed.chron$ci.lower[4],3)`, `r round(est.altmed.chron$ci.upper[4],3)`, *p* \< 0.01) but the relationship is not mediated by use of alternative medicines. Education at wave 1 has a positive direct effect on use of alternative medicines at wave 3 (*b* = `r round(est.altmed.chron$est[3],3)`, 95% CI: `r round(est.altmed.chron$ci.lower[3],3)`, `r round(est.altmed.chron$ci.upper[3],3)`, *p* \< 0.05) but this relationship is not mediated by sum of chronic conditions at wave 2.

The next model investigates the relationship between SES, use of physical and nutritional approaches, and sum of chronic conditions. Goodness of fit indices were varied in their assessment of model fit (See Table \ref{tab:fit-pna-chron}; \$\\chi\$^2^(`r round(fit.pna.chron[4],3)`) = `r round(fit.pna.chron[3],3)`, *p* \< 0.001; CFI = `r round(fit.pna.chron[9], 3)`; TLI = `r round(fit.pna.chron[10],3)`; RMSEA = `r round(fit.pna.chron[23],3)`, SRMR = `r round(fit.pna.chron[29],3)`). Logged income at wave 1 does not have a significant direct effect on use of physical and nutritional approaches at wave 3 (See \ref{fig:path-pna-chron} for path diagram, Table \ref{tab:de-pna-chron} for direct effects, and Table \ref{tab:ie-pna-chron} for indirect and total effects). Logged income at wave 1 had a negative direct effect on sum of chronic conditions at wave 3 (*b* = `r round(est.pna.chron$est[2], 3)`, 95% CI: `r round(est.pna.chron$ci.lower[2],3)`, `r round(est.pna.chron$ci.upper[2],3)`, *p* \< 0.05) however the relationship is not mediated by use of physical and nutritional approaches.

Education has a negative direct effect on sum of chronic conditions at wave 3 (*b* = `r round(est.pna.chron$est[4], 3)`, 95% CI: `r round(est.pna.chron$ci.lower[4],3)`, `r round(est.pna.chron$ci.upper[4],3)`, *p* \< 0.01). The relationship is mediated by use of physical and nutritional approaches (*b* = `r round(est.pna.chron$est[155], 3)`, 95% CI: `r round(est.pna.chron$ci.lower[155],3)`, `r round(est.pna.chron$ci.upper[155],3)`, *p* \< 0.05). For each additional level of education completed sum of chronic conditions at wave 3 is expected to increase by 0.014 via education's effect on the use of physical and nutritional approaches. Education at wave 1 has a positive direct effect on use of physical and nutritional approaches at wave 3 (*b* = `r round(est.pna.chron$est[3],3)`, 95% CI: `r round(est.pna.chron$ci.lower[3],3)`, `r round(est.pna.chron$ci.upper[3],3)`, *p* \< 0.05). This relationship is partially mediated by sum of chronic conditions (*b* = `r round(est.pna.chron$est[154], 3)`, 95% CI: `r round(est.pna.chron$ci.lower[154],3)`, `r round(est.pna.chron$ci.upper[154],3)`, *p* \< 0.05). For each additional level of education completed the log odds of using physical and nutritional approaches decrease by 0.002 via education's effect on sum of chronic conditions at wave 2. Looking at the direct effects of chronic conditions on use of physical and nutritional approaches (*b* = `r round(est.pna.chron$est[6],3)`, 95% CI: `r round(est.pna.chron$ci.lower[6],3)`, `r round(est.pna.chron$ci.upper[6],3)`, *p* \< 0.001) and physical and nutritional approaches on sum of chronic conditions (*b* = `r round(est.pna.chron$est[8],3)`, 95% CI: `r round(est.pna.chron$ci.lower[8],3)`, `r round(est.pna.chron$ci.upper[8],3)`, *p* \< 0.01) we see that the relationship is positive in both causal directions. Respondents with more chronic conditions use more physical and nutritional approaches and respondents who use physical and nutritional approaches have more chronic conditions.

The next model investigates the relationship between SES, use of manipulative treatments, and sum of chronic conditions. Most goodness of fit indices indicate good model fit (See Table \ref{tab:fit-manipulative-chron}; \$\\chi\$^2^(`r round(fit.manipulative.chron[4],3)`) = `r round(fit.manipulative.chron[3],3)`, *p* \< 0.001; CFI = `r round(fit.manipulative.chron[9], 3)`; TLI = `r round(fit.manipulative.chron[10],3)`; RMSEA = `r round(fit.manipulative.chron[23],3)`, SRMR = `r round(fit.manipulative.chron[29],3)`). Logged income at wave 1 does not have a significant direct effect on manipulative treatment use or sum of chronic conditions at wave 3 (See \ref{fig:path-manipulative-chron} for path diagram, Table \ref{tab:de-manipulative-chron} for direct effects, and Table \ref{tab:ie-manipulative-chron} for indirect and total effects). Education has a negative direct effect on sum of chronic conditions at wave 3 (*b* = `r round(est.manipulative.chron$est[4], 3)`, 95% CI: `r round(est.manipulative.chron$ci.lower[4],3)`, `r round(est.manipulative.chron$ci.upper[4],3)`, *p* \< 0.01) but the relationship is not mediated by use of manipulative treatments. Education at wave 1 has a positive direct effect on use of manipulative treatments at wave 3 (*b* = `r round(est.manipulative.chron$est[3],3)`, 95% CI: `r round(est.manipulative.chron$ci.lower[3],3)`, `r round(est.manipulative.chron$ci.upper[3],3)`, *p* \< 0.05) but this relationship is not mediated by sum of chronic conditions at wave 2.

### Self-Reported Health and CAM Use

The following models examine the relationships between SES, CAMs, and self-reported health (SRH). The first model assesses the relationship between SES, total CAMs used, and self-reported health. Most goodness of fit indices indicate poor model fit (See Table \ref{tab:fit-totcams-SRH}; \$\\chi\$^2^(`r round(fit.totcams.SRH[4],3)`) = `r round(fit.totcams.SRH[3],3)`, *p* \< 0.001; CFI = `r round(fit.totcams.SRH[9], 3)`; TLI = `r round(fit.totcams.SRH[10],3)`; RMSEA = `r round(fit.totcams.SRH[23],3)`, SRMR = `r round(fit.totcams.SRH[29],3)`). Logged income at wave 1 does not have a significant direct effect on to total CAMs used at wave 3 (See \ref{fig:path-totcams-SRH} for path diagram, Table \ref{tab:de-totcams-SRH} for direct effects, and Table \ref{tab:ie-totcams-SRH} for indirect and total effects). Logged income at wave 1 has a positive direct effect on SRH at wave 3 (*b* = `r round(est.totcams.SRH$est[2], 3)`, 95% CI: `r round(est.totcams.SRH$ci.lower[2],3)`, `r round(est.totcams.SRH$ci.upper[2],3)`, *p* \< 0.001) but this effect is not mediated by total CAMs used at wave 2. Education has a positive direct effect on SRH at wave 3 (*b* = `r round(est.totcams.SRH$est[4], 3)`, 95% CI: `r round(est.totcams.SRH$ci.lower[4],3)`, `r round(est.totcams.SRH$ci.upper[4],3)`, *p* \< 0.001) but the relationship is not mediated by total CAMs used at wave 2. Education has a positive direct effect on use of mind-body medicines at wave 3 (*b* = `r round(est.totcams.chron$est[3],3)`, 95% CI: `r round(est.totcams.chron$ci.lower[3],3)`, `r round(est.totcams.chron$ci.upper[3],3)`, *p* \< 0.01) but the relationship is not mediated by SRH at wave 2.

Next the relationships between SES, use of mind-body medicines, and self-reported health were examined. Goodness of fit indices indicate poor model fit (See Table \ref{tab:fit-mb-SRH}; \$\\chi\$^2^(`r round(fit.mb.SRH[4],3)`) = `r round(fit.mb.SRH[3],3)`, *p* \< 0.001; CFI = `r round(fit.mb.SRH[9], 3)`; TLI = `r round(fit.mb.SRH[10],3)`; RMSEA = `r round(fit.mb.SRH[23],3)`, SRMR = `r round(fit.mb.SRH[29],3)`. Logged income at wave 1 does not have a direct effect on use of mind-body medicines at wave 3 (See Table \ref{tab:de-mb-SRH} for direct effects, Table \ref{tab:ie-mb-SRH} for indirect effects, and \ref{fig:path-mb-SRH} for path diagram). Logged income at wave 1 has a positive direct effect on SRH at wave 3 (*b* = `r round(est.mb.SRH$est[2], 3)`, 95% CI: `r round(est.mb.SRH$ci.lower[2],3)`, `r round(est.mb.SRH$ci.upper[2],3)`, *p* \< 0.001) but this effect is not mediated by use of mind-body medicine at wave 2. Education has a positive direct effect on SRH at wave 3 (*b* = `r round(est.mb.SRH$est[4], 3)`, 95% CI: `r round(est.mb.SRH$ci.lower[4],3)`, `r round(est.mb.SRH$ci.upper[4],3)`, *p* \< 0.001) but the relationship is not mediated by use of mind-body medicines at wave 2. Education has a positive direct effect on use of mind-body medicines at wave 3 (*b* = `r round(est.mb.chron$est[3],3)`, 95% CI: `r round(est.mb.chron$ci.lower[3],3)`, `r round(est.mb.chron$ci.upper[3],3)`, *p* \< 0.01) but the relationship is not mediated by SRH at wave 2.

Next the relationships between SES, use of alternative medicines, and self-reported health were examined. Goodness of fit indices indicate poor model fit (See Table \ref{tab:fit-altmed-SRH}; \$\\chi\$^2^(`r round(fit.altmed.SRH[4],3)`) = `r round(fit.altmed.SRH[3],3)`, *p* \< 0.001; CFI = `r round(fit.altmed.SRH[9], 3)`; TLI = `r round(fit.altmed.SRH[10],3)`; RMSEA = `r round(fit.altmed.SRH[23],3)`, SRMR = `r round(fit.altmed.SRH[29],3)`. Logged income at wave 1 does not have a direct effect on use of alternative medicines at wave 3 (See Table \ref{tab:de-altmed-SRH} for direct effects, Table \ref{tab:ie-altmed-SRH} for indirect effects, Figure \ref{fig:path-altmed-SRH} for path diagram). Logged income at wave 1 has a positive direct effect on SRH at wave 3 (*b* = `r round(est.altmed.SRH$est[2], 3)`, 95% CI: `r round(est.altmed.SRH$ci.lower[2],3)`, `r round(est.altmed.SRH$ci.upper[2],3)`, *p* \< 0.001) but this effect is not mediated by use of alternative medicines at wave 2. Education has a positive direct effect on SRH at wave 3 (*b* = `r round(est.altmed.SRH$est[4], 3)`, 95% CI: `r round(est.altmed.SRH$ci.lower[4],3)`, `r round(est.altmed.SRH$ci.upper[4],3)`, *p* \< 0.001) but the relationship is not mediated by use of alternative medicines at wave 2. Education has a positive direct effect on use of alternative medicines at wave 3 (*b* = `r round(est.altmed.chron$est[3],3)`, 95% CI: `r round(est.altmed.chron$ci.lower[3],3)`, `r round(est.altmed.chron$ci.upper[3],3)`, *p* \< 0.05) but the relationship is not mediated by SRH at wave 2.

Next the relationships between SES, use of physical and nutritional approaches, and self-reported health were examined. Most goodness of fit indices indicate poor model fit (See Table \ref{tab:fit-pna-SRH}; \$\\chi\$^2^(`r round(fit.pna.SRH[4],3)`) = `r round(fit.pna.SRH[3],3)`, *p* \< 0.001; CFI = `r round(fit.pna.SRH[9], 3)`; TLI = `r round(fit.pna.SRH[10],3)`; RMSEA = `r round(fit.pna.SRH[23],3)`, SRMR = `r round(fit.pna.SRH[29],3)`. Logged income at wave 1 does not have a direct effect on use of physical and nutritional approaches at wave 3 (See Table \ref{tab:de-pna-SRH} for direct effects, Table \ref{tab:ie-pna-SRH} for indirect effects, Figure \ref{fig:path-pna-SRH} for path diagram). Logged income at wave 1 has a positive direct effect on SRH at wave 3 (*b* = `r round(est.pna.SRH$est[2], 3)`, 95% CI: `r round(est.pna.SRH$ci.lower[2],3)`, `r round(est.pna.SRH$ci.upper[2],3)`, *p* \< 0.001) but this effect is not mediated by use of physical and nutritional approaches at wave 2. Education has a positive direct effect on SRH at wave 3 (*b* = `r round(est.pna.SRH$est[4], 3)`, 95% CI: `r round(est.pna.SRH$ci.lower[4],3)`, `r round(est.pna.SRH$ci.upper[4],3)`, *p* \< 0.001) but the relationship is not mediated by use of physical and nutritional approaches at wave 2. Education has a positive direct effect on use of physical and nutritional approaches at wave 3 (*b* = `r round(est.pna.chron$est[3],3)`, 95% CI: `r round(est.pna.chron$ci.lower[3],3)`, `r round(est.pna.chron$ci.upper[3],3)`, *p* \< 0.001) but the relationship is not mediated by SRH at wave 2.

Finally, the relationships between SES, use of manipulative treatments, and self-reported health were examined. Most goodness of fit indices indicate poor model fit (See Table \ref{tab:fit-manipulative-SRH}; \$\\chi\$^2^(`r round(fit.manipulative.SRH[4],3)`) = `r round(fit.manipulative.SRH[3],3)`, *p* \< 0.001; CFI = `r round(fit.manipulative.SRH[9], 3)`; TLI = `r round(fit.manipulative.SRH[10],3)`; RMSEA = `r round(fit.manipulative.SRH[23],3)`, SRMR = `r round(fit.manipulative.SRH[29],3)`. Logged income at wave 1 does not have a direct effect on use of manipulative treatments at wave 3 (See Table \ref{tab:de-manipulative-SRH} for direct effects, Table \ref{tab:ie-manipulative-SRH} for indirect effects, Figure \ref{fig:path-manipulative-SRH} for path diagram). Logged income at wave 1 has a positive direct effect on SRH at wave 3 (*b* = `r round(est.manipulative.SRH$est[2], 3)`, 95% CI: `r round(est.manipulative.SRH$ci.lower[2],3)`, `r round(est.manipulative.SRH$ci.upper[2],3)`, *p* \< 0.001) but this effect is not mediated by use of manipulative treatments at wave 2. Education has a positive direct effect on SRH at wave 3 (*b* = `r round(est.manipulative.SRH$est[4], 3)`, 95% CI: `r round(est.manipulative.SRH$ci.lower[4],3)`, `r round(est.manipulative.SRH$ci.upper[4],3)`, *p* \< 0.001) but the relationship is not mediated by use of manipulative treatments at wave 2. Education does not have a direct effect on use of manipulative treatments at wave 3.

## Moderation Models

The following models examine the relationship between changes in health and adoption of CAMs and whether income and education moderate this relationship. I model differences between each combination of waves, first using change in chronic conditions as a predictor then changes in SRH.

The effect of changes in chronic conditions on changes in CAM use varies by the waves compared, though when significant the relationship is always positive. Change in chronic conditions is positively related to a change in total CAMs used looking at waves 1 and 2 (See Tables \ref{tab:waves12-chron-mod-income} and \ref{tab:waves12-chron-mod-educ}). When accounting for the effect of logged income, each additional chronic condition is related to a 0.058 increase in total CAMs used at wave 2 (*b* = `r round(waves12.chron.income.1$coefficients[2],3)`, SE = `r round(waves12.chron.income.1.se[2],3)`, *p* \< 0.050). When accounting for the effect of education, the effect of difference in chronic conditions on change in CAM use are the same between waves 1 and 2 (*b* = `r round(waves12.chron.educ.1$coefficients[2],3)`, SE = `r round(waves12.chron.educ.1.se[2],3)`, *p* \< 0.050). Looking at differences between waves 2 and 3, difference in chronic conditions does not significantly predict changes in total CAMs used (See Tables \ref{tab:waves23-chron-mod-income} and \ref{tab:waves23-chron-mod-educ}). There is also no significant effect for the wave 1 and 3 comparison (See Tables \ref{tab:waves13-chron-mod-income} and \ref{tab:waves13-chron-mod-educ}). 

Income does not moderate the relationship between changes in total CAMs used and differences in chronic conditions between any combination of waves (See Tables \@ref(tab:waves12-chron-mod-income), \ref{tab:waves23-chron-mod-income}, and \ref{tab:waves13-chron-mod-income}) and Figures \ref{fig:plot-waves12-chron-income-3}, \ref{fig:plot-waves23-chron-income-3}, and \ref{fig:plot-waves13-chron-income-3}). 

Findings on whether education moderates the relationship between difference in chronic conditions and difference in total CAMs used were mixed between wave comparisons. There was no moderation effect for education on the relationship between changes in chronic conditions and changes in total CAMs used between waves 1 and 2 (Table \ref{tab:waves12-chron-mod-educ}). The moderation effect of education was significantly different for those with some college or an associate's degree (*b* = `r round(waves23.chron.educ.3$coefficients[20],3)`, SE = `r round(waves23.chron.educ.3.se[20],3)`, *p* \< 0.05) and those with a professional or graduate degree (*b* = `r round(waves23.chron.educ.3$coefficients[21],3)`, SE = `r round(waves23.chron.educ.3.se[21])`, *p* \< 0.01). See Table \ref{tab:waves23-chron-mod-educ}. Looking at the plotted regression lines for each education group it is clear that the relationship between a change in chronic conditions and adoption of CAMs is negative for college graduates and positive for those with some college or a graduate or professional degree (See Figure \ref{fig:plot-waves23-chron-educ-3}). Comparing waves 1 and 3, there is a significant difference in the moderation effect of education between those with less than a high school diploma (*b* = `r round(waves13.chron.educ.3$coefficients[18],3)`, SE = `r round(waves13.chron.educ.3.se[18],3)`, *p* \< 0.050) and those with a graduate or professional degree (*b* = `r round(waves13.chron.educ.3$coefficients[21],3)`, SE = `r round(waves13.chron.educ.3.se[21],3)`, *p* \< 0.050) compared to those with a college degree. Similar to the wave 2 and 3 comparison, the plotted regression lines show that the relationship between change in chronic conditions and change in total CAMs used is negative for those with a college degree and positive for those with less than a high school diploma and those with a graduate or professional degree.

Education has a significant effect on difference in number of CAMs used. Compared to those with less than a high school education, those with a high school diploma or GED used .563 fewer CAMs (*b* = `r round(waves23.chron.educ.3$coefficients[3], 3)`, SE = `r round(waves23.chron.educ.3.se[3],3)`, *p* \< 0.01), those with some college or an AA degree used 0.517 fewer CAMs (*b* = `r round (waves23.chron.educ.3$coefficients[4],4)`, SE = `r round (waves23.chron.educ.3.se[4], 3)`, *p* \< 0.01), those with a college degree use 0.574 fewer CAMs (*b* = `r round(waves23.chron.educ.3$coefficients[5],3)`, SE = `r round(waves23.chron.educ.3.se[5],3)`, *p* \< 0.01), and those with a graduate or professional degree used 0.608 fewer CAMs (*b* = `r round(waves23.chron.educ.3$coefficients[6],3)`, SE = `r round(waves23.chron.educ.3.se[6],3)`, *p* \< 0.01) in wave 2 compared to wave 3 in the full model including controls.

No relationship between changes in SRH and changes in total CAMs used was found in any of the between wave comparisons (See Tables \ref{tab:waves12-SRH-mod-income}, \ref{tab:waves23-SRH-mod-income}, \ref{tab:waves13-SRH-mod-income}, \ref{tab:waves12-SRH-mod-educ}, \ref{tab:waves23-SRH-mod-educ}, \ref{tab:waves13-SRH-mod-educ}). Similarly there was no moderation effect for income or education on the relationship. 

# Discussion


