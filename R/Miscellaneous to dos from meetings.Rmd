---
title: "Miscellaneous to dos from meetings"
author: "Hannah Andrews"
date: "6/7/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(foreign)
library(expss)
library(Hmisc)
library(dplyr)
library(summarytools)
library(magrittr)
library(tidyverse)
library(mosaic)
library(lattice)
library(ggplot2)
library(scales)
library(ggthemes)
library(polycor)
library(psych)
library(REdaS)
library(haven)
library(labelled)
library(mice)
library(GPArotation)
library(foreach)
library(doParallel)
library(questionr)
library(gridExtra)
library(DAKS)
library(fdth)
library(lavaan)
```

```{r, echo = FALSE, results = 'hide'}
# Read in MIDUS1 data and subset to complete cases on CAMs
# Read in stata file for MIDUS 1
path <- ("C:/Users/hanna/Documents/git/AHL/Stata/data-cleaning/MIDUS1.dta")
M1 <- read_dta(path)
acamsList <- c("acam1", "acam2", "acam3", "acam4", "acam5", "acam6", "acam7", 
               "acam8", "acam9", "acam10", "acam11", "acam12", "acam13", "acam14", "acam15")
acams <- M1[acamsList] # Subset MIDUS1 - only include CAMs.

# Remove attributes from acams data - created in Stata (labels and data notes). They're (were) producing an error with bart_spher.
acams <- remove_attributes(acams, "label")
acams <- remove_attributes(acams, "notes")

str(acams)

# Create column that is the sum of CAMs used 
totalCams <- rowSums(acams[,1:15])

acams[sapply(acams, is.numeric)] <- lapply(acams[sapply(acams, is.numeric)], as.factor) # convert all columns to factors

str(acams) 
head(acams)

# Rename columns 
acams <- dplyr::rename(acams, 
                          aAcupuncture = acam1, 
                          aBiofeedback = acam2,
                          aChiropractic = acam3,
                          aEnergyHeal = acam4,
                          aExerciseMove = acam5,
                          aHerbal = acam6,
                          aVitamins = acam7,
                          aHomeopathy = acam8,
                          aHypnosis = acam9,
                          aImageryTech = acam10,
                          aMassage = acam11,
                          aPrayer = acam12,
                          aRelaxMeditate = acam13,
                          aSpecialDiet = acam14,
                          aSpiritHeal = acam15)
head(acams)
# Keep only complete cases
acams=acams[complete.cases(acams),]
str(acams)
```

# Meeting 6/3/21

## Spiritual healing and prayer crosstabs

Check overlap between spiritual healing and prayer. If all those who practice spiritual healing also pray, that may be the cause of the low MSAi's from the KMO test. All the variance in spiritual healing would be common with prayer.

0 = No, 1 = Yes

```{r, echo = FALSE}
crosstab(acams$aSpiritHeal, acams$aPrayer, prop.t = TRUE, plot = FALSE)

mosaicplot(aPrayer~aSpiritHeal, data=acams, shade = TRUE)
```
Nearly 70% respond no to both. 26% of those who prayer do not use spiritual healing. Among those who use spiritual healing, less than 1% do not use prayer compared to 3% who do use prayer. 


Run crosstabs on all variables that load on more than one factor with variables loading on the same factors.  

## Energy Healing
Energy healing loads on three factors in the four, five, and six factor models with all variables are included. 
Energy healing loads on two and five factor models when prayer and spiritual healing are excluded.  

### Energy healing and prayer 
All CAMs: loads with prayer in four factor model and five factor model 

```{r, echo=FALSE}
table_EnergyPray <- table(acams$aEnergyHeal, acams$aPrayer)
table_EnergyPray

prop.table(table_EnergyPray)

mosaicplot(aEnergyHeal~aPrayer, data=acams, shade = TRUE)
```
70% of the sample does not use energy healing or prayer. About 1% use both. 28% use prayer but not energy healing. Less than 1% use energy healing but not prayer. 

### Energy healing and spiritual healing
```{r, echo=FALSE}
table_EnergySpirit <- table(acams$aEnergyHeal, acams$aSpiritHeal)
table_EnergySpirit

prop.table(table_EnergySpirit)

mosaicplot(aEnergyHeal~aSpiritHeal, data=acams, shade = TRUE)
```
95% of the sample does not use spiritual or energy healing. Less than 1% use both. 1% use energy healing but not spiritual healing. 2.7% use spiritual healing but not energy healing. 


### Energy healing and imagery techniques
```{r, echo=FALSE}
table_EnergyImag <- table(acams$aEnergyHeal, acams$aImageryTech)
table_EnergyImag

prop.table(table_EnergyImag)

mosaicplot(aEnergyHeal~aImageryTech, data=acams, shade = TRUE)
```
96% of the sample does not use energy healing or imagery techniques. Less than 1% use both. Less than 1% use energy healing but not imagery. 2.2% use imagery but not energy healing. 

### Energy healing and hypnosis
```{r, echo=FALSE}
table_EnergyHypno <- table(acams$aEnergyHeal, acams$aHypnosis)
table_EnergyHypno

prop.table(table_EnergyHypno)

mosaicplot(aEnergyHeal~aHypnosis, data=acams, shade = TRUE)
```
97.5% use neither energy healing or hypnosis. Less than 1% use both. 1.3% use energy healing but not hypnosis. About 1% use hypnosis but not energy healing. 

### Energy healing and meditation
```{r, echo=FALSE}
table_EnergyMed <- table(acams$aEnergyHeal, acams$aRelaxMeditate)
table_EnergyMed

prop.table(table_EnergyMed)

mosaicplot(aEnergyHeal~aRelaxMeditate, data=acams, shade = TRUE)
```
86% of the sample use neither meditation or energy healing. 1.3% use both. 12% use meditation but not energy healing. Less than 1% use energy healing but not meditation. 

### Energy healing and biofeedback
```{r, echo=FALSE}
table_EnergyBio <- table(acams$aEnergyHeal, acams$aBiofeedback)
table_EnergyBio

prop.table(table_EnergyBio)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aEnergyHeal~aBiofeedback, data=acams, shade = TRUE)
```
98% use neither. Less than 1% use both. 1.3% use energy healing but not hypnosis. Less than 1% use hypnosis but not energy healing. 

### Energy healing and special diet
```{r, echo=FALSE}
table_EnergyDiet <- table(acams$aEnergyHeal, acams$aSpecialDiet)
table_EnergyDiet

prop.table(table_EnergyDiet)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aEnergyHeal~aSpecialDiet, data=acams, shade = TRUE)
```
88% use neither. Less than 1% use both. 10% use a special diet not but energy healing. Less than 1% use energy healing but not a special diet. 

### Energy healing and massage
```{r, echo=FALSE}
table_EnergyMassage <- table(acams$aEnergyHeal, acams$aMassage)
table_EnergyMassage

prop.table(table_EnergyMassage)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aEnergyHeal~aMassage, data=acams, shade = TRUE)
```
91% use neither. Less than 1% use both. About 8% use massage but not energy healing. Less than 1% use energy healing but not massage. 

### Energy healing and homeopathy
```{r, echo=FALSE}
table_EnergyHomeo <- table(acams$aEnergyHeal, acams$aHomeopathy)
table_EnergyHomeo

prop.table(table_EnergyHomeo)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aEnergyHeal~aHomeopathy, data=acams, shade = TRUE)
```
97% use neither. Less than 1% use both. About 2% use homeopathy but not energy healing. Less than 1% use energy healing but not homeopathy. 

### Energy healing and vitamins
```{r, echo=FALSE}
table_EnergyVitamin <- table(acams$aEnergyHeal, acams$aVitamins)
table_EnergyVitamin

prop.table(table_EnergyVitamin)

par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aEnergyHeal~aVitamins, data=acams, color = TRUE)
```
94% use neither. Less than 1% use both. 4% use vitamins but not energy healing. 1% use energy healing but not vitamins. 

### Energy healing and herbal
```{r, echo=FALSE}
table_EnergyHerb <- table(acams$aEnergyHeal, acams$aHerbal)
table_EnergyHerb

prop.table(table_EnergyHerb)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aEnergyHeal~aHerbal, data=acams, shade = TRUE)
```
94% use neither. Less than 1% use both. Less than 1% use energy healing but not herbal therapy. 4% use herbal therapy but not energy healing. 

### Energy healing and Exercise/Movement
```{r, echo=FALSE}
table_EnergyExercise <- table(acams$aEnergyHeal, acams$aExerciseMove)
table_EnergyExercise

prop.table(table_EnergyExercise)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aEnergyHeal~aExerciseMove, data=acams, shade=TRUE)
```
82% use neither. 1% use both. 16% use exercise or movement therapy but not energy healing. Less than 1% use energy healing but not exercise or movement therapy. 

### Energy healing and chiropractic
```{r, echo=FALSE}
table_EnergyChiro <- table(acams$aEnergyHeal, acams$aChiropractic)
table_EnergyChiro

prop.table(table_EnergyChiro)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aEnergyHeal~aChiropractic, data=acams, shade=TRUE)
```
87% use neither. Less than 1% use both. 11% use chiropractic care but not energy healing. About 1% use energy healing but not chiropractic care. 

### Energy healing and acupuncture
```{r, echo=FALSE}
table_EnergyAcupuncture <- table(acams$aEnergyHeal, acams$aAcupuncture)
table_EnergyAcupuncture

prop.table(table_EnergyAcupuncture)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aEnergyHeal~aAcupuncture, data=acams, shade = TRUE)
```
97.5% use neither. Less than 1% use both. Less than 1% use acupuncture but not energy healing. 1.3% use energy healing but not acupuncture. 

## Massage 
Drop spiritual healing and prayer: Loads on two factors in the four factor model 

### Massage and Exercise/Movement
```{r, echo=FALSE}
table_MassageExercise <- table(acams$aMassage, acams$aExerciseMove)
table_MassageExercise

prop.table(table_MassageExercise)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aMassage~aExerciseMove, data=acams, shade = TRUE)
```
79% of the sample use neither. 5% use both. 13% use exercise or movement therapy but not massage. 4% use massage but not exercise or movement therapy. 
### Massage and Chiropractic
```{r, echo=FALSE}
table_MassageChiro <- table(acams$aMassage, acams$aChiropractic)
table_MassageChiro

prop.table(table_MassageChiro)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aMassage~aChiropractic, data=acams, shade = TRUE)
```
83% use neither. 3% use both. 9% use chiropractic care but not massage. 5% use massage but not chiropractic care. 

## Acupuncture
Drop prayer and spiritual healing: loads on two factors in the 5 factor model. 

### Acupuncture and Vitamins
```{r, echo=FALSE}
table_AcupunctureVitamins <- table(acams$aAcupuncture, acams$aVitamins)
table_AcupunctureVitamins

prop.table(table_AcupunctureVitamins)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aAcupuncture~aVitamins, data=acams, shade = TRUE)
```
84% use neither. Less than 1% use both. 4% use vitamins but not acupuncture. Less than 1% use acupuncture but not vitamins. 

### Acupuncture and Herbal 
```{r, echo=FALSE}
table_AcupunctureHerbal <- table(acams$aAcupuncture, acams$aHerbal)
table_AcupunctureHerbal

prop.table(table_AcupunctureHerbal)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aAcupuncture~aHerbal, data=acams, shade = TRUE)
```
94% use neither. Less than 1% use both. 4% use herbal therapy but not acupuncture. Less than 1% use acupuncture but not herbal therapy. 

### Acupuncture and Homeopathy
```{r, echo=FALSE}
table_AcupunctureHomeo <- table(acams$aAcupuncture, acams$aHomeopathy)
table_AcupunctureHomeo

prop.table(table_AcupunctureHomeo)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aAcupuncture~aHomeopathy, data=acams, shade = TRUE)
```
97% use neither. Less than 1% use both. 2% use homeopathy but not acupuncture. Less than 1% use acupuncture but not homeopathy. 


### Acupuncture and Special Diet 
```{r, echo=FALSE}
table_AcupunctureDiet <- table(acams$aAcupuncture, acams$aSpecialDiet)
table_AcupunctureDiet

prop.table(table_AcupunctureDiet)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aAcupuncture~aSpecialDiet, data=acams, shade = TRUE)
```
88% use neither. Less than 1% use both. 10% use a special diet but not acupuncture. Less than 1% use acupuncture but not a special diet. 

### Acupuncture and Exercise Movement Therapy 
```{r, echo=FALSE}
table_AcupunctureExercise <- table(acams$aAcupuncture, acams$aExerciseMove)
table_AcupunctureExercise

prop.table(table_AcupunctureExercise)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aAcupuncture~aExerciseMove, data=acams, shade = TRUE)
```
82% use neither. Less than 1% use both. 17% use exercise or movement therapy but not acupuncture. Less than 1% use acupuncture but not exercise or movement therapy. 

## Exercise or Movement Therapy 
Drop spiritual healing and prayer: loads on two factors in the five factor model. 

### Exercise and Chiropractic 
```{r, echo=FALSE}
table_ExerciseChiro <- table(acams$aExerciseMove, acams$aChiropractic)
table_ExerciseChiro

prop.table(table_ExerciseChiro)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aExerciseMove~aChiropractic, data=acams, shade = TRUE)
```
74% use neither. Less than 4% use both. 8% use chiropractic care but not exercise or movement therapy. 14% use chiropractic care but not exercise or movement therapy. 

### Exercise and Massage 
```{r, echo=FALSE}
table_ExerciseMassage <- table(acams$aExerciseMove, acams$aMassage)
table_ExerciseMassage

prop.table(table_ExerciseMassage)

#par(mfrow=c(1,2)) # display the plots in 1 row and 2 columns
mosaicplot(aExerciseMove~aMassage, data=acams, shade = TRUE)
```
78.9% use neither. 4.8% use both. 3.6% use massage but not exercise or movement therapy. 12.7% use exercise or movement therapy but not massage. 