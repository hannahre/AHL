---
title: "lca results complete all wave vars more than 100"
author: "Hannah Andrews"
date: "11/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(DT)

setwd("C:/Users/hanna/Documents/git/AHL/R/complete all waves lca")
load("complete_wave1_morethan50_lca.rda")
load("complete_wave1_morethan50_table.rda")
load("complete_wave2_morethan50_lca.rda")
load("complete_wave2_morethan50_table.rda")
load("complete_wave3_morethan50_lca.rda")
load("complete_wave3_morethan50_table.rda")
```

# Model fit and class sizes

## Wave 1 
```{r, echo = FALSE}
wave1.morethan50.table
```
AIC 6 classes. BIC 4 classes. Entropy low
```{r, echo = FALSE}
# Class sizes
table(wave1.morethan50[[3]]$predclass)
round(prop.table(table(wave1.morethan50[[3]]$predclass)),4)*100
table(wave1.morethan50[[4]]$predclass)
round(prop.table(table(wave1.morethan50[[4]]$predclass)),4)*100
table(wave1.morethan50[[5]]$predclass)
round(prop.table(table(wave1.morethan50[[5]]$predclass)),4)*100
table(wave1.morethan50[[6]]$predclass)
round(prop.table(table(wave1.morethan50[[6]]$predclass)),4)*100
```

## Wave 2 
```{r, echo = FALSE}
wave2.morethan50.table
```
AIC 6 classes, BIC 4 classes. Entropy above .7 for four classes. 
```{r, echo = FALSE}
# Class sizes
table(wave2.morethan50[[3]]$predclass)
round(prop.table(table(wave2.morethan50[[3]]$predclass)),4)*100
table(wave2.morethan50[[4]]$predclass)
round(prop.table(table(wave2.morethan50[[4]]$predclass)),4)*100
table(wave2.morethan50[[5]]$predclass)
round(prop.table(table(wave2.morethan50[[5]]$predclass)),4)*100
table(wave2.morethan50[[6]]$predclass)
round(prop.table(table(wave2.morethan50[[6]]$predclass)),4)*100
```

## Wave 3 
```{r, echo = FALSE }
wave3.morethan50.table
```
AIC 6 classes. BIC 3 classes. Entropy above .7 3 classes. 

```{r, echo = FALSE}
# Class sizes
table(wave3.morethan50[[3]]$predclass)
round(prop.table(table(wave3.morethan50[[3]]$predclass)),4)*100
table(wave3.morethan50[[4]]$predclass)
round(prop.table(table(wave3.morethan50[[4]]$predclass)),4)*100
table(wave3.morethan50[[5]]$predclass)
round(prop.table(table(wave3.morethan50[[5]]$predclass)),4)*100
table(wave3.morethan50[[6]]$predclass)
round(prop.table(table(wave3.morethan50[[6]]$predclass)),4)*100
```

# 3 Class Model 

## Wave 1
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave1.morethan50[[3]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 3 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=3, ncol=20)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave1.morethan50.3 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 3 by 13 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave1.morethan50.3) <- c("Chiropractic", "ExerciseMove", "Herbal",
                                   "Vitamins","Homeopathy", "Imagery Techniques", "Massage", "RelaxMeditate", "SpecialDiet", "PraySpirit")
# Rename rows after model #
rownames(wave1.morethan50.3) <- c("Model 1", "Model 2", "Model 3")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave1.morethan50.3, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave1.morethan50.3 <- datatable(wave1.morethan50.3) %>% 
  formatStyle(names(c(wave1.morethan50.3)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:10, 2)
color.wave1.morethan50.3
```
Class 1: Exercise, Prayer, massage, meditation,
Class 2: nothing
Class 3: Nothing 

# Wave 2
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave2.morethan50[[3]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 3 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=3, ncol=20)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave2.morethan50.3 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 3 by 13 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave2.morethan50.3) <- c("Chiropractic", "ExerciseMove", "Herbal",
                                   "Vitamins","Homeopathy", "Imagery Techniques", "Massage", "RelaxMeditate", "SpecialDiet", "PraySpirit")
# Rename rows after model #
rownames(wave2.morethan50.3) <- c("Model 1", "Model 2", "Model 3")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave2.morethan50.3, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave2.morethan50.3 <- datatable(wave2.morethan50.3) %>% 
  formatStyle(names(wave2.morethan50.3), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:10, 2)
color.wave2.morethan50.3
```
Class 1: Exercise, herbal, vitamins, massage, meditation, diet, prayer 
Class 2: nothing 
Class 3: meditation, prayer 

# Wave 3
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave3.morethan50[[3]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 3 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=3, ncol=20)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave3.morethan50.3 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 3 by 13 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave3.morethan50.3) <- c("Chiropractic", "ExerciseMove", "Herbal",
                                   "Vitamins","Homeopathy", "Imagery Techniques", "Massage", "RelaxMeditate", "SpecialDiet", "PraySpirit")
# Rename rows after model #
rownames(wave3.morethan50.3) <- c("Model 1", "Model 2", "Model 3")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave3.morethan50.3, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave3.morethan50.3 <- datatable(wave3.morethan50.3) %>% 
  formatStyle(names(wave3.morethan50.3), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:10, 2)
color.wave3.morethan50.3
```
Class 1: chiropractic, exercise, herbal, vitamins, homeopathy, massage, meditation, diet, prayer 
Class 2: nothing 
Class 3: Prayer meditation 

# 4 Class Model 

## Wave 1
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave1.morethan50[[4]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 4 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=4, ncol=20)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave1.morethan50.4 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 4 by 14 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave1.morethan50.4) <- c("Chiropractic", "ExerciseMove", "Herbal",
                                   "Vitamins","Homeopathy", "Imagery Techniques", "Massage", "RelaxMeditate", "SpecialDiet", "PraySpirit")
# Rename rows after model #
rownames(wave1.morethan50.4) <- c("Model 1", "Model 2", "Model 3", "Model 4")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave1.morethan50.4, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave1.morethan50.4 <- datatable(wave1.morethan50.4) %>% 
  formatStyle(names(c(wave1.morethan50.4)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:10, 2)
color.wave1.morethan50.4
```
class 1: exercise, herbal, vitamins, homeopathy, massage, meditation, diet, prayer 
Class 2: meditation, prayer 
Class 3: nothing 
Class 4: nothing 

## Wave 2
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave2.morethan50[[4]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 4 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=4, ncol=20)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave2.morethan50.4 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 4 by 14 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave2.morethan50.4) <- c("Chiropractic", "ExerciseMove", "Herbal",
                                   "Vitamins","Homeopathy", "Imagery Techniques", "Massage", "RelaxMeditate", "SpecialDiet", "PraySpirit")
# Rename rows after model #
rownames(wave2.morethan50.4) <- c("Model 1", "Model 2", "Model 3", "Model 4")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave2.morethan50.4, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave2.morethan50.4 <- datatable(wave2.morethan50.4) %>% 
  formatStyle(names(c(wave2.morethan50.4)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:10, 2)
color.wave2.morethan50.4
```
Class 1: herbal, vitamins, prayer 
Class 2: nothing 
Class 3: meditation, diet, prayer 
Class 4: exercise, herbal, vitamins, massage, meditation, diet, prayer 

## Wave 3 

```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave3.morethan50[[4]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 4 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=4, ncol=20)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave3.morethan50.4 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 4 by 14 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave3.morethan50.4) <- c("Chiropractic", "ExerciseMove", "Herbal",
                                   "Vitamins","Homeopathy", "Imagery Techniques", "Massage", "RelaxMeditate", "SpecialDiet", "PraySpirit")
# Rename rows after model #
rownames(wave3.morethan50.4) <- c("Model 1", "Model 2", "Model 3", "Model 4")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave3.morethan50.4, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave3.morethan50.4 <- datatable(wave3.morethan50.4) %>% 
  formatStyle(names(c(wave3.morethan50.4)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:10, 2)
color.wave3.morethan50.4
```
Class 1: Nothing
Class 2: meditation, prayer 
Class 3: exercise, vitamins, meditation, diet, prayer 
Class 4: chiropractic, exercise, herbal, vitamins, homeopathy, massage, meditation, diet, prayer 

# 5 Class model 

## Wave 1 
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave1.morethan50[[5]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 5 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=5, ncol=20)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave1.morethan50.5 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 5 by 15 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave1.morethan50.5) <- c("Chiropractic", "ExerciseMove", "Herbal",
                                   "Vitamins","Homeopathy", "Imagery Techniques", "Massage", "RelaxMeditate", "SpecialDiet", "PraySpirit")
# Rename rows after model #
rownames(wave1.morethan50.5) <- c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave1.morethan50.5, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 50, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave1.morethan50.5 <- datatable(wave1.morethan50.5) %>% 
  formatStyle(names(c(wave1.morethan50.5)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:10, 2)
color.wave1.morethan50.5
```
Class 1: Nothing 
Class 2: exercise, massage, meditation, prayer 
Class 3: nothing 
Class 4: exercise, herbal, vitamins, homeopathy, massage, meditation, diet, prayer 
Class 5: Prayer meditation 

## Wave 2
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave2.morethan50[[5]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 5 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=5, ncol=20)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave2.morethan50.5 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 5 by 15 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave2.morethan50.5) <- c("Chiropractic", "ExerciseMove", "Herbal",
                                   "Vitamins","Homeopathy", "Imagery Techniques", "Massage", "RelaxMeditate", "SpecialDiet", "PraySpirit")
# Rename rows after model #
rownames(wave2.morethan50.5) <- c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave2.morethan50.5, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 50, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave2.morethan50.5 <- datatable(wave2.morethan50.5) %>% 
  formatStyle(names(c(wave2.morethan50.5)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:10, 2)
color.wave2.morethan50.5
```
Class 1: meditation, diet, prayer 
Class 2: exercise, herbal, vitamins, massage, meditation, diet, prayer 
Class 3: massage, meditation, prayer 
Class 4: nothing 
Class 5: herbal, vitamins, prayer 

## Wave 3 
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave3.morethan50[[5]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 5 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=5, ncol=20)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave3.morethan50.5 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 5 by 15 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave3.morethan50.5) <- c("Chiropractic", "ExerciseMove", "Herbal",
                                   "Vitamins","Homeopathy", "Imagery Techniques", "Massage", "RelaxMeditate", "SpecialDiet", "PraySpirit")
# Rename rows after model #
rownames(wave3.morethan50.5) <- c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave3.morethan50.5, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 50, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave3.morethan50.5 <- datatable(wave3.morethan50.5) %>% 
  formatStyle(names(c(wave3.morethan50.5)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:10, 2)
color.wave3.morethan50.5
```
Class 1: nothing
class 2: chiropractic, exercise, herbal, vitamins, homeopathy, imagery, massage, meditation, diet, prayer 
class 3: meditation, prayer 
Class 4: vitamins, meditation, diet, prayer 
Class 5: nothing 