---
title: "lca results complete all waves no PNA"
author: "Hannah Andrews"
date: "11/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(DT)

setwd("C:/Users/hanna/Documents/git/AHL/R/complete all waves lca")
load("complete_wave1_noPNA_lca.rda")
load("complete_wave1_noPNA_table.rda")
load("complete_wave2_noPNA_lca.rda")
load("complete_wave2_noPNA_table.rda")
load("complete_wave3_noPNA_lca.rda")
load("complete_wave3_noPNA_table.rda")
```

# Model fit and class sizes 

## Wave 1 
```{r, echo = FALSE}
wave1noPNAtable
```
AIC 6 classes BIC 3 classes Entropy 4 classes 

```{r, echo = FALSE}
# Class sizes
table(wave1noPNA[[3]]$predclass)
round(prop.table(table(wave1noPNA[[3]]$predclass)),4)*100
table(wave1noPNA[[4]]$predclass)
round(prop.table(table(wave1noPNA[[4]]$predclass)),4)*100
table(wave1noPNA[[5]]$predclass)
round(prop.table(table(wave1noPNA[[5]]$predclass)),4)*100
table(wave1noPNA[[6]]$predclass)
round(prop.table(table(wave1noPNA[[6]]$predclass)),4)*100
```


## Wave 2
```{r, echo = FALSE}
wave2noPNAtable
```
AIC 8 classes BIC 3 classes Entropy 5 classes 

```{r, echo = FALSE}
# Class sizes
table(wave2noPNA[[3]]$predclass)
round(prop.table(table(wave2noPNA[[3]]$predclass)),4)*100
table(wave2noPNA[[4]]$predclass)
round(prop.table(table(wave2noPNA[[4]]$predclass)),4)*100
table(wave2noPNA[[5]]$predclass)
round(prop.table(table(wave2noPNA[[5]]$predclass)),4)*100
table(wave2noPNA[[6]]$predclass)
round(prop.table(table(wave2noPNA[[6]]$predclass)),4)*100
```

## Wave 3 
```{r, echo = FALSE}
wave3noPNAtable
```
AIC 8 classes BIC 3 classes Entropy 3 classes 

```{r, echo = FALSE}
# Class sizes
table(wave3noPNA[[3]]$predclass)
round(prop.table(table(wave3noPNA[[3]]$predclass)),4)*100
table(wave3noPNA[[4]]$predclass)
round(prop.table(table(wave3noPNA[[4]]$predclass)),4)*100
table(wave3noPNA[[5]]$predclass)
round(prop.table(table(wave3noPNA[[5]]$predclass)),4)*100
table(wave3noPNA[[6]]$predclass)
round(prop.table(table(wave3noPNA[[6]]$predclass)),4)*100
```
# 3 Class Model 

## Wave 1 
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave1noPNA[[3]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 3 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=3, ncol=22)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave1noPNA.3 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 3 by 13 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave1noPNA.3) <- c("Acupuncture", "Biofeedback", "Chiropractic","EnergyHeal","Herbal",
                     "Homeopathy","Hypnosis","ImageryTech","Massage",
                     "RelaxMeditate","PraySpirit")
# Rename rows after model #
rownames(wave1noPNA.3) <- c("Model 1", "Model 2", "Model 3")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave1noPNA.3, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave1noPNA.3 <- datatable(wave1noPNA.3) %>% 
  formatStyle(names(c(wave1noPNA.3)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:11, 3)
color.wave1noPNA.3
```
Class 1: Herbal, massage, meditation, prayer 
Class 2: meditation, prayer 
Class 3: Nothing 

## Wave 2
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave2noPNA[[3]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 3 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=3, ncol=22)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave2noPNA.3 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 3 by 13 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave2noPNA.3) <- c("Acupuncture", "Biofeedback", "Chiropractic","EnergyHeal","Herbal",
                     "Homeopathy","Hypnosis","ImageryTech","Massage",
                     "RelaxMeditate","PraySpirit")
# Rename rows after model #
rownames(wave2noPNA.3) <- c("Model 1", "Model 2", "Model 3")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave2noPNA.3, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave2noPNA.3 <- datatable(wave2noPNA.3) %>% 
  formatStyle(names(c(wave2noPNA.3)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:11, 3)
color.wave2noPNA.3
```
Class 1: meditation, prayer 
Class 2: nothing 
Class 3: chiro, herbal, homeopathy, massage, meditation, prayer 

## Wave 3
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave3noPNA[[3]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 3 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=3, ncol=22)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave3noPNA.3 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 3 by 13 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave3noPNA.3) <- c("Acupuncture", "Biofeedback", "Chiropractic","EnergyHeal","Herbal",
                     "Homeopathy","Hypnosis","ImageryTech","Massage",
                     "RelaxMeditate","PraySpirit")
# Rename rows after model #
rownames(wave3noPNA.3) <- c("Model 1", "Model 2", "Model 3")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave3noPNA.3, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave3noPNA.3 <- datatable(wave3noPNA.3) %>% 
  formatStyle(names(c(wave3noPNA.3)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:11, 3)
color.wave3noPNA.3
```
Class 1: Chiropractic, herbal, homeopathy, massage, meditation, prayer 
Class 2: nothing 
Class 3: meditation, prayer 

# 6 Class Model 

## Wave 1
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave1noPNA[[6]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 6 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=6, ncol=22)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave1noPNA.6 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 6 by 16 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave1noPNA.6) <- c("Acupuncture", "Biofeedback", "Chiropractic","EnergyHeal","Herbal",
                     "Homeopathy","Hypnosis","ImageryTech","Massage",
                     "RelaxMeditate","PraySpirit")
# Rename rows after model #
rownames(wave1noPNA.6) <- c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave1noPNA.6, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave1noPNA.6 <- datatable(wave1noPNA.6) %>% 
  formatStyle(names(c(wave1noPNA.6)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:11, 6)
color.wave1noPNA.6
```
Class 1: nothing 
Class 2: chiropractic
Class 3: massage, meditation, prayer 
Class 4: herbal, prayer
Class 5: meditation, prayer 
Class 6: herbal, homeopathy, imagery, massage, meditation, prayer 

## Wave 2 
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave2noPNA[[6]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 6 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=6, ncol=22)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave2noPNA.6 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 6 by 16 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave2noPNA.6) <- c("Acupuncture", "Biofeedback", "Chiropractic","EnergyHeal","Herbal",
                     "Homeopathy","Hypnosis","ImageryTech","Massage",
                     "RelaxMeditate","PraySpirit")
# Rename rows after model #
rownames(wave2noPNA.6) <- c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave2noPNA.6, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave2noPNA.6 <- datatable(wave2noPNA.6) %>% 
  formatStyle(names(c(wave2noPNA.6)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:11, 6)
color.wave2noPNA.6
```
Class 1: chiro, energy, herbal, homeopathy, imagery, massage, meditation, prayer 
Class 2: Acupuncture, chiropractic, herbal, homeopathy, massage, meditation, prayer 
Class 3: chiro, massage, prayer 
Class 4: Nothing 
Class 5: herbal, meditation, prayer 
Class 6: meditation, prayer 

## Wave 3
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave3noPNA[[6]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 6 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=6, ncol=22)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave3noPNA.6 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 6 by 16 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave3noPNA.6) <- c("Acupuncture", "Biofeedback", "Chiropractic","EnergyHeal","Herbal",
                     "Homeopathy","Hypnosis","ImageryTech","Massage",
                     "RelaxMeditate","PraySpirit")
# Rename rows after model #
rownames(wave3noPNA.6) <- c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave3noPNA.6, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave3noPNA.6 <- datatable(wave3noPNA.6) %>% 
  formatStyle(names(c(wave3noPNA.6)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:11, 6)
color.wave3noPNA.6
```
Class 1: Acupuncture, chiropractic, energy, herbal, homeopathy, imagery, massage, meditation, prayer 
Class 2: meditation, prayer
Class 3: herbal, homeopathy, massage, meditation, prayer 
Class 4: nothing 
Class 5: prayer 
Class 6: nothing 