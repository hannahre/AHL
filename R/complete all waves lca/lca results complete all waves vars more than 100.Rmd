---
title: "lca results complete all wave vars more than 100"
author: "Hannah Andrews"
date: "11/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(DT)

setwd("C:/Users/hanna/Documents/git/AHL/R/complete all waves lca")
load("complete_wave1_morethan100_lca.rda")
load("complete_wave1_morethan100_table.rda")
load("complete_wave2_morethan100_lca.rda")
load("complete_wave2_morethan100_table.rda")
load("complete_wave3_morethan100_lca.rda")
load("complete_wave3_morethan100_table.rda")
```

# Model fit and class sizes

## Wave 1 
```{r, echo = FALSE}
wave1.morethan100.table
```
AIC 6 classes BIC 4 classes. Entropy below .6 
```{r, echo = FALSE}
# Class sizes
table(wave1.morethan100[[3]]$predclass)
round(prop.table(table(wave1.morethan100[[3]]$predclass)),4)*100
table(wave1.morethan100[[4]]$predclass)
round(prop.table(table(wave1.morethan100[[4]]$predclass)),4)*100
table(wave1.morethan100[[5]]$predclass)
round(prop.table(table(wave1.morethan100[[5]]$predclass)),4)*100
table(wave1.morethan100[[6]]$predclass)
round(prop.table(table(wave1.morethan100[[6]]$predclass)),4)*100
```

## Wave 2 
```{r, echo = FALSE}
wave2.morethan100.table
```
AIC 6 classes. BIC 3 classes. Entropy 4 classes. 

```{r, echo = FALSE}
# Class sizes
table(wave2.morethan100[[3]]$predclass)
round(prop.table(table(wave2.morethan100[[3]]$predclass)),4)*100
table(wave2.morethan100[[4]]$predclass)
round(prop.table(table(wave2.morethan100[[4]]$predclass)),4)*100
table(wave2.morethan100[[5]]$predclass)
round(prop.table(table(wave2.morethan100[[5]]$predclass)),4)*100
table(wave2.morethan100[[6]]$predclass)
round(prop.table(table(wave2.morethan100[[6]]$predclass)),4)*100
```

## Wave 3 
```{r, echo = FALSE }
wave3.morethan100.table
```
AIC 6 classes. BIC 4 classes (barely). Entropy 3 classes, all above .6 

```{r, echo = FALSE}
# Class sizes
table(wave3.morethan100[[3]]$predclass)
round(prop.table(table(wave3.morethan100[[3]]$predclass)),4)*100
table(wave3.morethan100[[4]]$predclass)
round(prop.table(table(wave3.morethan100[[4]]$predclass)),4)*100
table(wave3.morethan100[[5]]$predclass)
round(prop.table(table(wave3.morethan100[[5]]$predclass)),4)*100
table(wave3.morethan100[[6]]$predclass)
round(prop.table(table(wave3.morethan100[[6]]$predclass)),4)*100
```

# 3 Class Model 

## Wave 1
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave1.morethan100[[3]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 3 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=3, ncol=16)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave1.morethan100.3 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 3 by 13 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave1.morethan100.3) <- c("Chiropractic", "ExerciseMove", "Herbal",
                                   "Vitamins", "Massage", "RelaxMeditate", "SpecialDiet", "PraySpirit")
# Rename rows after model #
rownames(wave1.morethan100.3) <- c("Model 1", "Model 2", "Model 3")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave1.morethan100.3, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave1.morethan100.3 <- datatable(wave1.morethan100.3) %>% 
  formatStyle(names(c(wave1.morethan100.3)), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:8, 2)
color.wave1.morethan100.3
```
Class 1: Nothing 
Class 2: Exercise/Movement, Herbal, Massage, Meditation, Diet, Prayer
Class 3: Prayer 

# Wave 2
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave2.morethan100[[3]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 3 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=3, ncol=16)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave2.morethan100.3 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 3 by 13 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave2.morethan100.3) <- c("Chiropractic", "ExerciseMove","Herbal",
                     "Vitamins","Massage", "RelaxMeditate","SpecialDiet","PraySpirit")
# Rename rows after model #
rownames(wave2.morethan100.3) <- c("Model 1", "Model 2", "Model 3")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave2.morethan100.3, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave2.morethan100.3 <- datatable(wave2.morethan100.3) %>% 
  formatStyle(names(wave2.morethan100.3), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:13, 2)
color.wave2.morethan100.3
```

Class 1: Nothing 
Class 2: meditation, diet, prayer 
Class 3: Exercise, herbal, vitamins, massage, meditation, diet, prayer 

# Wave 3
```{r, echo = FALSE}
# Create dataframe of yes probabilities 
# Unstack list of probabilities
test <- unstack(data.frame(d<-unlist(wave3.morethan100[[3]]$probs), use.names = TRUE))
# Convert unstacked list into matrix with 3 rows corresponding to classes and 26 columns corresponding to no yes probabilities
test2 <- matrix(test[,1], nrow=3, ncol=16)
# Convert matrix to dataframe
test2 <- as.data.frame(test2)
# Select only even columns - correspond with yes probabilities
wave3.morethan100.3 <- test2 %>%
  select(everything()[c(FALSE, TRUE)])
# Result is 3 by 13 matrix of yes probabilities 
# Rename columns to corresponding CAMs
colnames(wave3.morethan100.3) <- c("Chiropractic", "ExerciseMove","Herbal",
                     "Vitamins","Massage", "RelaxMeditate","SpecialDiet","PraySpirit")
# Rename rows after model #
rownames(wave3.morethan100.3) <- c("Model 1", "Model 2", "Model 3")

# Saving code in case it comes in handy later. https://rstudio.github.io/DT/010-style.html
# create 19 breaks and 20 rgb color values ranging from white to red
brks <- quantile(wave3.morethan100.3, probs = seq(.05, .95, .05), na.rm = TRUE)
clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")}
color.wave3.morethan100.3 <- datatable(wave3.morethan100.3) %>% 
  formatStyle(names(wave3.morethan100.3), backgroundColor = styleInterval(brks, clrs)) %>% 
  formatRound(columns = 1:13, 2)
color.wave3.morethan100.3
```
Class 1: Meditation, Prayer 
Class 2: Nothing 
Class 4: Exercise, herbal, vitamins, massage, meditation, diet, prayer 

# 4 Class Model 
